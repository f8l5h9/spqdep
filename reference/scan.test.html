<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function compute the scan test for Bernoulli and Multinomial categorical spatial process."><title>Compute the scan test. — scan.test • spqdep</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the scan test. — scan.test"><meta property="og:description" content="This function compute the scan test for Bernoulli and Multinomial categorical spatial process."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spqdep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/spq_userguide.html">spqdep user guide</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute the scan test.</h1>
      
      <div class="d-none name"><code>scan.test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function compute the scan test for Bernoulli and Multinomial categorical spatial process.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">scan.test</span><span class="op">(</span>formula <span class="op">=</span> <span class="cn">NULL</span>, data <span class="op">=</span> <span class="cn">NULL</span>, fx <span class="op">=</span> <span class="cn">NULL</span>, coor <span class="op">=</span> <span class="cn">NULL</span>,
case <span class="op">=</span> <span class="cn">NULL</span>, nv <span class="op">=</span> <span class="cn">NULL</span>, nsim <span class="op">=</span> <span class="cn">NULL</span>, distr <span class="op">=</span> <span class="cn">NULL</span>, windows <span class="op">=</span> <span class="st">"circular"</span>,
alternative <span class="op">=</span> <span class="st">"High"</span>, minsize <span class="op">=</span> <span class="fl">1</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>a symbolic description of the factor (optional).</p></dd>
<dt>data</dt>
<dd><p>an (optional) data frame or a sf object containing the variable to testing for.</p></dd>
<dt>fx</dt>
<dd><p>a factor (optional).</p></dd>
<dt>coor</dt>
<dd><p>(optional) coordinates of observations.</p></dd>
<dt>case</dt>
<dd><p>Only for Bernoulli distribution. A element of factor, there are cases and non-cases for testing for cases versus non-cases</p></dd>
<dt>nv</dt>
<dd><p>Maximum windows size, default nv = N/2. The algorithm scan for clusters of geographic size between 1
and the upper limit (nv) defined by the user.</p></dd>
<dt>nsim</dt>
<dd><p>Number of permutations.</p></dd>
<dt>distr</dt>
<dd><p>distribution of the spatial process: "bernoulli" for two levels or "multinomial" for three or more levels.</p></dd>
<dt>windows</dt>
<dd><p>a string to select the type of cluster "circular" (default) of "elliptic".</p></dd>
<dt>alternative</dt>
<dd><p>Only for Bernoulli spatial process. A character string specifying the type of cluster, must be one
of "High" (default), "Both" or "Low".</p></dd>
<dt>minsize</dt>
<dd><p>Minimum number of observations inside of Most Likely Cluster and secondary clusters.</p></dd>
<dt>control</dt>
<dd><p>List of additional control arguments.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A object of the <em>htest</em> and <em>scantest</em> class</p><table class="table table"><tr><td><code>method</code></td><td>The type of test applied ().</td></tr><tr><td><code>fx</code></td><td>Factor included as input to get the scan test.</td></tr><tr><td><code>MLC</code></td><td>Observations included into the Most Likelihood Cluster (MLC).</td></tr><tr><td><code>statistic</code></td><td>Value of the scan test (maximum Log-likelihood ratio).</td></tr><tr><td><code>N</code></td><td>Total number of observations.</td></tr><tr><td><code>nn</code></td><td>Windows used to get the cluster.</td></tr><tr><td><code>nv</code></td><td>Maximum number of observations into the cluster.</td></tr><tr><td><code>data.name</code></td><td>A character string giving the name of the factor.</td></tr><tr><td><code>coor</code></td><td>coordinates.</td></tr><tr><td><code>alternative</code></td><td>Only for bernoulli spatial process. A character string describing
    the alternative hypothesis select by the user.</td></tr><tr><td><code>p.value</code></td><td>p-value of the scan test.</td></tr><tr><td><code>cases.expect</code></td><td>Expected cases into the MLC.</td></tr><tr><td><code>cases.observ</code></td><td>Observed cases into the MLC.</td></tr><tr><td><code>nsim</code></td><td>Number of permutations.</td></tr><tr><td><code>scan.mc</code></td><td>a (nsim x 1) vector with the loglik values under bootstrap permutation.</td></tr><tr><td><code>secondary.clusters</code></td><td>a list with the observations included into the secondary clusters.</td></tr><tr><td><code>loglik.second</code></td><td>a vector with the value of the secondary scan tests (maximum Log-likelihood ratio).</td></tr><tr><td><code>p.value.secondary</code></td><td>a vector with the p-value of the secondary scan tests.</td></tr><tr><td><code>Alternative.MLC</code></td><td>A vector with the observations included in another cluster with the same loglik than MLC.</td></tr></table></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Two alternative sets of arguments can be included in this function to compute the scan test:</p>
<p></p><table class="table table"><tr><td><code>Option 1</code></td><td>A factor (fx) and coordinates (coor).</td></tr><tr><td><code>Option 2</code></td><td>A sf object (data) and the formula to specify the factor.
    The function consider the coordinates of the centroids of the elements of th sf object.</td></tr></table><p>The spatial scan statistics are widely used in epidemiology, criminology or ecology.
 Their purpose is to analyze the spatial distribution of points or geographical
 regions by testing the hypothesis of spatial randomness distribution on the
 basis of different distributions (e.g. Bernoulli, Poisson or Normal distributions).
 The <code>scan.test</code> function obtain the scan statistic for the Bernoulli and Multinomial distribution.</p>
<p>To test independence in a spatial process, under the null, the type of windows is irrelevant but under the alternative the elliptic
 windows can to identify with more precision the cluster.</p>
<p>For big data sets (N &gt;&gt;) the windows = "elliptic" can be so slowly</p>
    </div>
    <div class="section level2">
    <h2 id="control-arguments">Control arguments<a class="anchor" aria-label="anchor" href="#control-arguments"></a></h2>
    

<p></p><table class="table table"><tr><td><code>seedinit</code></td><td>Numerical value for the seed (only for boot version). Default value seedinit=123</td></tr></table></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Kulldorff M, Nagarwalla N. (1995).
    Spatial disease clusters: Detection and Inference.
      <em>Statistics in Medicine</em>. 14:799-810</p></li>
<li><p>Jung I, Kulldorff M, Richard OJ (2010).
    A spatial scan statistic for multinomial data.
      <em>Statistics in Medicine</em>. 29(18), 1910-1918</p></li>
<li><p>Páez, A., López-Hernández, F.A., Ortega-García, J.A., Ruiz, M. (2016).
     Clustering and co-occurrence of cancer types: A comparison of techniques with
     an application to pediatric cancer in Murcia, Spain.
     <em>Spatial Analysis in Health Geography</em>, 69-90.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="local.sp.runs.test.html">local.sp.runs.test</a></code>, <code><a href="dgp.spq.html">dgp.spq</a></code>, <code><a href="Q.test.html">Q.test</a></code>,</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    
<table class="table table"><tr><td>Fernando López</td><td><a href="mailto:fernando.lopez@upct.es">fernando.lopez@upct.es</a></td></tr><tr><td>Román Mínguez</td><td><a href="mailto:roman.minguez@uclm.es">roman.minguez@uclm.es</a></td></tr><tr><td>Antonio Páez</td><td><a href="mailto:paezha@gmail.com">paezha@gmail.com</a></td></tr><tr><td>Manuel Ruiz</td><td><a href="mailto:manuel.ruiz@upct.es">manuel.ruiz@upct.es</a></td></tr></table></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># Case 1: Scan test bernoulli</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html" class="external-link">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Male2Female</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Male2Female</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Male2Female</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"men"</span>,<span class="st">"woman"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Male2Female</span></span>
<span class="r-in"><span class="va">scan</span> <span class="op">&lt;-</span> <span class="fu">scan.test</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, case<span class="op">=</span><span class="st">"men"</span>,</span>
<span class="r-in">nsim <span class="op">=</span> <span class="fl">99</span>, distr <span class="op">=</span> <span class="st">"bernoulli"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Scan test. Distribution: bernoulli</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Male2Female</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scan-loglik = 6.0359, p-value = 0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total observations in the MLC =   17.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected cases in the MLC =       11.84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed cases in the MLC =       16.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution....................: bernoulli</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type of cluster (alternative)...: High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of locations.............: 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cathegory case..................: men</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of observations....: 37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories............: men woman</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total per category..............: 37 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category............: 0.74 0.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scan statistic: Most Likely Cluster</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total observations in the MLC........: 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories.................: men woman</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category total...........: 0.74 0.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category inside cluster..: 0.94 0.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statisitic (loglik ratio)...: 6.0359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value..............................: 0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IDs of cluster detect:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included...:  37 34 20 11 40 28 6 14 10 18 35 36 22 31 13 15 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary Cluster. Number 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total observations in secondary cluster.:  23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories.................: men woman</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category total...........: 0.74 0.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category inside cluster..: 0.61 0.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statisitic (loglik ratio)...: 5.4635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value..............................: 0.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included................:  41 25 19 1 9 30 48 39 50 27 46 16 42 33 38 45 43 5 21 12 2 44 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary Cluster. Number 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total observations in secondary cluster.:  2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories.................: men woman</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category total...........: 0.74 0.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category inside cluster..: 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statisitic (loglik ratio)...: 0.3047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value..............................: 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included................:  3 44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary Cluster. Number 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total observations in secondary cluster.:  2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories.................: men woman</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category total...........: 0.74 0.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category inside cluster..: 0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statisitic (loglik ratio)...: 0.3047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value..............................: 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included................:  7 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary Cluster. Number 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total observations in secondary cluster.:  2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories.................: men woman</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category total...........: 0.74 0.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category inside cluster..: 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statisitic (loglik ratio)...: 0.3047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value..............................: 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included................:  17 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary Cluster. Number 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total observations in secondary cluster.:  2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories.................: men woman</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category total...........: 0.74 0.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category inside cluster..: 0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statisitic (loglik ratio)...: 0.3047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value..............................: 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included................:  24 49</span>
<span class="r-in"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scan</span>, sf <span class="op">=</span> <span class="va">provinces_spain</span><span class="op">)</span></span>
<span class="r-plt img"><img src="scan.test-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## With maximum number of neighborhood</span></span>
<span class="r-in"><span class="va">scan</span> <span class="op">&lt;-</span> <span class="fu">scan.test</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, case <span class="op">=</span> <span class="st">"woman"</span>,</span>
<span class="r-in">nsim <span class="op">=</span> <span class="fl">99</span>, distr <span class="op">=</span> <span class="st">"bernoulli"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Scan test. Distribution: bernoulli</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Male2Female</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scan-loglik = 5.6358, p-value = 0.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total observations in the MLC =   11.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected cases in the MLC =        7.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed cases in the MLC =        7.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scan</span>, sf <span class="op">=</span> <span class="va">provinces_spain</span><span class="op">)</span></span>
<span class="r-plt img"><img src="scan.test-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="co">## With elliptic windows</span></span>
<span class="r-in"><span class="va">scan</span> <span class="op">&lt;-</span> <span class="fu">scan.test</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, case <span class="op">=</span> <span class="st">"men"</span>, nv <span class="op">=</span> <span class="fl">25</span>,</span>
<span class="r-in">nsim <span class="op">=</span> <span class="fl">99</span>, distr <span class="op">=</span> <span class="st">"bernoulli"</span>, windows <span class="op">=</span><span class="st">"elliptic"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Scan test. Distribution: bernoulli</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Male2Female</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scan-loglik = 7.038, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total observations in the MLC =   19.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected cases in the MLC =       62.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed cases in the MLC =       18.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="va">scan</span> <span class="op">&lt;-</span> <span class="fu">scan.test</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, case <span class="op">=</span> <span class="st">"men"</span>, nv <span class="op">=</span> <span class="fl">15</span>,</span>
<span class="r-in">nsim <span class="op">=</span> <span class="fl">99</span>, distr <span class="op">=</span> <span class="st">"bernoulli"</span>, windows <span class="op">=</span><span class="st">"elliptic"</span>, alternative <span class="op">=</span> <span class="st">"Low"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Scan test. Distribution: bernoulli</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Male2Female</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scan-loglik = 5.9143, p-value = 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: Low</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total observations in the MLC =    5.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected cases in the MLC =       51.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed cases in the MLC =        1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scan</span>, sf <span class="op">=</span> <span class="va">provinces_spain</span><span class="op">)</span></span>
<span class="r-plt img"><img src="scan.test-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Case 2: scan test multinomial</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">)</span></span>
<span class="r-in"><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Older</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Older</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>,<span class="fl">19</span>,<span class="fl">22.5</span>,<span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Older</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>,<span class="st">"middle"</span>,<span class="st">"high"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Older</span></span>
<span class="r-in"><span class="va">scan</span> <span class="op">&lt;-</span> <span class="fu">scan.test</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, nsim <span class="op">=</span> <span class="fl">99</span>, distr <span class="op">=</span> <span class="st">"multinomial"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Scan test. Distribution: multinomial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Older</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scan-loglik = 4.2473, p-value = 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               low middle high Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cases.expect 2.24   2.88 2.88   8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cases.observ 0.00   6.00 2.00   8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scan</span>, sf <span class="op">=</span> <span class="va">provinces_spain</span><span class="op">)</span></span>
<span class="r-plt img"><img src="scan.test-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Case 3: scan test multinomial</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">FastFood.sf</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html" class="external-link">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Type</span></span>
<span class="r-in"><span class="va">scan</span> <span class="op">&lt;-</span> <span class="fu">scan.test</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">FastFood.sf</span>, nsim <span class="op">=</span> <span class="fl">99</span>,</span>
<span class="r-in">distr <span class="op">=</span> <span class="st">"multinomial"</span>, windows<span class="op">=</span><span class="st">"elliptic"</span>, nv <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Scan test. Distribution: multinomial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scan-loglik = 15.506, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  H     P     S Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cases.expect 13.48 14.86 14.66  43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cases.observ 16.00  1.00 26.00  43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution....................: multinomial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of locations.............: 877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of cases...........: 877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories...........: H P S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total cases per category........: 275 303 299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent cases per category......: 0.31 0.35 0.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scan statistic:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total cases in the MLC.........: 43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories...........: H P S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed cases in the MLC......: 13.48 14.86 14.66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected cases in the MLC......: 16 1 26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statistic (loglik ratio)....: 15.5058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value........................: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IDs of cluster detect:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included.....:  68 849 152 499 630 763 827 765 617 600 607 48 58 588 743 843 74 122 750 115 645 61 226 796 876 699 610 597 596 721 751 53 186 659 778 63 106 229 585 738 612 131 208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary Scan statistic. Number 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total cases in secondary cluster......:  16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories.................: H P S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category total...........: 0.31 0.35 0.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category inside cluster..: 0.25 0.5 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statisitic (loglik ratio)....: 11.5285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value.........................: 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included..................:  677 311 781 128 108 436 551 576 21 374 319 717 561 6 629 547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary Scan statistic. Number 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total cases in secondary cluster......:  7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories.................: H P S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category total...........: 0.31 0.35 0.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category inside cluster..: 0.14 0.29 0.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statisitic (loglik ratio)....: 7.0038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value.........................: 0.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included..................:  158 709 335 801 749 545 856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary Scan statistic. Number 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total cases in secondary cluster......:  17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories.................: H P S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category total...........: 0.31 0.35 0.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category inside cluster..: 0.35 0.35 0.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statisitic (loglik ratio)....: 6.8747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value.........................: 0.98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included..................:  521 782 162 643 297 220 267 265 104 530 312 523 783 157 531 848 680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary Scan statistic. Number 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total cases in secondary cluster......:  17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories.................: H P S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category total...........: 0.31 0.35 0.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category inside cluster..: 0.47 0.29 0.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statisitic (loglik ratio)....: 6.7961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value.........................: 0.98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included..................:  190 837 555 711 646 216 17 390 742 563 307 4 353 197 254 192 66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Secondary Scan statistic. Number 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total cases in secondary cluster......:  10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names of cathegories.................: H P S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category total...........: 0.31 0.35 0.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent per category inside cluster..: 0.4 0.2 0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Value of statisitic (loglik ratio)....: 6.5951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value.........................: 0.98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location IDs included..................:  78 365 668 228 170 857 306 708 651 187</span>
<span class="r-in"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scan</span>, sf <span class="op">=</span> <span class="va">FastFood.sf</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>bounding box has potentially an invalid value range for longlat data</span>
<span class="r-plt img"><img src="scan.test-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Case 4: DGP two categories</span></span>
<span class="r-in"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1500</span></span>
<span class="r-in"><span class="va">cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span class="r-in"><span class="va">cy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span class="r-in"><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html" class="external-link">knearneigh</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span class="r-in"><span class="va">fx</span> <span class="op">&lt;-</span> <span class="fu"><a href="dgp.spq.html">dgp.spq</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, listw <span class="op">=</span> <span class="va">listw</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span></span>
<span class="r-in"><span class="va">scan</span> <span class="op">&lt;-</span> <span class="fu">scan.test</span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, nsim <span class="op">=</span> <span class="fl">99</span>, case <span class="op">=</span> <span class="st">"A"</span>, nv <span class="op">=</span> <span class="fl">50</span>, coor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span>,</span>
<span class="r-in">distr <span class="op">=</span> <span class="st">"bernoulli"</span>,windows<span class="op">=</span><span class="st">"circular"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Scan test. Distribution: bernoulli</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  fx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scan-loglik = 0, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total observations in the MLC =   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected cases in the MLC =       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed cases in the MLC =       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-plt img"><img src="scan.test-6.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Case 5: DGP three categories</span></span>
<span class="r-in"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span class="r-in"><span class="va">cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span class="r-in"><span class="va">cy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span class="r-in"><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html" class="external-link">knearneigh</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span class="r-in"><span class="va">fx</span> <span class="op">&lt;-</span> <span class="fu"><a href="dgp.spq.html">dgp.spq</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, listw <span class="op">=</span> <span class="va">listw</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span></span>
<span class="r-in"><span class="va">scan</span> <span class="op">&lt;-</span> <span class="fu">scan.test</span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, nsim <span class="op">=</span> <span class="fl">19</span>, coor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span>, nv <span class="op">=</span> <span class="fl">30</span>,</span>
<span class="r-in">distr <span class="op">=</span> <span class="st">"multinomial"</span>, windows <span class="op">=</span> <span class="st">"elliptic"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Scan test. Distribution: multinomial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  fx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scan-loglik = 9.7578, p-value = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  A    B    C Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cases.expect  6.03 5.94 6.03  18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cases.observ 13.00 0.00 5.00  18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scan</span><span class="op">)</span></span>
<span class="r-plt img"><img src="scan.test-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Fernando Lopez, Roman Minguez, Antonio Paez, Manuel Ruiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

