[{"path":"https://f8l5h9.github.io/spqdep/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 spqdep authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"spqdep user guide","text":"guide show functionalities spqdep package test spatial dependence qualitative datasets. Global local statistics give information spatial structure spatial dataset.","code":""},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"datasets","dir":"Articles","previous_headings":"Introduction","what":"Datasets","title":"spqdep user guide","text":"Three data sets used examples guide: provinces_spain: division Spain provinces. multypolygon geometry isolated provinces (Canary Balearic islands without neighbouring provinces). See example Paez et al. 2021. FastFood.sf: simple feature (sf) dataframe containing locations selection fast food restaurants city Toronto, Canada (data 2008). data set used example Ruiz, López, Páez (2010). geometry points. Boots.sf: simple features object. square regular lattice 16x16 Fig. 3.3 Upton Fingleton (1985). figure, cells coded black/white correspond quadrats perennial shrub Atriplex hymenelytra present/absent sample area Death Valley, California. package install like usual dataset can loaded using next code","code":"library(spqdep) data(\"provinces_spain\", package = \"spqdep\") data(\"FastFood.sf\", package = \"spqdep\") data(\"Boots.sf\", package = \"spqdep\")"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"data-generating-process","dir":"Articles","previous_headings":"Introduction","what":"Data Generating Process","title":"spqdep user guide","text":"Additional datasets available spqdep package. user can generate structured spatial processes using  function. DGP generate function defined Ruiz, López, Páez (2010). next code show generate random process set random points localized square \\(1 \\times 1\\). case, connectivity criteria based 4 nearest neighbourhood. next plot show qualitative spatial process defined.","code":"set.seed(123) N <- 100 cx <- runif(N) cy <- runif(N) coor <- cbind(cx,cy) p <- c(1/6,3/6,2/6) # proportion of classes rho = 0.5 # level of spatial structure listw <- spdep::nb2listw(knn2nb(knearneigh(coor, k = 4))) fx <- dgp.spq(list = listw, p = p, rho = rho) ggplot(data.frame(fx = fx, cx = cx, cy = cy), aes(x = cx, y = cy, color = fx)) +      geom_point(size = 6) +     theme_bw()"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"q-test","dir":"Articles","previous_headings":"","what":"Q-test","title":"spqdep user guide","text":"Q-test simple, consistent, powerful statistic qualitative spatial independence develop using concepts symbolic dynamics symbolic entropy. Q test can used detect, given spatial distribution events, patterns spatial association qualitative variables wide variety settings. Q-test (Ruiz, López, Páez 2010) based m-surroundings apply Q-test necessary define set m-surroundings  function generate set m-surrounding. user can tuning several parameters obtain congruent set m-surroundings. Q(m) statistic introduced Ruiz, López, Páez (2010) tool explore geographical co-location/co-occurrence qualitative data. Consider spatial variable X result qualitative process set number categorical outcomes \\(a_j\\) (j=1,…,k). spatial variable observed set fixed locations indexed coordinates \\(s_i\\) (=1,…, N), location si event observed, \\(X_i\\) takes one possible values \\(a_j\\). Since observations georeferenced, spatial embedding protocol can devised assess spatial property co-location. Let us define, observation specified location, say \\(s_0\\), surrounding size m, called m-surrounding. m-surrounding set m-1 nearest neighbours perspective location \\(s_0\\). case distance ties, secondary criterion can invoked based direction. embedding protocol adopted elements m-surrounding location \\(s_0\\) determined, string can obtained collects elements local neighborhood (m-1 nearest neighbors) observation \\(s_0\\). m-surrounding can represented following way: \\[X_m(s_0)=(X_{s_0},X_{s_1},...X_{s_{m-1}})\\] Since observation Xs takes one k possible values, m observations m-surrounding, exactly k possible unique ways values can co-locate. number permutations replacement. instance, k=2 (e.g. possible outcomes a1=0 a2=1) m=3, following eight unique patterns co-location possible (number symbols \\(n_{\\sigma}\\)=8): {0,0,0}, {1,0,0}, {0,1,0}, {0,0,1}, {1,1,0}, {1,0,1}, {0,1,1}, {1,1,1}. unique co-locationtype can denoted convenient way means symbol \\(\\sigma_i\\) \\((=1, 2,...,k^m)\\). follows site can uniquely associated specific symbol, process termed symbolization. way, say location s type \\(\\sigma_i\\) \\(X_m(s)=\\sigma_i\\). Equivalent symbols (see Páez, et al. 2012) can obtained counting number occurrences category within m-surrounding. surrenders topological information (ordering within m-surrounding lost) favor compact set symbols, since number combinations replacement. Definition Q(m) statistic Let \\(\\{X_s\\}_{s \\R}\\) discrete spatial process m fixed embedding dimension. statistic Q(m) testing null hypothesis: \\(H_0:\\{X_s\\}_{s \\R}\\) spatially independent, alternative. fixed \\(m \\geq 2\\), relative frequency symbols can used define symbolic entropy spatial process Shanon entropy distinct symbols: \\[h(m) = - \\sum_j p_{\\sigma_j}ln(p_{\\sigma_j})\\] \\[p_{\\sigma_j}={ n_{\\sigma_j} \\R}\\] \\(n_{\\sigma_j}\\) simply number times symbol \\(\\sigma_j\\) observed R number symbolized locations. entropy function bounded \\(0 < h (m) \\leq \\eta\\). Q statistic essentially likelihood ratio test symbolic entropy observed pattern entropy system null hypothesis random spatial sequence: \\[Q(m)=2R(\\eta-h(m))\\] \\(\\eta = ln(k^m)\\). statistic asymptotically $^2} distributed degrees freedom equal number symbols minus one.","code":""},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"m-surroundings","dir":"Articles","previous_headings":"Q-test","what":"m-surroundings","title":"spqdep user guide","text":"m.surround() function generate m-surroundings. output function object class m_surr Using  method user can explore coherence m-surroundings times algorithm can generate degenerate m-surrounding far observations degree overlapping low. recommendation use control options. overlapping degree performance statistic can become compromised due overlap m-surroundings. meet key approximations testing, overlap controlled letting maximum number symbolized locations S less actual number observations N, r = 0 (.e., overlap allowed) exactly binomial random variables. Note maximum number locations can symbolized overlapping degree r \\[R = { [{{|S|−m} \\{m-r}} ]} + 1\\], [x] denotes integer part real number x, |S| cardinality set S. Therefore, reducing degree overlap also implies number symbolized locations smaller number observations sample example, next code obtain m-surroundings length m = 3 degree overlapping r = 1:","code":"m = 3 r = 1 mh <- m.surround(x = cbind(cx,cy), m = m, r = r) class(mh) ## [1] \"m_surr\" \"list\""},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"methods-for-the-m_surr-class","dir":"Articles","previous_headings":"Q-test > m-surroundings","what":"Methods for the m_surr class","title":"spqdep user guide","text":"spqdep three methods can apply class: ,  ","code":""},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"the-print-method","dir":"Articles","previous_headings":"Q-test > m-surroundings > Methods for the m_surr class","what":"The print method","title":"spqdep user guide","text":"list m-surroundings","code":"print(mh) ##       [,1] [,2] [,3] ##  [1,]    1   19   17 ##  [2,]    2   65   53 ##  [3,]    3   42   77 ##  [4,]    4   11   26 ##  [5,]    6   18   85 ##  [6,]    7   79   93 ##  [7,]    8   21   31 ##  [8,]   13   58   68 ##  [9,]   15   98   74 ## [10,]   17   76   96 ## [11,]   20   87   24 ## [12,]   22   82   92 ## [13,]   25    9   61 ## [14,]   26   14    7 ## [15,]   27   72   13 ## [16,]   31    5   20 ## [17,]   37   73   89 ## [18,]   38   30   15 ## [19,]   41   91   62 ## [20,]   46   47   49 ## [21,]   48   43   55 ## [22,]   49   29   60 ## [23,]   52   86    3 ## [24,]   53   97   69 ## [25,]   55   28   27 ## [26,]   56   64   41 ## [27,]   57   35   63 ## [28,]   60   44   70 ## [29,]   61   78   94 ## [30,]   62   54   46 ## [31,]   63   83   75 ## [32,]   67   50   37 ## [33,]   68   84    2 ## [34,]   69   59   22 ## [35,]   70   12   99 ## [36,]   71   34   67 ## [37,]   74   51    6 ## [38,]   75   36  100 ## [39,]   77   88    8 ## [40,]   85   80   57 ## [41,]   89   32    4 ## [42,]   90   45   38 ## [43,]   92   23   25 ## [44,]   93   39   95 ## [45,]   94   33   71 ## [46,]   95   81   90 ## [47,]   96   40   56 ## [48,]   99   10   48 ## [49,]  100   66   52"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"the-summary-method","dir":"Articles","previous_headings":"Q-test > m-surroundings > Methods for the m_surr class","what":"The summary method","title":"spqdep user guide","text":"generate summary characteristics m-surroundings","code":"summary(mh) ##  ## Characteristics of m-surrounding: ##  ## Number of m-surrounding (R): 49 ## Length of m-surrounding (m): 3 ## Number no-symbolized observations: 1 ##  ## List of no-symbolized observations: ## 16 ##  ## List of the degree overlaping: ##     There are 2 m-surrounding that have intersection with 1 m-surrounding ##     There are 47 m-surrounding that have intersection with 2 m-surrounding ## Mean degree of overlaping: 1.9592"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"the-plot-method","dir":"Articles","previous_headings":"Q-test > m-surroundings > Methods for the m_surr class","what":"The plot method","title":"spqdep user guide","text":"show spatial structure m-surroundings  argument control user can tuning characteristics m-surroundings. example, control argument, user can ‘prune’ non-coherent m-surroundings.","code":"plot(mh, type = 1) control <- list (dtmaxknn = 10) mh.prune <- m.surround(x = coor, m = m, r = r, control = control) plot(mh.prune)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"the-q-test","dir":"Articles","previous_headings":"Q-test","what":"The Q-test","title":"spqdep user guide","text":"function  obtain Q-test spatial process develop Ruiz, López, Páez (2010). user must select longitude m-surroundings (m) overlapping degree (r). next code example, Q-test obtain DGP spatial process (fx) obtain . coordinates coor must included argument. output list result symbols based permutations (standard) combinations (equivalent). output function object spqtest class.","code":"q.test <- Q.test(fx = fx, coor = coor, m = 3, r = 1)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"distribution-of-q-test","dir":"Articles","previous_headings":"Q-test","what":"Distribution of Q-test","title":"spqdep user guide","text":"asymptotic distribution default distribution obtain significance Q-test (Ruiz, López, Páez 2010). Alternatively, Monte Carlo method can used obtain significance test. paper López Páez (2012) describe approach.","code":"q.test.mc <- Q.test(fx = fx, coor = coor, m = 3, r = 1, distr = \"mc\") summary(q.test.mc)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"methods-for-the-spqtest-class","dir":"Articles","previous_headings":"Q-test > Distribution of Q-test","what":"Methods for the spqtest class","title":"spqdep user guide","text":"summary can apply object spqtest class: histogram number symbols obtain appling plot method.","code":"summary(q.test) plot(q.test) ## [[1]] ##  ## [[2]]"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"the-q-test-using-a-sf-object","dir":"Articles","previous_headings":"Q-test","what":"The Q-test using a sf object","title":"spqdep user guide","text":"sf object (Pebesma 2018) data frame can used input  function: method  show histogram number symbols","code":"# Case 3: With a sf object with isolated areas sf_use_s2(FALSE) ## Spherical geometry (s2) switched off provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") f1 <- ~ Male2Female q.test.sf <- Q.test(formula = f1, data = provinces_spain, m = 3, r = 1) plot(q.test.sf) ## [[1]] ##  ## [[2]]"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"qmap-test","dir":"Articles","previous_headings":"","what":"QMap-test","title":"spqdep user guide","text":"function  obtain test maps comparison publish Ruiz, López, Páez (2012) next code generate two qualitative spatial process different levels spatial dependence Q-Map apply. output  id object classes qmap htest","code":"p <- c(1/6,3/6,2/6) rho = 0.5 QY1 <- dgp.spq(p = p, listw = listw, rho = rho) rho = 0.8 QY2 <- dgp.spq(p = p, listw = listw, rho = rho) dt = data.frame(QY1,QY2) m = 3 r = 1 formula <- ~ QY1 + QY2 control <- list(dtmaxknn = 10) qmap <- Q.map.test(formula = formula, data = dt, coor = coor, m = m, r = r, type =\"combinations\", control = control) ## Warning in Q.map.test(formula = formula, data = dt, coor = coor, m = m, : The ## ratio between the number of symbolized observations and the number of symbols is ## lower than 5."},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"methods-for-qmap-class","dir":"Articles","previous_headings":"QMap-test","what":"Methods for qmap class","title":"spqdep user guide","text":"qmap object list two elements. element object class htext  method obtains distribution symbols confidence intervals specified user.","code":"print(qmap[[1]]) ##  ##  Q-Map test of Equivalence for qualitative data. ##   ##  Symbols type: combinations ##   ##  Ratio Symbolized observations/Num symbols = 4.6 ##  ## data:  QY1 and QY2 ## QE = 135.67, df = 9, p-value < 2.2e-16 ## alternative hypothesis: two.sided plot(qmap, ci=.6)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"runs-test","dir":"Articles","previous_headings":"","what":"Runs test","title":"spqdep user guide","text":"spatial runs test compute global local test spatial independence categorical spatial data set (Ruiz, López, Páez 2021). Definition spatial run: section define concepts spatial encoding runs, construct main statistics necessary testing spatial homogeneity categorical variables. order develop general theoretical setting, let us consider \\(\\{X_s\\}_{s \\S}\\) categorical spatial process interest Q different categories, S set coordinates. Spatial encoding: location \\(s \\S\\) denote \\(N_s = \\{s_1,s_2 ...,s_{n_s}\\}\\) set neighbours according interaction scheme W, ordered lesser higher Euclidean distance respect location s. sequence \\(X_{s_i} , X_{s_i+1},...,, X_{s_i+r}\\) elements value (identified class) called spatial run location s length r. spatial run statistic: total number runs defined : \\[SR^Q=n+\\sum_{s \\S}\\sum_{j=1}^{n_s}I_j^s\\] \\(I_j^s = 1 \\ \\ X_{s_j-1} \\neq X_{s_j} \\ \\text{0 otherwise}\\) \\(j=1,2,...,n_s\\) Following result Central Limit Theorem, asymtotical distribution \\(SR^Q\\) : \\[SR^Q = N(\\mu_{SR^Q},\\sigma_{SR^Q})\\] one-tailed case, must distinguish lower-tailed test upper-tailed, associated homogeneity heterogeneity respectively. case lower-tailed test, following hypotheses used: \\(H_0:\\{X_s\\}_{s \\S}\\) ..d. \\(H_1\\): spatial distribution values categorical variable homogeneous null hypothesis (according fixed association scheme). upper-tailed test, following hypotheses used: \\(H_0:\\{X_s\\}_{s \\S}\\) ..d. \\(H_1\\): spatial distribution values categorical variable heterogeneous null hypothesis (according fixed association scheme). hypotheses provide decision rule regarding degree homogeneity spatial distribution values spatial categorical random variable.","code":""},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"global-runs-test","dir":"Articles","previous_headings":"Runs test","what":"Global Runs test","title":"spqdep user guide","text":"function sp.runs.test obtain spatial runs test. output function object classes sprunstest htest","code":"listw <- knearneigh(coor, k = 3) srq <- sp.runs.test(fx = fx, listw = listw)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"methods-for-spruntest-class","dir":"Articles","previous_headings":"Runs test > Global Runs test","what":"Methods for spruntest class","title":"spqdep user guide","text":"spqdep two methods class  y","code":"print(srq) ##  ##  Runs test of spatial dependence for qualitative data. Asymptotic ##  version ##  ## data:  mxf ## sp.runs test = -3.8284, p-value = 0.000129 ## alternative hypothesis: two.sided ## sample estimates: ##          Total runs     Mean total runs Variance total runs  ##            241.0000            285.5152            135.1986 plot(srq)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"the-local-runs-test","dir":"Articles","previous_headings":"Runs test","what":"The local Runs test","title":"spqdep user guide","text":"function local.sp.runs.test obtain local tests based runs.","code":""},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"asymptotic-version","dir":"Articles","previous_headings":"Runs test > The local Runs test","what":"Asymptotic version","title":"spqdep user guide","text":"Asymptotic version  method list statistic observation (points regions)  method identify localization values local test significant.","code":"lsrq <- local.sp.runs.test(fx = fx, listw = listw, alternative = \"less\") print(lsrq) ##     runs.i      E.i     Std.i    z.value    p.value ## 1        1 2.855152 0.8722689 -2.1268116 0.01671787 ## 2        4 2.855152 0.8722689  1.3124950 0.90532341 ## 3        3 2.855152 0.8722689  0.1660594 0.56594492 ## 4        1 2.855152 0.8722689 -2.1268116 0.01671787 ## 5        4 2.855152 0.8722689  1.3124950 0.90532341 ## 6        2 2.855152 0.8722689 -0.9803761 0.16345026 ## 7        4 2.855152 0.8722689  1.3124950 0.90532341 ## 8        3 2.855152 0.8722689  0.1660594 0.56594492 ## 9        4 2.855152 0.8722689  1.3124950 0.90532341 ## 10       3 2.855152 0.8722689  0.1660594 0.56594492 ## 11       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 12       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 13       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 14       3 2.855152 0.8722689  0.1660594 0.56594492 ## 15       3 2.855152 0.8722689  0.1660594 0.56594492 ## 16       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 17       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 18       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 19       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 20       3 2.855152 0.8722689  0.1660594 0.56594492 ## 21       3 2.855152 0.8722689  0.1660594 0.56594492 ## 22       3 2.855152 0.8722689  0.1660594 0.56594492 ## 23       3 2.855152 0.8722689  0.1660594 0.56594492 ## 24       3 2.855152 0.8722689  0.1660594 0.56594492 ## 25       3 2.855152 0.8722689  0.1660594 0.56594492 ## 26       3 2.855152 0.8722689  0.1660594 0.56594492 ## 27       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 28       3 2.855152 0.8722689  0.1660594 0.56594492 ## 29       3 2.855152 0.8722689  0.1660594 0.56594492 ## 30       4 2.855152 0.8722689  1.3124950 0.90532341 ## 31       3 2.855152 0.8722689  0.1660594 0.56594492 ## 32       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 33       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 34       3 2.855152 0.8722689  0.1660594 0.56594492 ## 35       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 36       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 37       4 2.855152 0.8722689  1.3124950 0.90532341 ## 38       3 2.855152 0.8722689  0.1660594 0.56594492 ## 39       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 40       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 41       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 42       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 43       3 2.855152 0.8722689  0.1660594 0.56594492 ## 44       3 2.855152 0.8722689  0.1660594 0.56594492 ## 45       3 2.855152 0.8722689  0.1660594 0.56594492 ## 46       3 2.855152 0.8722689  0.1660594 0.56594492 ## 47       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 48       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 49       3 2.855152 0.8722689  0.1660594 0.56594492 ## 50       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 51       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 52       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 53       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 54       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 55       3 2.855152 0.8722689  0.1660594 0.56594492 ## 56       3 2.855152 0.8722689  0.1660594 0.56594492 ## 57       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 58       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 59       4 2.855152 0.8722689  1.3124950 0.90532341 ## 60       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 61       3 2.855152 0.8722689  0.1660594 0.56594492 ## 62       3 2.855152 0.8722689  0.1660594 0.56594492 ## 63       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 64       3 2.855152 0.8722689  0.1660594 0.56594492 ## 65       4 2.855152 0.8722689  1.3124950 0.90532341 ## 66       3 2.855152 0.8722689  0.1660594 0.56594492 ## 67       4 2.855152 0.8722689  1.3124950 0.90532341 ## 68       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 69       3 2.855152 0.8722689  0.1660594 0.56594492 ## 70       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 71       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 72       3 2.855152 0.8722689  0.1660594 0.56594492 ## 73       4 2.855152 0.8722689  1.3124950 0.90532341 ## 74       3 2.855152 0.8722689  0.1660594 0.56594492 ## 75       3 2.855152 0.8722689  0.1660594 0.56594492 ## 76       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 77       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 78       4 2.855152 0.8722689  1.3124950 0.90532341 ## 79       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 80       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 81       3 2.855152 0.8722689  0.1660594 0.56594492 ## 82       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 83       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 84       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 85       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 86       3 2.855152 0.8722689  0.1660594 0.56594492 ## 87       3 2.855152 0.8722689  0.1660594 0.56594492 ## 88       3 2.855152 0.8722689  0.1660594 0.56594492 ## 89       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 90       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 91       3 2.855152 0.8722689  0.1660594 0.56594492 ## 92       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 93       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 94       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 95       1 2.855152 0.8722689 -2.1268116 0.01671787 ## 96       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 97       3 2.855152 0.8722689  0.1660594 0.56594492 ## 98       3 2.855152 0.8722689  0.1660594 0.56594492 ## 99       2 2.855152 0.8722689 -0.9803761 0.16345026 ## 100      3 2.855152 0.8722689  0.1660594 0.56594492 plot(lsrq, sig = 0.05)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"monte-carlo-local-runs-test","dir":"Articles","previous_headings":"Runs test > The local Runs test","what":"Monte Carlo local runs test","title":"spqdep user guide","text":"Monte Carlo distribution ot local test using sf object","code":"data(\"provinces_spain\") listw <- spdep::poly2nb(as(provinces_spain,\"Spatial\"), queen = FALSE) ## although coordinates are longitude/latitude, st_intersects assumes that they are planar provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") plot(provinces_spain[\"Male2Female\"]) formula <- ~ Male2Female # Boots Version lsrq <- local.sp.runs.test(formula = formula, data = provinces_spain, listw = listw, distr =\"bootstrap\", nsim = 199) plot(lsrq, sf = provinces_spain, sig = 0.10)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"the-scan-test","dir":"Articles","previous_headings":"","what":"The Scan test","title":"spqdep user guide","text":"Two scan tests identify clusters can apply test spatial structure qualitative spatial processes. scan test don’t need pre-define classical W conectivity matrix. See Kanaroglou (2016) scan tests contrasts null independence spatial qualitative process give additional information indicating one (perhaps ) spatial cluster(s). scan tests don’t asymptotic distribution. significance obtained permutational resampling. output scan function object classes scantest htest","code":""},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"scan-bernoulli","dir":"Articles","previous_headings":"The Scan test","what":"Scan bernoulli","title":"spqdep user guide","text":"qualitative spatial process two categories bernoulli scan test obtain next code","code":"formula <- ~ Male2Female scan.spain <- spqdep::scan.test(formula = formula, data = provinces_spain,                                  case=\"men\", nsim = 99, distr = \"bernoulli\") print(scan.spain) ##  ##  Scan test. Distribution: bernoulli ##  ## data:  Male2Female ## scan-loglik = 6.0359, p-value = 0.07 ## alternative hypothesis: High ## sample estimates: ##                                         ## Total observations in the MLC =   17.00 ## Expected cases in the MLC =       11.84 ## Observed cases in the MLC =       16.00"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"scan-test-with-flexible-windows","dir":"Articles","previous_headings":"The Scan test > Scan bernoulli","what":"Scan test with flexible windows","title":"spqdep user guide","text":"flexible windows option. Note slow. Consider maximum nv 12.","code":"listw <- spdep::poly2nb(provinces_spain, queen = FALSE) ## although coordinates are longitude/latitude, st_intersects assumes that they are planar scan.spain <- spqdep::scan.test(formula = formula, data = provinces_spain,                                  case=\"men\", nsim = 99, windows = \"flexible\",                                  listw = listw, nv = 6, distr = \"bernoulli\") ## +++++end print(scan.spain) ##  ##  Scan test. Distribution: bernoulli ##  ## data:  Male2Female ## scan-loglik = 1.9464, p-value < 2.2e-16 ## alternative hypothesis: High ## sample estimates: ##                                          ## Total observations in the MLC =     6.00 ## Expected cases in the MLC =       370.74 ## Observed cases in the MLC =         6.00"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"scan-multinomial","dir":"Articles","previous_headings":"The Scan test","what":"Scan multinomial","title":"spqdep user guide","text":"case spatial process three categories","code":"data(FastFood.sf) formula <- ~ Type scan.fastfood <- scan.test(formula = formula, data = FastFood.sf, nsim = 99, distr = \"multinomial\", windows = \"elliptic\",                             nv = 50) print(scan.fastfood) ##  ##  Scan test. Distribution: multinomial ##  ## data:  Type ## scan-loglik = 15.506, p-value < 2.2e-16 ## sample estimates: ##                  H     P     S Sum ## cases.expect 13.48 14.86 14.66  43 ## cases.observ 16.00  1.00 26.00  43"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"methods-for-scan-test","dir":"Articles","previous_headings":"The Scan test > Scan multinomial","what":"Methods for scan test","title":"spqdep user guide","text":"Two method can used scantest objects:  ","code":"summary(scan.fastfood) ##  ## Summary of data: ## Distribution....................: multinomial ## Number of locations.............: 877 ## Total number of cases...........: 877 ## Names of cathegories...........: H P S ## Total cases per category........: 275 303 299 ## Percent cases per category......: 0.31 0.35 0.34 ##  ## Scan statistic: ## Total cases in the MLC.........: 43 ## Names of cathegories...........: H P S ## Observed cases in the MLC......: 13.48 14.86 14.66 ## Expected cases in the MLC......: 16 1 26 ## Value of statistic (loglik ratio)....: 15.5058 ## p-value........................: 0 ##  ## IDs of cluster detect: ## Location IDs included.....:  68 849 152 499 630 763 827 765 617 600 607 48 58 588 743 843 74 122 750 115 645 61 226 796 876 699 610 597 596 721 751 53 186 659 778 63 106 229 585 738 612 131 208 ##  ##  ## Secondary Scan statistic. Number 1  ## Total cases in secondary cluster......:  16  ## Names of cathegories.................: H P S ## Percent per category total...........: 0.31 0.35 0.34 ## Percent per category inside cluster..: 0.25 0.5 0.25 ## Value of statisitic (loglik ratio)....: 11.5285 ## p-value.........................: 0.1 ## Location IDs included..................:  677 311 781 128 108 436 551 576 21 374 319 717 561 6 629 547 ##  ##  ## Secondary Scan statistic. Number 2  ## Total cases in secondary cluster......:  7  ## Names of cathegories.................: H P S ## Percent per category total...........: 0.31 0.35 0.34 ## Percent per category inside cluster..: 0.14 0.29 0.57 ## Value of statisitic (loglik ratio)....: 7.0038 ## p-value.........................: 0.96 ## Location IDs included..................:  158 709 335 801 749 545 856 ##  ##  ## Secondary Scan statistic. Number 3  ## Total cases in secondary cluster......:  17  ## Names of cathegories.................: H P S ## Percent per category total...........: 0.31 0.35 0.34 ## Percent per category inside cluster..: 0.35 0.35 0.29 ## Value of statisitic (loglik ratio)....: 6.8747 ## p-value.........................: 0.98 ## Location IDs included..................:  521 782 162 643 297 220 267 265 104 530 312 523 783 157 531 848 680 ##  ##  ## Secondary Scan statistic. Number 4  ## Total cases in secondary cluster......:  17  ## Names of cathegories.................: H P S ## Percent per category total...........: 0.31 0.35 0.34 ## Percent per category inside cluster..: 0.47 0.29 0.24 ## Value of statisitic (loglik ratio)....: 6.7961 ## p-value.........................: 0.98 ## Location IDs included..................:  190 837 555 711 646 216 17 390 742 563 307 4 353 197 254 192 66 ##  ##  ## Secondary Scan statistic. Number 5  ## Total cases in secondary cluster......:  10  ## Names of cathegories.................: H P S ## Percent per category total...........: 0.31 0.35 0.34 ## Percent per category inside cluster..: 0.4 0.2 0.4 ## Value of statisitic (loglik ratio)....: 6.5951 ## p-value.........................: 0.98 ## Location IDs included..................:  78 365 668 228 170 857 306 708 651 187 plot(scan.spain, sf = provinces_spain) plot(scan.fastfood, sf = FastFood.sf)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"similarity-test","dir":"Articles","previous_headings":"","what":"Similarity test","title":"spqdep user guide","text":"Farber et al. (2014) paper develop similarity test  function calculates similarity test asymptotic distribution permutational resampling.","code":"coor <- st_coordinates(st_centroid(FastFood.sf)) listw <- spdep::knearneigh(coor, k = 4) formula <- ~ Type similarity <- similarity.test(formula = formula, data = FastFood.sf, listw = listw) print(similarity) ##  ##  Similarity test of spatial dependence for qualitative data. ##  Distribution: asymptotic ##  ## data:  Type ## Similarity-test = -5.4476, p-value = 5.105e-08 ## alternative hypothesis: two.sided"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"join-count-tests","dir":"Articles","previous_headings":"","what":"Join-count tests","title":"spqdep user guide","text":"functions spdep R-package wrapped Bernoulli Multinomial distributions. Asymptotic Monte Carlo distributions (permutations) can used evaluate signification tests.","code":""},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"asyntotic-distribution","dir":"Articles","previous_headings":"Join-count tests","what":"Asyntotic distribution","title":"spqdep user guide","text":"","code":"provinces_spain$Older <- cut(provinces_spain$Older, breaks = c(-Inf,19,22.5,Inf)) levels(provinces_spain$Older) = c(\"low\",\"middle\",\"high\") f1 <- ~ Older + Male2Female jc1 <- jc.test(formula = f1, data = provinces_spain, distr = \"asymptotic\", alternative = \"greater\", zero.policy = TRUE) ## although coordinates are longitude/latitude, st_intersects assumes that they are planar summary(jc1)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"monte-carlo-distribution","dir":"Articles","previous_headings":"Join-count tests","what":"Monte Carlo distribution","title":"spqdep user guide","text":"","code":"jc1 <- jc.test(formula = f1, data = provinces_spain, distr = \"mc\", alternative = \"greater\", zero.policy = TRUE) ## although coordinates are longitude/latitude, st_intersects assumes that they are planar summary(jc1)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"local-join-count-tests","dir":"Articles","previous_headings":"","what":"Local join-count tests","title":"spqdep user guide","text":"function calculates local Join Count tests. function wrapper local_joincount rgeoda package. test can apply binary variables (usually named B W), count number joins type B-B proportion observations B loewer half. interest lies identifying co-occurrences uncommon events, .e., situations observations take value B constitute much less half sample. statistic recently introduced Anselin Li (2019) defined : \\[BB_i = x_i  \\sum_j{w_{ij}x_j}\\] \\(x_i=1\\) localization variable \\(X\\) take value \\(B\\) 0 otherwise. \\(w_{ij}\\) elements binary spatial weights matrix. \\(BB_i\\) statistic count observations \\(x_i=1\\), since \\(x_i=0\\) result always equal zero. apply local Join Count statistic consider example regular lattice","code":"data(Boots.sf) listw <- spdep::poly2nb(as(Boots.sf,\"Spatial\"), queen = TRUE) formula <- ~ BW ljc <- local.jc.test(formula = formula, data = Boots.sf, case=\"B\", listw = listw)"},{"path":"https://f8l5h9.github.io/spqdep/articles/spq_userguide.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"spqdep user guide","text":"Farber, S., Marin, M. R., & Páez, . (2015). Testing spatial independence using similarity relations. Geographical Analysis, 47(2), 97-120. Paez, ., Lopez, F. ., Menezes, T., Cavalcanti, R., & Pitta, M. G. D. R. (2021). spatio‐temporal analysis environmental correlates COVID‐19 incidence Spain. Geographical analysis, 53(3), 397-421. Anselin, Luc, Xun Li. 2019. “Operational Local Join Count Statistics Cluster Detection.” Journal Geographical Systems 21 (2): 189–210. Kanaroglou, Pavlos. 2016. Spatial Analysis Health Geography. Routledge. https://doi.org/10.4324/9781315610252. López, Fernando , Antonio Páez. 2012. “Distribution-Free Inference Q (M) Based Permutational Bootstrapping: Application Spatial Co-Location Pattern Firms Madrid.” Estadı́stica Española 54 (177): 135–56. Pebesma, Edzer. 2018. “Simple Features R: Standardized Support Spatial Vector Data.” R Journal 10 (1): 439–46. https://doi.org/10.32614/RJ-2018-009. Ruiz, Manuel, Fernando López, Antonio Páez. 2010. “Testing Spatial Association Qualitative Data Using Symbolic Dynamics.” Journal Geographical Systems 12 (3): 281–309. https://doi.org/10.1007/s10109-009-0100-1. ———. 2021. “Test Global Local Homogeneity Categorical Data Based Spatial Runs.” Working Paper. ———. 2012. “Comparison Thematic Maps Using Symbolic Entropy.” International Journal Geographical Information Science 26 (3): 413–39. https://doi.org/10.1080/13658816.2011.586327. Upton, Graham JG, Bernard Fingleton. 1985. Spatial Data Analysis Example: Categorical Directional Data. Wiley.","code":""},{"path":"https://f8l5h9.github.io/spqdep/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Fernando Lopez. Author, maintainer. Roman Minguez. Author. Antonio Paez. Author. Manuel Ruiz. Author.","code":""},{"path":"https://f8l5h9.github.io/spqdep/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Ruiz M, López FA, Páez. (2010). Testing spatial association qualitative data using symbolic dynamics. Journal Geographical Systems. 12 (3) 281-309 URL https://doi.org/10.1007/s10109-009-0100-1.","code":"@Article{,   title = {Testing for spatial association of qualitative data using symbolic dynamics},   author = {Manuel Ruiz and Fernando Lopez and Antonio Páez},   journal = {Journal of Geographical Systems},   year = {2010},   volume = {12},   number = {3},   pages = {281-309},   url = {https://doi.org/10.1007/s10109-009-0100-1}, }"},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/index.html","id":"spqdata-1","dir":"","previous_headings":"","what":"spqdata","title":"Testing for Spatial Independence of Qualitative Data in Cross Section","text":"goal spqdep provide tools analysis spatial qualitative data.","code":""},{"path":"https://f8l5h9.github.io/spqdep/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Testing for Spatial Independence of Qualitative Data in Cross Section","text":"can install released version spqdata CRAN : development version GitHub :","code":"#install.packages(\"spqdata\") # install.packages(\"devtools\") #devtools::install_github(\"f8l5h9/spqdata\")"},{"path":"https://f8l5h9.github.io/spqdep/index.html","id":"abstract","dir":"","previous_headings":"","what":"Abstract","title":"Testing for Spatial Independence of Qualitative Data in Cross Section","text":"Qualitative spatial variables important many fields research. However, unlike decades-worth research devoted spatial association quantitative variables, exploratory analysis spatial qualitative variables relatively less developed. objective present paper present new R-package test spatial dependence categorical spatial data. Several tests proposed, namely, classical joint count statistics, Q-test based symbolic dynamics, Scan-test based scan methodology new spatial test based spatial-runs. tests can applied categorical spatial cross-section data two categories asymptotic bootstrap permutation distribution implemented. R package completely documented, including several examples user-guide available vignette. package spqdep available CRAN ideal research teaching activities.","code":""},{"path":"https://f8l5h9.github.io/spqdep/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Testing for Spatial Independence of Qualitative Data in Cross Section","text":"basic example shows solve common problem","code":"library(spqdep) N <- 200 set.seed(1234) cx <- runif(N) cy <- runif(N) listw <- spdep::knearneigh(cbind(cx,cy), k = 10) p <- c(1/3,2/3) rho <- 0.9 control <- list(seedinit = 1234) fx <- dgp.spq(p = p, listw = listw, rho = rho,control = control) scan <- scan.test(fx = fx, nsim = 199, case = \"A\", nv = 100, coor = cbind(cx,cy), distr = \"bernoulli\", windows=\"elliptic\") print(scan) #>  #>  Scan test. Distribution: bernoulli #>  #> data:  fx #> scan-loglik = 12.727, p-value < 2.2e-16 #> alternative hypothesis: High #> sample estimates: #>                                          #> Total observations in the MLC =    21.00 #> Expected cases in the MLC =       103.85 #> Observed cases in the MLC =        17.00 summary(scan) #>  #> Summary of data: #> Distribution....................: bernoulli #> Type of cluster (alternative)...: High #> Number of locations.............: 200 #> Cathegory case..................: A #> Total number of observations....: 67 #> Names of cathegories............: A B #> Total per category..............: 67 133 #> Percent per category............: 0.34 0.66 #> --------------------------------- #>  #> Scan statistic: Most Likely Cluster #> Total observations in the MLC........: 21 #> Names of cathegories.................: A B #> Percent per category total...........: 0.34 0.66 #> Percent per category inside cluster..: 0.81 0.19 #> Value of statisitic (loglik ratio)...: 12.7268 #> p-value..............................: 0 #>  #> IDs of cluster detect: #> Location IDs included...:  110 112 1 193 165 95 89 91 59 35 85 78 37 51 152 19 83 32 30 133 105 #> --------------------------------- #>  #>  #> Secondary Cluster. Number 1  #> Total observations in secondary cluster.:  5  #> Names of cathegories.................: A B #> Percent per category total...........: 0.34 0.66 #> Percent per category inside cluster..: 0 1 #> Value of statisitic (loglik ratio)...: 4.4561 #> p-value..............................: 0.75 #> Location IDs included................:  62 69 75 186 98 #>  #>  #> Secondary Cluster. Number 2  #> Total observations in secondary cluster.:  4  #> Names of cathegories.................: A B #> Percent per category total...........: 0.34 0.66 #> Percent per category inside cluster..: 0 1 #> Value of statisitic (loglik ratio)...: 3.3265 #> p-value..............................: 0.975 #> Location IDs included................:  116 124 117 185 #>  #>  #> Secondary Cluster. Number 3  #> Total observations in secondary cluster.:  6  #> Names of cathegories.................: A B #> Percent per category total...........: 0.34 0.66 #> Percent per category inside cluster..: 0.17 0.83 #> Value of statisitic (loglik ratio)...: 2.343 #> p-value..............................: 0.995 #> Location IDs included................:  38 164 43 8 88 79 #>  #>  #> Secondary Cluster. Number 4  #> Total observations in secondary cluster.:  6  #> Names of cathegories.................: A B #> Percent per category total...........: 0.34 0.66 #> Percent per category inside cluster..: 0.67 0.33 #> Value of statisitic (loglik ratio)...: 2.343 #> p-value..............................: 0.995 #> Location IDs included................:  44 191 70 160 11 84 #>  #>  #> Secondary Cluster. Number 5  #> Total observations in secondary cluster.:  6  #> Names of cathegories.................: A B #> Percent per category total...........: 0.34 0.66 #> Percent per category inside cluster..: 0.67 0.33 #> Value of statisitic (loglik ratio)...: 2.343 #> p-value..............................: 0.995 #> Location IDs included................:  129 177 162 56 31 77 plot(scan)"},{"path":"https://f8l5h9.github.io/spqdep/reference/Boots.sf.html","id":null,"dir":"Reference","previous_headings":"","what":"Boots.sf. — Boots.sf","title":"Boots.sf. — Boots.sf","text":"simple features object square regular lattice 16x16. Fig. 3.3 Upton Fingleton (1985). figure, cells coded black/white correspond quadrats perennial shrub Atriplex hymenelytra present/absent sample area Death Valley, California.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Boots.sf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Boots.sf. — Boots.sf","text":"","code":"data(Boots.sf)"},{"path":"https://f8l5h9.github.io/spqdep/reference/Boots.sf.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Boots.sf. — Boots.sf","text":"simple features dataframe 256 rows 1 column: BW factor two levels: Black White","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Boots.sf.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Boots.sf. — Boots.sf","text":"Boots, B. (2003) https://link.springer.com/content/pdf/10.1007/s10109-003-0110-3.pdf","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Boots.sf.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Boots.sf. — Boots.sf","text":"Boots, B. (2003). Developing local measures spatial association     categorical data. Journal Geographical Systems, 5(2), 139-160. Upton G., Fingleton B. (1985) Spatial data analysis example.     Volume 1: Point pattern quantitative data.     John Wiley & Sons, Chichester","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Boots.sf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Boots.sf. — Boots.sf","text":"","code":"data(Boots.sf)  summary(Boots.sf) #>  BW           hexs     #>  B: 66   POLYGON:256   #>  W:190   epsg:NA:  0    plot(Boots.sf)"},{"path":"https://f8l5h9.github.io/spqdep/reference/FastFood.sf.html","id":null,"dir":"Reference","previous_headings":"","what":"Selection of fast food restaurants in Toronto — FastFood.sf","title":"Selection of fast food restaurants in Toronto — FastFood.sf","text":"simple feature (sf) dataframe containing locations selection fast food restaurants city Toronto, Canada (data 2008). data projected using EPSG: 26917 (WGS 84/UTM Zone 17N).","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/FastFood.sf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Selection of fast food restaurants in Toronto — FastFood.sf","text":"","code":"data(FastFood.sf)"},{"path":"https://f8l5h9.github.io/spqdep/reference/FastFood.sf.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Selection of fast food restaurants in Toronto — FastFood.sf","text":"simple features object 614 rows 3 variables: ID Unique identifier record. Class Factor 3 types fast food restaurants:   [P]izza, [S]andwich, [H]amburger geometry Geometry simple features.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/FastFood.sf.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Selection of fast food restaurants in Toronto — FastFood.sf","text":"Ruiz et al. (2010) https://link.springer.com/article/10.1007/s10109-009-0100-1","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/FastFood.sf.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Selection of fast food restaurants in Toronto — FastFood.sf","text":"Ruiz M, López FA, Páez. (2010). Testing spatial association qualitative     data using symbolic dynamics. Journal Geographical Systems. 12 (3) 281-309","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Newark.sf.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract of 1880 US Census for Newark, New Jersey. — Newark.sf","title":"Extract of 1880 US Census for Newark, New Jersey. — Newark.sf","text":"simple features object geocoded information respondents 1880 US Census selected demographic information coded dummy variables. data projected using EPSG: 32618 (WGS 84/UTM Zone 18N). coordinates jiggled create unique coordinates observation.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Newark.sf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract of 1880 US Census for Newark, New Jersey. — Newark.sf","text":"","code":"data(Newark.sf)"},{"path":"https://f8l5h9.github.io/spqdep/reference/Newark.sf.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Extract of 1880 US Census for Newark, New Jersey. — Newark.sf","text":"simple features dataframe 21,520 rows 8 columns: ID Unique identifier record. YANKEE Dummy variable ethnicity respondent: 1 Yankee, 0 otherwise. IRISH Dummy variable ethnicity respondent: 1 Irish, 0 otherwise. GERMAN Dummy variable ethnicity respondent: 1 German, 0 otherwise. under30 Dummy variable age respondent: 1 younger 30 years old, 0 otherwise. mar Dummy variable marital status respondent: 1 married, 0 otherwise. usborn Dummy variable place birth respondent: 1 born US, 0 otherwise. geometry geometry simple features object","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Newark.sf.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Extract of 1880 US Census for Newark, New Jersey. — Newark.sf","text":"Páez et al. (2012) doi: 10.1080/00045608.2011.620502","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Newark.sf.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Extract of 1880 US Census for Newark, New Jersey. — Newark.sf","text":"Paez, ., Ruiz, M., Lopez, F. & Logan, J. (2012). Measuring Ethnic Clustering      Exposure Q Statistic: Exploratory Analysis Irish, Germans, Yankees 1880 Newark.. Annals Association American Geographers.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Newark.sf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract of 1880 US Census for Newark, New Jersey. — Newark.sf","text":"","code":"data(Newark.sf)  summary(Newark.sf) #>        ID            YANKEE           IRISH           GERMAN       #>  Min.   :    1   Min.   :0.0000   Min.   :0.000   Min.   :0.0000   #>  1st Qu.: 5381   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:0.0000   #>  Median :10760   Median :0.0000   Median :0.000   Median :0.0000   #>  Mean   :10760   Mean   :0.3559   Mean   :0.205   Mean   :0.4391   #>  3rd Qu.:16140   3rd Qu.:1.0000   3rd Qu.:0.000   3rd Qu.:1.0000   #>  Max.   :21520   Max.   :1.0000   Max.   :1.000   Max.   :1.0000   #>     under30            mar             usborn               geometry     #>  Min.   :0.0000   Min.   :0.0000   Min.   :0.000   POINT        :21520   #>  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.000   epsg:32618   :    0   #>  Median :0.0000   Median :0.0000   Median :1.000   +proj=utm ...:    0   #>  Mean   :0.3668   Mean   :0.2394   Mean   :0.562                         #>  3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:1.000                         #>  Max.   :1.0000   Max.   :1.0000   Max.   :1.000"},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.map.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the QE and QI tests of Equivalence and Independence between maps — Q.map.test","title":"Compute the QE and QI tests of Equivalence and Independence between maps — Q.map.test","text":"function compute QE QI tests maps comparison based symbolic entropy.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.map.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the QE and QI tests of Equivalence and Independence between maps — Q.map.test","text":"","code":"Q.map.test(formula = formula, data = data, coor = NULL, m = m, r = 1, type = \"combinations\", control = list())"},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.map.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the QE and QI tests of Equivalence and Independence between maps — Q.map.test","text":"formula symbolic description two factors. data (optional) data frame sf object containing variables testing . coor (optional) 2xN vector coordinates. m length m-surrounding. r maximum overlapping two m-surroundings (default = 1). type Type symbols: \"permutations\" \"combinations\". Default \"combinations\" control Optional argument. See Control Argument section.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.map.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the QE and QI tests of Equivalence and Independence between maps — Q.map.test","text":"list two objects class htest. first one QE test Equivalence maps second one QI test independence maps. elements test :","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.map.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the QE and QI tests of Equivalence and Independence between maps — Q.map.test","text":"data sf object coor argument coordinates observation must included.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.map.test.html","id":"control-arguments","dir":"Reference","previous_headings":"","what":"Control arguments","title":"Compute the QE and QI tests of Equivalence and Independence between maps — Q.map.test","text":"Several parameters construct m-surrounding dtmaxabs Delete degenerate surrounding based absolute distance observations. dtmaxpc value 0 1. Delete degenerate surrounding based distance. Delete m-surrounding maximum distance observation upper k percentage maximum distance anywhere observation. dtmaxknn integer value 'k'. Delete degenerate surrounding based near neighborhood criteria. Delete m-surrounding element m-surrounding include set k near neighborhood first element seedinit seed select initial element star algorithm compute m-surroundings.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.map.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute the QE and QI tests of Equivalence and Independence between maps — Q.map.test","text":"Ruiz M, López FA Páez (2011).     Comparison Thematic Maps Using Symbolic Entropy.       International Journal Geographical Information Science, 26, 413-439. Ruiz, M., López, FA, Páez, . (2010).     Testing spatial association qualitative data using symbolic dynamics.     Journal Geographical Systems, 12(3), 281-309.0.","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.map.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the QE and QI tests of Equivalence and Independence between maps — Q.map.test","text":"","code":"# Case 1: N <- 200 cx <- runif(N) cy <- runif(N) x <- cbind(cx,cy) listw <- spdep::nb2listw(spdep::knn2nb(            spdep::knearneigh(cbind(cx,cy), k = 4))) p <- c(1/6, 3/6, 2/6) rho = 0.5 QY1 <- dgp.spq(p = p, listw = listw, rho = rho) rho = 0.8 QY2 <- dgp.spq(p = p, listw = listw, rho = rho) dt = data.frame(QY1,QY2) m = 3 r = 1 formula <- ~ QY1 + QY2 control <- list(dtmaxknn = 10) qmap <- Q.map.test(formula = formula, data = dt, coor = x, m = m, r = r,                    type =\"combinations\", control = control) print(qmap) #> [[1]] #>  #> \tQ-Map test of Equivalence for qualitative data. #> \t #> \tSymbols type: combinations #> \t #> \tRatio Symbolized observations/Num symbols = 9.1 #>  #> data:  QY1 and QY2 #> QE = 270.46, df = 9, p-value < 2.2e-16 #> alternative hypothesis: two.sided #>  #>  #> [[2]] #>  #> \tQ-Map test of Independence for qualitative data. #> \t #> \tSymbols type: combinations #> \t #> \tRatio Symbolized observations/Num symbols = 9.1 #>  #> data:  QY1 and QY2 #> QI = 48.865, df = 81, p-value = 0.9982 #> alternative hypothesis: two.sided #>  #>  #> attr(,\"class\") #> [1] \"qmap\" \"list\" plot(qmap)  plot(qmap, ci=.6)  plot(qmap[[1]]$mh)  summary(qmap[[1]]$mh) #>  #> Characteristics of m-surrounding: #>  #> Number of m-surrounding (R): 91 #> Length of m-surrounding (m): 3 #> Number no-symbolized observations: 11 #>  #> List of no-symbolized observations: #> 7 13 18 23 65 95 115 123 131 139 142 #>  #> List of the degree overlaping: #>     There are 2 m-surrounding that have intersection with 0 m-surrounding #>     There are 10 m-surrounding that have intersection with 1 m-surrounding #>     There are 79 m-surrounding that have intersection with 2 m-surrounding #> Mean degree of overlaping: 1.8462  control <- list(dtmaxknn = 20) qmap <- Q.map.test(formula = formula, data = dt, coor = x, m = m, r = r,                    type =\"permutations\", control = control) #> Warning: The ratio between the number of symbolized observations and the number of symbols is lower than 5. print(qmap) #> [[1]] #>  #> \tQ-Map test of Equivalence for qualitative data. #> \t #> \tSymbols type: permutations #> \t #> \tRatio Symbolized observations/Num symbols = 3.44 #>  #> data:  QY1 and QY2 #> QE = 291.99, df = 26, p-value < 2.2e-16 #> alternative hypothesis: two.sided #>  #>  #> [[2]] #>  #> \tQ-Map test of Independence for qualitative data. #> \t #> \tSymbols type: permutations #> \t #> \tRatio Symbolized observations/Num symbols = 3.44 #>  #> data:  QY1 and QY2 #> QI = 212.1, df = 676, p-value = 1 #> alternative hypothesis: two.sided #>  #>  #> attr(,\"class\") #> [1] \"qmap\" \"list\" plot(qmap)  plot(qmap[[1]]$mh)  qmap <- Q.map.test(formula = formula, data = dt, coor = x, m = m, r = r,                    type =\"combinations\") print(qmap) #> [[1]] #>  #> \tQ-Map test of Equivalence for qualitative data. #> \t #> \tSymbols type: combinations #> \t #> \tRatio Symbolized observations/Num symbols = 9.9 #>  #> data:  QY1 and QY2 #> QE = 295.79, df = 9, p-value < 2.2e-16 #> alternative hypothesis: two.sided #>  #>  #> [[2]] #>  #> \tQ-Map test of Independence for qualitative data. #> \t #> \tSymbols type: combinations #> \t #> \tRatio Symbolized observations/Num symbols = 9.9 #>  #> data:  QY1 and QY2 #> QI = 49.016, df = 81, p-value = 0.9981 #> alternative hypothesis: two.sided #>  #>  #> attr(,\"class\") #> [1] \"qmap\" \"list\" plot(qmap)  control <- list(dtmaxknn = 10) qmap <- Q.map.test(formula = formula, data = dt, coor = x, m = m, r = r,                    type =\"combinations\", control = control) print(qmap) #> [[1]] #>  #> \tQ-Map test of Equivalence for qualitative data. #> \t #> \tSymbols type: combinations #> \t #> \tRatio Symbolized observations/Num symbols = 9.1 #>  #> data:  QY1 and QY2 #> QE = 270.46, df = 9, p-value < 2.2e-16 #> alternative hypothesis: two.sided #>  #>  #> [[2]] #>  #> \tQ-Map test of Independence for qualitative data. #> \t #> \tSymbols type: combinations #> \t #> \tRatio Symbolized observations/Num symbols = 9.1 #>  #> data:  QY1 and QY2 #> QI = 48.865, df = 81, p-value = 0.9982 #> alternative hypothesis: two.sided #>  #>  #> attr(,\"class\") #> [1] \"qmap\" \"list\" plot(qmap)   # Case 2: data(provinces_spain) sf::sf_use_s2(FALSE) #> Spherical geometry (s2) switched off m = 3 r = 1  provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") provinces_spain$Coast <- factor(provinces_spain$Coast) levels(provinces_spain$Coast) = c(\"no\",\"yes\") formula <- ~ Coast + Male2Female qmap <- Q.map.test(formula = formula, data = provinces_spain, m = m, r = r,                    type =\"combinations\") print(qmap) #> [[1]] #>  #> \tQ-Map test of Equivalence for qualitative data. #> \t #> \tSymbols type: combinations #> \t #> \tRatio Symbolized observations/Num symbols = 6 #>  #> data:  Coast and Male2Female #> QE = 71.83, df = 3, p-value = 1.731e-15 #> alternative hypothesis: two.sided #>  #>  #> [[2]] #>  #> \tQ-Map test of Independence for qualitative data. #> \t #> \tSymbols type: combinations #> \t #> \tRatio Symbolized observations/Num symbols = 6 #>  #> data:  Coast and Male2Female #> QI = 7.5057, df = 9, p-value = 0.5846 #> alternative hypothesis: two.sided #>  #>  #> attr(,\"class\") #> [1] \"qmap\" \"list\" plot(qmap)  plot(qmap[[1]]$mh)   control <- list(dtmaxknn = 6) qmap <- Q.map.test(formula = formula, data = provinces_spain, m = m, r = r,                    type =\"combinations\", control = control) print(qmap) #> [[1]] #>  #> \tQ-Map test of Equivalence for qualitative data. #> \t #> \tSymbols type: combinations #> \t #> \tRatio Symbolized observations/Num symbols = 5 #>  #> data:  Coast and Male2Female #> QE = 58.615, df = 3, p-value = 1.162e-12 #> alternative hypothesis: two.sided #>  #>  #> [[2]] #>  #> \tQ-Map test of Independence for qualitative data. #> \t #> \tSymbols type: combinations #> \t #> \tRatio Symbolized observations/Num symbols = 5 #>  #> data:  Coast and Male2Female #> QI = 7.1454, df = 9, p-value = 0.622 #> alternative hypothesis: two.sided #>  #>  #> attr(,\"class\") #> [1] \"qmap\" \"list\" plot(qmap[[1]]$mh)  summary(qmap[[1]]$mh) #>  #> Characteristics of m-surrounding: #>  #> Number of m-surrounding (R): 20 #> Length of m-surrounding (m): 3 #> Number no-symbolized observations: 8 #>  #> List of no-symbolized observations: #> 7 13 19 20 34 35 37 48 #>  #> List of the degree overlaping: #>     There are 4 m-surrounding that have intersection with 1 m-surrounding #>     There are 16 m-surrounding that have intersection with 2 m-surrounding #> Mean degree of overlaping: 1.8"},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.test.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to compute Q test for spatial qualitative data — Q.test","title":"A function to compute Q test for spatial qualitative data — Q.test","text":"function compute Q test spatial qualitative data.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to compute Q test for spatial qualitative data — Q.test","text":"","code":"Q.test(formula = NULL, data = NULL, na.action, fx = NULL, coor = NULL, m = 3, r = 1, distr = \"asymptotic\", control = list())"},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to compute Q test for spatial qualitative data — Q.test","text":"formula symbolic description factor(s). data (optional) data frame sf object points/multipolygons geometry containing variable(s) tested. na.action action NA values fx factor  matrix factors columns coor (optional) 2xN vector spatial coordinates. Used *data* spatial object m length m-surrounding (default = 3). r asimtotic distribution. Maximum overlapping two m-surroundings (default = 1). distr character. Distribution type \"asymptotic\" (default) \"mc\". control Optional argument. See Control Argument section.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to compute Q test for spatial qualitative data — Q.test","text":"list two object class htest. element list return :","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"A function to compute Q test for spatial qualitative data — Q.test","text":"Q-test simple, consistent, powerful statistic qualitative spatial  independence develop using concepts symbolic dynamics symbolic   entropy. Q test can used detect, given spatial distribution events,   patterns spatial association qualitative variables wide variety   settings.  Q(m) statistic introduced Ruiz et al. (2010) tool explore geographical co-location/co-occurrence qualitative data. Consider spatial variable X result qualitative process set number categorical outcomes \\(a_j\\) (j=1,...,k). spatial variable observed set fixed locations indexed coordinates \\(s_i\\) (=1,..., N), location si event observed, \\(X_i\\) takes one possible values \\(a_j\\). Since observations georeferenced, spatial embedding protocol can devised assess spatial property co-location. Let us define, observation specified location, say \\(s_0\\), surrounding size m, called m-surrounding. m-surrounding set m-1 nearest neighbours perspective location \\(s_0\\). case distance ties, secondary criterion can invoked based direction. embedding protocol adopted elements m-surrounding location \\(s_0\\) determined, string can obtained collects elements local neighborhood (m-1 nearest neighbors) observation \\(s_0\\). m-surrounding can represented following way: $$X_m(s_0)=(X_{s_0},X_{s_1},...X_{s_{m-1}})$$ Since observation Xs takes one k possible values, m observations m-surrounding, exactly k possible unique ways values can co-locate. number permutations replacement. instance, k=2 (e.g. possible outcomes a1=0 a2=1) m=3, following eight unique patterns co-location possible (number symbols \\(n_{\\sigma}\\)=8): 0,0,0, 1,0,0, 0,1,0, 0,0,1, 1,1,0, 1,0,1, 0,1,1, 1,1,1. unique co-locationtype can denoted convenient way means symbol \\(\\sigma_i\\) \\((=1, 2,...,k^m)\\). follows site can uniquely associated specific symbol, process termed symbolization. way, say location s type \\(\\sigma_i\\) \\(X_m(s)=\\sigma_i\\). Equivalent symbols (see Páez, et al. 2012) can obtained counting number occurrences category within m-surrounding. surrenders topological information (ordering within m-surrounding lost) favor compact set symbols, since number combinations replacement.Definition Q(m) statistic Let \\(\\{X_s\\}_{s \\R}\\) discrete spatial process m fixed embedding dimension. statistic Q testing null hypothesis: \\(H_0:\\{X_s\\}_{s \\R}\\) spatially independent, alternative. fixed \\(m \\geq 2\\), relative frequency symbols can used define symbolic entropy spatial process Shanon entropy distinct symbols: $$h(m) = - \\sum_j p_{\\sigma_j}ln(p_{\\sigma_j})$$ $$p_{\\sigma_j}={ n_{\\sigma_j} \\R}$$ \\(n_{\\sigma_j}\\) simply number times symbol \\(\\sigma_j\\) observed R number symbolized locations. entropy function bounded \\(0 < h (m) \\leq \\eta\\). Q statistic essentially likelihood ratio test symbolic entropy observed pattern entropy system null hypothesis random spatial sequence:  $$Q(m)=2R(\\eta-h(m))$$ \\(\\eta = ln(k^m)\\). statistic asymptotically \\(\\chi^2\\) distributed degrees freedom equal number symbols minus one.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.test.html","id":"control-arguments","dir":"Reference","previous_headings":"","what":"Control arguments","title":"A function to compute Q test for spatial qualitative data — Q.test","text":"distance character select type distance. Default = \"Euclidean\" Cartesian coordinates : one Euclidean, Hausdorff Frechet; geodetic coordinates, great circle distances computed (see sf::st_distance()) dtmaxabs Delete degenerate surrounding based absolute distance observations. dtmaxpc value 0 1. Delete degenerate surrounding based distance. Delete m-surrounding maximum distance observation upper k percentage maximum distance anywhere observation. dtmaxknn integer value 'k'. Delete degenerate surrounding based near neighbourhood criteria. Delete m-surrounding element m-surrounding include set k near neighbourhood first element nsim number simulations get Monte Carlo distribution.  Default = 999 seedinit seed select initial element star algorithm get compute m-surroundings start simulation","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.test.html","id":"standard-permutation-vs-equivalent-combination-symbols","dir":"Reference","previous_headings":"","what":"Standard-Permutation vs Equivalent-Combination Symbols","title":"A function to compute Q test for spatial qualitative data — Q.test","text":"symbolization protocol proposed Ruiz et al. (2010) - call Standard-Permutation Symbols — contains large amount topological information regarding units analysis, including proximity direction. sense, protocol fairly general. hand, easy see combinatorial possibilities can quickly become unmanageable.  process k = 3 outcomes m = 5, number symbols becomes  \\(3^5 = 243\\); k = 6 m = 4  \\(6^4 = 1,296\\). Depending number  observations N, explosion number symbols can rapidly consume  degrees freedom hypothesis testing, rule thumb  recommended number symbolized locations least five times  number symbols used (e.g., \\(R \\geq 5k^m\\)), R usually fraction N. alternative, propose symbolization protocol sacrifices  amount topological detail conciseness. alternative based  standard scheme; however, instead retaining proximity  direction relationships, maintains total number occurrences  outcome m-surrounding. call Equivalent-Combination Symbols.  order sequence considered protocol, instead  permutation repetition, number symbols reflects combination  repetition.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.test.html","id":"selection-of-m-surrounding-with-controlled-degree-of-overlapping-r-","dir":"Reference","previous_headings":"","what":"Selection of m-surrounding with Controlled Degree of Overlapping (r)","title":"A function to compute Q test for spatial qualitative data — Q.test","text":"select S locations analysis, coordinates selected  two coordinates \\(s_i\\) , \\(s_j\\) number overlapping nearest  neighbours \\(s_i\\) \\(s_j\\) r. set S, subset  observations N, defined recursively follows. First choose location \\(s_0\\) random fix integer r  \\(0 \\leq r < m\\). integer r degree overlap, maximum number observations contiguous  m-surroundings allowed common.  Let \\( \\{s_1^0, s_2^0,...,s_{m-1}^0 \\}\\) set nearest neighbours  \\(s_0\\), \\(s_i^0\\) ordered distance \\(s_0\\), angle case ties.  Let us call \\(s_1 = s_{m-r-1}^0\\) define \\( A_0 = \\{s_0,s_0^1,...,s^0_{m-r-2} \\}  \\) . Take set  nearest neighbours \\(s_1\\), namely, \\( \\{ s_1^1, s_2^1,...,s^1_{m-1} \\} \\)  set locations \\(S \\setminus A_0 \\) define \\(s_2=s^1_{m-r-1} \\). >1 define  \\(s_i = s^{-1}_{m-r-1}\\) \\(s^{-1}_{m-r-1}\\) ser nearest neighbors \\(s_{-1}\\),   \\( \\{ s_1^{-1},s_2^{-1},...,s_{m-1}^{-1} \\} \\) ,set \\(S \\setminus \\{ \\cup_{j=0}^{-1} A_j \\} \\).   Continue process locations symbolize.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.test.html","id":"selection-of-m-surroundings-for-bootstrap-distribution","dir":"Reference","previous_headings":"","what":"Selection of m-surroundings for bootstrap distribution","title":"A function to compute Q test for spatial qualitative data — Q.test","text":"bootstrapped-based testing can provide advantage since overlapping m-surroundings consideration, full sample can used.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A function to compute Q test for spatial qualitative data — Q.test","text":"Ruiz M, López FA, Páez. (2010). Testing spatial association qualitative     data using symbolic dynamics. Journal Geographical Systems. 12 (3) 281-309 López, FA, Páez. (2012). Distribution-free inference Q(m) based permutational bootstrapping: application     spatial co-location pattern firms Madrid Estadística Española, 177, 135-156.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/Q.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A function to compute Q test for spatial qualitative data — Q.test","text":"","code":"# Case 1: With coordinates N <- 200 cx <- runif(N) cy <- runif(N) coor <- cbind(cx,cy) p <- c(1/6,3/6,2/6) rho = 0.3 listw <- spdep::nb2listw(spdep::knn2nb(spdep::knearneigh(cbind(cx,cy), k = 4))) fx <- dgp.spq(list = listw, p = p, rho = rho) q.test <- Q.test(fx = fx, coor = coor, m = 3, r = 1) summary(q.test) #> <div id=\"vrzdqffzog\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #vrzdqffzog .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #vrzdqffzog .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #vrzdqffzog .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #vrzdqffzog .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #vrzdqffzog .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #vrzdqffzog .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #vrzdqffzog .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #vrzdqffzog .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #vrzdqffzog .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #vrzdqffzog .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #vrzdqffzog .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #vrzdqffzog .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #vrzdqffzog .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #vrzdqffzog .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_left { #>   text-align: left; #> } #>  #> #vrzdqffzog .gt_center { #>   text-align: center; #> } #>  #> #vrzdqffzog .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #vrzdqffzog .gt_font_normal { #>   font-weight: normal; #> } #>  #> #vrzdqffzog .gt_font_bold { #>   font-weight: bold; #> } #>  #> #vrzdqffzog .gt_font_italic { #>   font-style: italic; #> } #>  #> #vrzdqffzog .gt_super { #>   font-size: 65%; #> } #>  #> #vrzdqffzog .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #vrzdqffzog .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #vrzdqffzog .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #vrzdqffzog .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #vrzdqffzog .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"11\" class=\"gt_heading gt_title gt_font_normal\" style>Qualitative Dependence Test (Q)<\/th> #>     <\/tr> #>     <tr> #>       <th colspan=\"11\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Distribution: asymptotic. Distance: Euclidean<\/th> #>     <\/tr> #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Q<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">df<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">p.value<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">k<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">N<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">m<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">r<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R/n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">5k^m<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"11\" class=\"gt_group_heading\">V1 - standard-permutations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">23.58<\/td> #> <td class=\"gt_row gt_right\">26<\/td> #> <td class=\"gt_row gt_right\">0.59974<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">200<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">99<\/td> #> <td class=\"gt_row gt_right\">27<\/td> #> <td class=\"gt_row gt_right\">3.67<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"11\" class=\"gt_group_heading\">V1 - equivalent-combinations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">7.78<\/td> #> <td class=\"gt_row gt_right\">9<\/td> #> <td class=\"gt_row gt_right\">0.55682<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">200<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">99<\/td> #> <td class=\"gt_row gt_right\">10<\/td> #> <td class=\"gt_row gt_right\">9.90<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div> plot(q.test) #> [[1]]  #>  #> [[2]]  #>  print(q.test) #> [[1]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable V1  m =  3  r =  1 #> Qp = 23.584, df = 26, p-value = 0.5997 #>  #>  #> [[2]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable V1  m =  3  r =  1 #> Qc = 7.7765, df = 9, p-value = 0.5568 #>  #>  #> attr(,\"class\") #> [1] \"spqtest\" \"list\"    # \\donttest{ q.test.mc <- Q.test(fx = fx, coor = coor, m = 3, distr = \"mc\", control = list(nsim = 999)) summary(q.test.mc) #> <div id=\"hclvlliyhf\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #hclvlliyhf .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #hclvlliyhf .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #hclvlliyhf .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #hclvlliyhf .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #hclvlliyhf .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #hclvlliyhf .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #hclvlliyhf .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #hclvlliyhf .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #hclvlliyhf .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #hclvlliyhf .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #hclvlliyhf .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #hclvlliyhf .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #hclvlliyhf .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #hclvlliyhf .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #hclvlliyhf .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #hclvlliyhf .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #hclvlliyhf .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #hclvlliyhf .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #hclvlliyhf .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #hclvlliyhf .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #hclvlliyhf .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #hclvlliyhf .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #hclvlliyhf .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #hclvlliyhf .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #hclvlliyhf .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #hclvlliyhf .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #hclvlliyhf .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #hclvlliyhf .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #hclvlliyhf .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #hclvlliyhf .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #hclvlliyhf .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #hclvlliyhf .gt_left { #>   text-align: left; #> } #>  #> #hclvlliyhf .gt_center { #>   text-align: center; #> } #>  #> #hclvlliyhf .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #hclvlliyhf .gt_font_normal { #>   font-weight: normal; #> } #>  #> #hclvlliyhf .gt_font_bold { #>   font-weight: bold; #> } #>  #> #hclvlliyhf .gt_font_italic { #>   font-style: italic; #> } #>  #> #hclvlliyhf .gt_super { #>   font-size: 65%; #> } #>  #> #hclvlliyhf .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #hclvlliyhf .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #hclvlliyhf .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #hclvlliyhf .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #hclvlliyhf .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"9\" class=\"gt_heading gt_title gt_font_normal\" style>Qualitative Dependence Test (Q)<\/th> #>     <\/tr> #>     <tr> #>       <th colspan=\"9\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Distribution: mc. Distance: Euclidean<\/th> #>     <\/tr> #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Q<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">p.value<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">k<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">N<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">m<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R/n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">5k^m<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"9\" class=\"gt_group_heading\">V1 - standard-permutations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">42.76<\/td> #> <td class=\"gt_row gt_right\">0.08900<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">200<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">200<\/td> #> <td class=\"gt_row gt_right\">27<\/td> #> <td class=\"gt_row gt_right\">7.41<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"9\" class=\"gt_group_heading\">V1 - equivalent-combinations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">27.92<\/td> #> <td class=\"gt_row gt_right\">0.04800<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">200<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">200<\/td> #> <td class=\"gt_row gt_right\">10<\/td> #> <td class=\"gt_row gt_right\">20.00<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div> plot(q.test.mc) #> [[1]]  #>  #> [[2]]  #>  print(q.test.mc) #> [[1]] #>  #> \tQp (mc distrib.) for symbolization based on permutations #>  #> data:  Variable V1  m =  3  r =  2 #> Qp = 42.765, df = NA, p-value = 0.089 #>  #>  #> [[2]] #>  #> \tQc (mc distrib.) for symbolization based on combinations #>  #> data:  Variable V1  m =  3  r =  2 #> Qc = 27.921, df = NA, p-value = 0.048 #>  #>  #> attr(,\"class\") #> [1] \"spqtest\" \"list\"      # Case 2: With a sf object data(\"FastFood.sf\") f1 <- ~ Type q.test <- Q.test(formula = f1, data = FastFood.sf, m = c(3, 4), r = c(1, 2, 3), control = list(distance =\"Euclidean\")) #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: bounding box has potentially an invalid value range for longlat data summary(q.test) #> <div id=\"vrzdqffzog\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #vrzdqffzog .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #vrzdqffzog .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #vrzdqffzog .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #vrzdqffzog .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #vrzdqffzog .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #vrzdqffzog .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #vrzdqffzog .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #vrzdqffzog .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #vrzdqffzog .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #vrzdqffzog .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #vrzdqffzog .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #vrzdqffzog .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #vrzdqffzog .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #vrzdqffzog .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_left { #>   text-align: left; #> } #>  #> #vrzdqffzog .gt_center { #>   text-align: center; #> } #>  #> #vrzdqffzog .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #vrzdqffzog .gt_font_normal { #>   font-weight: normal; #> } #>  #> #vrzdqffzog .gt_font_bold { #>   font-weight: bold; #> } #>  #> #vrzdqffzog .gt_font_italic { #>   font-style: italic; #> } #>  #> #vrzdqffzog .gt_super { #>   font-size: 65%; #> } #>  #> #vrzdqffzog .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #vrzdqffzog .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #vrzdqffzog .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #vrzdqffzog .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #vrzdqffzog .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"11\" class=\"gt_heading gt_title gt_font_normal\" style>Qualitative Dependence Test (Q)<\/th> #>     <\/tr> #>     <tr> #>       <th colspan=\"11\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Distribution: asymptotic. Distance: Euclidean<\/th> #>     <\/tr> #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Q<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">df<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">p.value<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">k<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">N<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">m<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">r<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R/n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">5k^m<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"11\" class=\"gt_group_heading\">Type - standard-permutations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">40.10<\/td> #> <td class=\"gt_row gt_right\">26<\/td> #> <td class=\"gt_row gt_right\">0.03812<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">877<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">438<\/td> #> <td class=\"gt_row gt_right\">27<\/td> #> <td class=\"gt_row gt_right\">16.22<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>     <tr><td class=\"gt_row gt_right\">71.71<\/td> #> <td class=\"gt_row gt_right\">26<\/td> #> <td class=\"gt_row gt_right\">0.00000<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">877<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">2<\/td> #> <td class=\"gt_row gt_right\">875<\/td> #> <td class=\"gt_row gt_right\">27<\/td> #> <td class=\"gt_row gt_right\">32.41<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>     <tr><td class=\"gt_row gt_right\">89.02<\/td> #> <td class=\"gt_row gt_right\">80<\/td> #> <td class=\"gt_row gt_right\">0.22966<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">877<\/td> #> <td class=\"gt_row gt_right\">4<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">292<\/td> #> <td class=\"gt_row gt_right\">81<\/td> #> <td class=\"gt_row gt_right\">3.60<\/td> #> <td class=\"gt_row gt_right\">405<\/td><\/tr> #>     <tr><td class=\"gt_row gt_right\">115.69<\/td> #> <td class=\"gt_row gt_right\">80<\/td> #> <td class=\"gt_row gt_right\">0.00559<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">877<\/td> #> <td class=\"gt_row gt_right\">4<\/td> #> <td class=\"gt_row gt_right\">2<\/td> #> <td class=\"gt_row gt_right\">437<\/td> #> <td class=\"gt_row gt_right\">81<\/td> #> <td class=\"gt_row gt_right\">5.40<\/td> #> <td class=\"gt_row gt_right\">405<\/td><\/tr> #>     <tr><td class=\"gt_row gt_right\">151.65<\/td> #> <td class=\"gt_row gt_right\">80<\/td> #> <td class=\"gt_row gt_right\">0.00000<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">877<\/td> #> <td class=\"gt_row gt_right\">4<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">874<\/td> #> <td class=\"gt_row gt_right\">81<\/td> #> <td class=\"gt_row gt_right\">10.79<\/td> #> <td class=\"gt_row gt_right\">405<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"11\" class=\"gt_group_heading\">Type - equivalent-combinations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">26.51<\/td> #> <td class=\"gt_row gt_right\">9<\/td> #> <td class=\"gt_row gt_right\">0.00169<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">877<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">438<\/td> #> <td class=\"gt_row gt_right\">10<\/td> #> <td class=\"gt_row gt_right\">43.80<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>     <tr><td class=\"gt_row gt_right\">64.67<\/td> #> <td class=\"gt_row gt_right\">9<\/td> #> <td class=\"gt_row gt_right\">0.00000<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">877<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">2<\/td> #> <td class=\"gt_row gt_right\">875<\/td> #> <td class=\"gt_row gt_right\">10<\/td> #> <td class=\"gt_row gt_right\">87.50<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>     <tr><td class=\"gt_row gt_right\">28.83<\/td> #> <td class=\"gt_row gt_right\">14<\/td> #> <td class=\"gt_row gt_right\">0.01102<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">877<\/td> #> <td class=\"gt_row gt_right\">4<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">292<\/td> #> <td class=\"gt_row gt_right\">15<\/td> #> <td class=\"gt_row gt_right\">19.47<\/td> #> <td class=\"gt_row gt_right\">405<\/td><\/tr> #>     <tr><td class=\"gt_row gt_right\">44.19<\/td> #> <td class=\"gt_row gt_right\">14<\/td> #> <td class=\"gt_row gt_right\">0.00006<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">877<\/td> #> <td class=\"gt_row gt_right\">4<\/td> #> <td class=\"gt_row gt_right\">2<\/td> #> <td class=\"gt_row gt_right\">437<\/td> #> <td class=\"gt_row gt_right\">15<\/td> #> <td class=\"gt_row gt_right\">29.13<\/td> #> <td class=\"gt_row gt_right\">405<\/td><\/tr> #>     <tr><td class=\"gt_row gt_right\">81.26<\/td> #> <td class=\"gt_row gt_right\">14<\/td> #> <td class=\"gt_row gt_right\">0.00000<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">877<\/td> #> <td class=\"gt_row gt_right\">4<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">874<\/td> #> <td class=\"gt_row gt_right\">15<\/td> #> <td class=\"gt_row gt_right\">58.27<\/td> #> <td class=\"gt_row gt_right\">405<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div> plot(q.test) #> [[1]]  #>  #> [[2]]  #>  #> [[3]]  #>  #> [[4]]  #>  #> [[5]]  #>  #> [[6]]  #>  #> [[7]]  #>  #> [[8]]  #>  #> [[9]]  #>  #> [[10]]  #>  print(q.test) #> [[1]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable Type  m =  3  r =  1 #> Qp = 40.102, df = 26, p-value = 0.03812 #>  #>  #> [[2]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable Type  m =  3  r =  1 #> Qc = 26.507, df = 9, p-value = 0.001687 #>  #>  #> [[3]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable Type  m =  3  r =  2 #> Qp = 71.712, df = 26, p-value = 3.725e-06 #>  #>  #> [[4]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable Type  m =  3  r =  2 #> Qc = 64.671, df = 9, p-value = 1.672e-10 #>  #>  #> [[5]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable Type  m =  4  r =  1 #> Qp = 89.017, df = 80, p-value = 0.2297 #>  #>  #> [[6]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable Type  m =  4  r =  1 #> Qc = 28.831, df = 14, p-value = 0.01102 #>  #>  #> [[7]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable Type  m =  4  r =  2 #> Qp = 115.69, df = 80, p-value = 0.005592 #>  #>  #> [[8]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable Type  m =  4  r =  2 #> Qc = 44.19, df = 14, p-value = 5.516e-05 #>  #>  #> [[9]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable Type  m =  4  r =  3 #> Qp = 151.65, df = 80, p-value = 2.375e-06 #>  #>  #> [[10]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable Type  m =  4  r =  3 #> Qc = 81.256, df = 14, p-value = 1.654e-11 #>  #>  #> attr(,\"class\") #> [1] \"spqtest\" \"list\"     # Case 3: With a sf object with isolated areas data(\"provinces_spain\") sf::sf_use_s2(FALSE) provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") provinces_spain$Older <- cut(provinces_spain$Older, breaks = c(-Inf,19,22.5,Inf)) levels(provinces_spain$Older) = c(\"low\",\"middle\",\"high\") f1 <- ~ Older + Male2Female q.test <- Q.test(formula = f1, data = provinces_spain, m = 3, r = 1, control = list(seedinit = 1111)) summary(q.test) #> <div id=\"vrzdqffzog\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #vrzdqffzog .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #vrzdqffzog .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #vrzdqffzog .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #vrzdqffzog .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #vrzdqffzog .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #vrzdqffzog .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #vrzdqffzog .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #vrzdqffzog .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #vrzdqffzog .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #vrzdqffzog .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #vrzdqffzog .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #vrzdqffzog .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #vrzdqffzog .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #vrzdqffzog .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_left { #>   text-align: left; #> } #>  #> #vrzdqffzog .gt_center { #>   text-align: center; #> } #>  #> #vrzdqffzog .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #vrzdqffzog .gt_font_normal { #>   font-weight: normal; #> } #>  #> #vrzdqffzog .gt_font_bold { #>   font-weight: bold; #> } #>  #> #vrzdqffzog .gt_font_italic { #>   font-style: italic; #> } #>  #> #vrzdqffzog .gt_super { #>   font-size: 65%; #> } #>  #> #vrzdqffzog .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #vrzdqffzog .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #vrzdqffzog .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #vrzdqffzog .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #vrzdqffzog .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"11\" class=\"gt_heading gt_title gt_font_normal\" style>Qualitative Dependence Test (Q)<\/th> #>     <\/tr> #>     <tr> #>       <th colspan=\"11\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Distribution: asymptotic. Distance: Euclidean<\/th> #>     <\/tr> #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Q<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">df<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">p.value<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">k<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">N<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">m<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">r<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R/n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">5k^m<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"11\" class=\"gt_group_heading\">Older - standard-permutations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">29.40<\/td> #> <td class=\"gt_row gt_right\">26<\/td> #> <td class=\"gt_row gt_right\">0.29320<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">24<\/td> #> <td class=\"gt_row gt_right\">27<\/td> #> <td class=\"gt_row gt_right\">0.89<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"11\" class=\"gt_group_heading\">Older - equivalent-combinations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">8.95<\/td> #> <td class=\"gt_row gt_right\">9<\/td> #> <td class=\"gt_row gt_right\">0.44166<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">24<\/td> #> <td class=\"gt_row gt_right\">10<\/td> #> <td class=\"gt_row gt_right\">2.40<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"11\" class=\"gt_group_heading\">Male2Female - standard-permutations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">4.34<\/td> #> <td class=\"gt_row gt_right\">7<\/td> #> <td class=\"gt_row gt_right\">0.74025<\/td> #> <td class=\"gt_row gt_right\">2<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">24<\/td> #> <td class=\"gt_row gt_right\">8<\/td> #> <td class=\"gt_row gt_right\">3.00<\/td> #> <td class=\"gt_row gt_right\">40<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"11\" class=\"gt_group_heading\">Male2Female - equivalent-combinations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">0.69<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">0.87543<\/td> #> <td class=\"gt_row gt_right\">2<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">24<\/td> #> <td class=\"gt_row gt_right\">4<\/td> #> <td class=\"gt_row gt_right\">6.00<\/td> #> <td class=\"gt_row gt_right\">40<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div> print(q.test) #> [[1]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable Older  m =  3  r =  1 #> Qp = 29.4, df = 26, p-value = 0.2932 #>  #>  #> [[2]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable Older  m =  3  r =  1 #> Qc = 8.9526, df = 9, p-value = 0.4417 #>  #>  #> [[3]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable Male2Female  m =  3  r =  1 #> Qp = 4.3369, df = 7, p-value = 0.7403 #>  #>  #> [[4]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable Male2Female  m =  3  r =  1 #> Qc = 0.69051, df = 3, p-value = 0.8754 #>  #>  #> attr(,\"class\") #> [1] \"spqtest\" \"list\"    plot(q.test) #> [[1]]  #>  #> [[2]]  #>  #> [[3]]  #>  #> [[4]]  #>  q.test.mc <- Q.test(formula = f1, data = provinces_spain, m = 4, r = 3, distr = \"mc\", control = list(seedinit = 1111)) summary(q.test.mc) #> <div id=\"friuvihjft\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #friuvihjft .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #friuvihjft .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #friuvihjft .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #friuvihjft .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #friuvihjft .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #friuvihjft .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #friuvihjft .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #friuvihjft .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #friuvihjft .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #friuvihjft .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #friuvihjft .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #friuvihjft .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #friuvihjft .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #friuvihjft .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #friuvihjft .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #friuvihjft .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #friuvihjft .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #friuvihjft .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #friuvihjft .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #friuvihjft .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #friuvihjft .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #friuvihjft .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #friuvihjft .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #friuvihjft .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #friuvihjft .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #friuvihjft .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #friuvihjft .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #friuvihjft .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #friuvihjft .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #friuvihjft .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #friuvihjft .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #friuvihjft .gt_left { #>   text-align: left; #> } #>  #> #friuvihjft .gt_center { #>   text-align: center; #> } #>  #> #friuvihjft .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #friuvihjft .gt_font_normal { #>   font-weight: normal; #> } #>  #> #friuvihjft .gt_font_bold { #>   font-weight: bold; #> } #>  #> #friuvihjft .gt_font_italic { #>   font-style: italic; #> } #>  #> #friuvihjft .gt_super { #>   font-size: 65%; #> } #>  #> #friuvihjft .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #friuvihjft .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #friuvihjft .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #friuvihjft .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #friuvihjft .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"9\" class=\"gt_heading gt_title gt_font_normal\" style>Qualitative Dependence Test (Q)<\/th> #>     <\/tr> #>     <tr> #>       <th colspan=\"9\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Distribution: mc. Distance: Euclidean<\/th> #>     <\/tr> #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Q<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">p.value<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">k<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">N<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">m<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R/n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">5k^m<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"9\" class=\"gt_group_heading\">Older - standard-permutations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">93.32<\/td> #> <td class=\"gt_row gt_right\">0.23500<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">4<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">81<\/td> #> <td class=\"gt_row gt_right\">0.62<\/td> #> <td class=\"gt_row gt_right\">405<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"9\" class=\"gt_group_heading\">Older - equivalent-combinations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">20.10<\/td> #> <td class=\"gt_row gt_right\">0.46800<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">4<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">15<\/td> #> <td class=\"gt_row gt_right\">3.33<\/td> #> <td class=\"gt_row gt_right\">405<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"9\" class=\"gt_group_heading\">Male2Female - standard-permutations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">18.06<\/td> #> <td class=\"gt_row gt_right\">0.46100<\/td> #> <td class=\"gt_row gt_right\">2<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">4<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">16<\/td> #> <td class=\"gt_row gt_right\">3.12<\/td> #> <td class=\"gt_row gt_right\">80<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"9\" class=\"gt_group_heading\">Male2Female - equivalent-combinations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">6.35<\/td> #> <td class=\"gt_row gt_right\">0.31300<\/td> #> <td class=\"gt_row gt_right\">2<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">4<\/td> #> <td class=\"gt_row gt_right\">50<\/td> #> <td class=\"gt_row gt_right\">5<\/td> #> <td class=\"gt_row gt_right\">10.00<\/td> #> <td class=\"gt_row gt_right\">80<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div> print(q.test.mc) #> [[1]] #>  #> \tQp (mc distrib.) for symbolization based on permutations #>  #> data:  Variable Older  m =  4  r =  3 #> Qp = 93.325, df = NA, p-value = 0.235 #>  #>  #> [[2]] #>  #> \tQc (mc distrib.) for symbolization based on combinations #>  #> data:  Variable Older  m =  4  r =  3 #> Qc = 20.096, df = NA, p-value = 0.468 #>  #>  #> [[3]] #>  #> \tQp (mc distrib.) for symbolization based on permutations #>  #> data:  Variable Male2Female  m =  4  r =  3 #> Qp = 18.062, df = NA, p-value = 0.461 #>  #>  #> [[4]] #>  #> \tQc (mc distrib.) for symbolization based on combinations #>  #> data:  Variable Male2Female  m =  4  r =  3 #> Qc = 6.3535, df = NA, p-value = 0.313 #>  #>  #> attr(,\"class\") #> [1] \"spqtest\" \"list\"    plot(q.test.mc) #> [[1]]  #>  #> [[2]]  #>  #> [[3]]  #>  #> [[4]]  #>   # Case 4: Examples with multipolygons library(sf) #> Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1; sf_use_s2() is FALSE fname <- system.file(\"shape/nc.shp\", package=\"sf\") nc <- sf::st_read(fname) #> Reading layer `nc' from data source  #>   `/home/runner/work/_temp/Library/sf/shape/nc.shp' using driver `ESRI Shapefile' #> Simple feature collection with 100 features and 14 fields #> Geometry type: MULTIPOLYGON #> Dimension:     XY #> Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965 #> Geodetic CRS:  NAD27 qb79 <- quantile(nc$BIR79) nc$QBIR79 <- (nc$BIR79 > qb79[2]) + (nc$BIR79 > qb79[3]) + (nc$BIR79 >= qb79[4]) + 1 nc$QBIR79 <- as.factor(nc$QBIR79) plot(nc[\"QBIR79\"], pal = c(\"#FFFEDE\",\"#FFDFA2\", \"#FFA93F\", \"#D5610D\"),      main = \"BIR79 (Quartiles)\")  sid79 <- quantile(nc$SID79) nc$QSID79 <- (nc$SID79 > sid79[2]) + (nc$SID79 > sid79[3]) + (nc$SID79 >= sid79[4]) + 1 nc$QSID79 <- as.factor(nc$QSID79) plot(nc[\"QSID79\"], pal = c(\"#FFFEDE\",\"#FFDFA2\", \"#FFA93F\", \"#D5610D\"),      main = \"SID79 (Quartiles)\")  f1 <- ~ QSID79 + QBIR79 lq1nc <- Q.test(formula = f1, data = nc, m = 5, r = 2, control = list(seedinit = 1111, dtmaxpc = 0.5, distance = \"Euclidean\") ) #>  #>  Threshold distance:  4.136024 #>  None m-surrounding excluded for exceeding #>         the threshold distance  #>  #>  Threshold distance:  4.136024 #>  None m-surrounding excluded for exceeding #>         the threshold distance  print(lq1nc) #> [[1]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable QSID79  m =  5  r =  2 #> Qp = 225.84, df = 1023, p-value = 1 #>  #>  #> [[2]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable QSID79  m =  5  r =  2 #> Qc = 61.371, df = 55, p-value = 0.2583 #>  #>  #> [[3]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable QBIR79  m =  5  r =  2 #> Qp = 221.81, df = 1023, p-value = 1 #>  #>  #> [[4]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable QBIR79  m =  5  r =  2 #> Qc = 59.272, df = 55, p-value = 0.3226 #>  #>  #> attr(,\"class\") #> [1] \"spqtest\" \"list\"     lq2nc <- Q.test(formula = f1, data = nc, m = 5, r = 2, control = list(dtmaxpc = 0.2) ) #>  #>  Threshold distance:  1.65441 #>  Number of m-surroundings excluded for exceeding #>         the threshold distance:  3  #>  #>  Index of spatial observations excluded:  19 3 28  #>  #>  Threshold distance:  1.65441 #>  Number of m-surroundings excluded for exceeding #>         the threshold distance:  3  #>  #>  Index of spatial observations excluded:  19 3 28  print(lq2nc) #> [[1]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable QSID79  m =  5  r =  2 #> Qp = 210.14, df = 1023, p-value = 1 #>  #>  #> [[2]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable QSID79  m =  5  r =  2 #> Qc = 62.831, df = 55, p-value = 0.2186 #>  #>  #> [[3]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable QBIR79  m =  5  r =  2 #> Qp = 206.72, df = 1023, p-value = 1 #>  #>  #> [[4]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable QBIR79  m =  5  r =  2 #> Qc = 60.539, df = 55, p-value = 0.2828 #>  #>  #> attr(,\"class\") #> [1] \"spqtest\" \"list\"     lq3nc <- Q.test(formula = f1, data = nc, m = 5, r = 2, control = list(dtmaxknn = 5) ) print(lq3nc) #> [[1]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable QSID79  m =  5  r =  2 #> Qp = 43.935, df = 1023, p-value = 1 #>  #>  #> [[2]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable QSID79  m =  5  r =  2 #> Qc = 18.923, df = 55, p-value = 1 #>  #>  #> [[3]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable QBIR79  m =  5  r =  2 #> Qp = 44.361, df = 1023, p-value = 1 #>  #>  #> [[4]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable QBIR79  m =  5  r =  2 #> Qc = 20.16, df = 55, p-value = 1 #>  #>  #> attr(,\"class\") #> [1] \"spqtest\" \"list\"     # Case 5: Examples with points and matrix of variables fx <- matrix(c(nc$QBIR79, nc$QSID79), ncol = 2, byrow = TRUE) mctr <- suppressWarnings(sf::st_centroid(st_geometry(nc))) mcoor <- st_coordinates(mctr)[,c(\"X\",\"Y\")] q.test <- Q.test(fx = fx, coor = mcoor, m = 5, r = 2,                  control = list(seedinit = 1111, dtmaxpc = 0.5)) #>  #>  Threshold distance:  4.136024 #>  None m-surrounding excluded for exceeding #>         the threshold distance  #>  #>  Threshold distance:  4.136024 #>  None m-surrounding excluded for exceeding #>         the threshold distance  print(q.test) #> [[1]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable V1  m =  5  r =  2 #> Qp = 221.87, df = 1023, p-value = 1 #>  #>  #> [[2]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable V1  m =  5  r =  2 #> Qc = 55.411, df = 55, p-value = 0.4591 #>  #>  #> [[3]] #>  #> \tQp (asymptotic distrib.) for standard symbolization based on #> \tpermutations #>  #> data:  Variable V2  m =  5  r =  2 #> Qp = 220.68, df = 1023, p-value = 1 #>  #>  #> [[4]] #>  #> \tQc (asymptotic distrib.) for equivalent symbolization based on #> \tcombinations #>  #> data:  Variable V2  m =  5  r =  2 #> Qc = 38.975, df = 55, p-value = 0.9498 #>  #>  #> attr(,\"class\") #> [1] \"spqtest\" \"list\"    plot(q.test) #> [[1]]  #>  #> [[2]]  #>  #> [[3]]  #>  #> [[4]]  #>   # }"},{"path":"https://f8l5h9.github.io/spqdep/reference/cr_symb.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to create symbols — cr_symb","title":"A function to create symbols — cr_symb","text":"function obtains set symbols get Q-statistic","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/cr_symb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to create symbols — cr_symb","text":"","code":"cr_symb(k = k, m = m)"},{"path":"https://f8l5h9.github.io/spqdep/reference/cr_symb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to create symbols — cr_symb","text":"k number categories m length m-surrounding","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/cr_symb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to create symbols — cr_symb","text":"list two types symbols. Permutation Combinations-totals","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/cr_symb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"A function to create symbols — cr_symb","text":"...","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/cr_symb.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A function to create symbols — cr_symb","text":"Ruiz M, López FA, Páez. (2010). Testing spatial association qualitative     data using symbolic dynamics. Journal Geographical Systems. 12 (3) 281-309","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/cr_symb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A function to create symbols — cr_symb","text":"","code":"# Example 1: Obtain symbols for k=2 classes and m-surroundings of size 5 symb25 <- cr_symb(2,5) symb25$p_symb # Permutations symbols #>        [,1] [,2] [,3] [,4] [,5] #> Perm1     1    1    1    1    1 #> Perm2     1    1    1    1    2 #> Perm3     1    1    1    2    1 #> Perm4     1    1    1    2    2 #> Perm5     1    1    2    1    1 #> Perm6     1    1    2    1    2 #> Perm7     1    1    2    2    1 #> Perm8     1    1    2    2    2 #> Perm9     1    2    1    1    1 #> Perm10    1    2    1    1    2 #> Perm11    1    2    1    2    1 #> Perm12    1    2    1    2    2 #> Perm13    1    2    2    1    1 #> Perm14    1    2    2    1    2 #> Perm15    1    2    2    2    1 #> Perm16    1    2    2    2    2 #> Perm17    2    1    1    1    1 #> Perm18    2    1    1    1    2 #> Perm19    2    1    1    2    1 #> Perm20    2    1    1    2    2 #> Perm21    2    1    2    1    1 #> Perm22    2    1    2    1    2 #> Perm23    2    1    2    2    1 #> Perm24    2    1    2    2    2 #> Perm25    2    2    1    1    1 #> Perm26    2    2    1    1    2 #> Perm27    2    2    1    2    1 #> Perm28    2    2    1    2    2 #> Perm29    2    2    2    1    1 #> Perm30    2    2    2    1    2 #> Perm31    2    2    2    2    1 #> Perm32    2    2    2    2    2 symb25$c_symb # Combinations-totals symbols #>      level1 level2 #> [1,]      5      0 #> [2,]      4      1 #> [3,]      3      2 #> [4,]      2      3 #> [5,]      1      4 #> [6,]      0      5"},{"path":"https://f8l5h9.github.io/spqdep/reference/dgp.spq.html","id":null,"dir":"Reference","previous_headings":"","what":"Generation of qualitative process with spatial structure — dgp.spq","title":"Generation of qualitative process with spatial structure — dgp.spq","text":"purpose function dgp.spq generate random dataset dimensions spatial structure decided user. function may useful pure simulation experiments aim showing specific properties characteristics spatial qualitative dataset.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/dgp.spq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generation of qualitative process with spatial structure — dgp.spq","text":"","code":"dgp.spq(listw = listw, p = p,  rho = rho, control = list())"},{"path":"https://f8l5h9.github.io/spqdep/reference/dgp.spq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generation of qualitative process with spatial structure — dgp.spq","text":"listw listw object class nb, knn, listw o matrix created example   nb2listw spatialreg package;   nb2listw given, set   spatial weights listw argument. can   also spatial weighting matrix order (NxN) instead   listw object. Default = NULL. p vector percentage elements categories. lengths must number categories. sum elements vector must 1. rho level spatial dependence (values -1 y 1) control List additional control arguments. See control argument section.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/dgp.spq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generation of qualitative process with spatial structure — dgp.spq","text":"factor length N (listw matrix order (NxN)) levels first capital letters: \"\", \"B\", .... description DGP available Páez et al. 2010 (pag 291) details section.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/dgp.spq.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generation of qualitative process with spatial structure — dgp.spq","text":"order obtain categorical random variables controlled degrees  spatial dependence, designed two- stage data generating process:  Firstly, simulate autocorrelated data using following model:  $$Y = (- \\rho W)^{-1} \\epsilon$$  \\(\\epsilon = N(0,1)\\) \\(N \\times N\\) identity matrix, \\(\\rho\\) parameter   spatial dependence, W connectivity matrix   determines set spatial relationships among points.   second step data generation process, continuous spatially   autocorrelated variable Y used define discrete spatial process   follows. Let \\(b_{ij}\\) defined :   $$p(Y \\leq b_{ij})= {\\j} \\ \\ \\ \\ \\ \\ <j$$   Let \\(=\\{a_1,a_2,...,a_k\\}\\) define discrete spatial process :   $$X_s=a_1 \\ \\ \\ \\ \\ \\ Y_s \\leq b_{1k}$$   $$X_s=a_i \\ \\ \\ \\ \\ \\ b_{-1k} < Y_s \\leq b_{ik}$$   $$X_s=a_k \\ \\ \\ \\ \\ \\ Y_s > b_{k-1k}$$","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/dgp.spq.html","id":"control-arguments","dir":"Reference","previous_headings":"","what":"Control arguments","title":"Generation of qualitative process with spatial structure — dgp.spq","text":"seedinit seed generate data sets","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/dgp.spq.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generation of qualitative process with spatial structure — dgp.spq","text":"Ruiz M, López FA, Páez. (2010). Testing spatial association qualitative     data using symbolic dynamics. Journal Geographical Systems. 12 (3) 281-309","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/dgp.spq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generation of qualitative process with spatial structure — dgp.spq","text":"","code":"# N <- 100 cx <- runif(N) cy <- runif(N) coor <- cbind(cx,cy) p <- c(1/6,3/6,2/6) rho = 0.5 listw <- spdep::nb2listw(spdep::knn2nb(spdep::knearneigh(cbind(cx,cy), k = 4))) xf <- dgp.spq(list = listw, p = p, rho = rho)  data(provinces_spain) listw <- spdep::poly2nb(provinces_spain, queen = FALSE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar p <- c(1/6,3/6,2/6) rho = 0.9 xf <- dgp.spq(p = p, listw = listw, rho = rho) provinces_spain$xf <- xf plot(provinces_spain[\"xf\"])"},{"path":"https://f8l5h9.github.io/spqdep/reference/jc.test.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to compute joint-count test for\n  binomial and multinomial (asymptotic and\n  permutation distributions). — jc.test","title":"A function to compute joint-count test for\n  binomial and multinomial (asymptotic and\n  permutation distributions). — jc.test","text":"function compute joincount   tests spatial qualitative data. function   wrapper joincount.multi   joincount.test   spdep package.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/jc.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to compute joint-count test for\n  binomial and multinomial (asymptotic and\n  permutation distributions). — jc.test","text":"","code":"jc.test(formula = NULL,                data = NULL,                fx = NULL,                listw = NULL,                na.action,                zero.policy = NULL,                distr = \"asymptotic\",                alternative = \"greater\",                control =list())"},{"path":"https://f8l5h9.github.io/spqdep/reference/jc.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to compute joint-count test for\n  binomial and multinomial (asymptotic and\n  permutation distributions). — jc.test","text":"formula symbolic description factor(s). data (optional) data frame sf object points/multipolygons geometry containing variable(s) tested. fx factor  matrix factors columns listw listw object created example nb2listw spdep package; nb2listw given, spatial weights built using object given listw argument (usually sf object). Default = NULL. na.action function (default options(\"na.action\")), can also na.omit na.exclude. may necessary set zero.policy TRUE subsetting may create -neighbour observations. zero.policy Similar corresponding parameter lagsarlm function spatialreg package. TRUE assign zero lagged value zones without neighbours. Default = NULL. distr character. Distribution type \"asymptotic\" (default) \"mc\". alternative character string specifying alternative hypothesis, must one \"greater\" (default), \"less\". control list additional arguments.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/jc.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to compute joint-count test for\n  binomial and multinomial (asymptotic and\n  permutation distributions). — jc.test","text":"spjctest object. type object   list htest objects.   length list number   factor variables included formula number columns   fx.   element list can jclist object, binomial factors,   jcmulti object multinomial   factors. See joincount.test  joincount.multi  additional details.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/jc.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A function to compute joint-count test for\n  binomial and multinomial (asymptotic and\n  permutation distributions). — jc.test","text":"Cliff, . D., Ord, J. K. 1981 Spatial processes, Pion, pp. 19-20. Upton, G., Fingleton, B. 1985 Spatial data analysis example: point pattern qualitative data, Wiley, pp. 158–170.","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/jc.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A function to compute joint-count test for\n  binomial and multinomial (asymptotic and\n  permutation distributions). — jc.test","text":"","code":"## Case 1 ## Multinomial + Binomial using a sf multipolygon # \\donttest{ data(\"provinces_spain\") sf::sf_use_s2(FALSE) provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") provinces_spain$Older <- cut(provinces_spain$Older, breaks = c(-Inf,19,22.5,Inf)) levels(provinces_spain$Older) = c(\"low\",\"middle\",\"high\") f1 <- ~ Older + Male2Female jc1 <- jc.test(formula = f1,                data = provinces_spain,                distr = \"mc\",                alternative = \"greater\",                zero.policy = TRUE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar summary(jc1) #> <div id=\"rgrdpswsrb\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #rgrdpswsrb .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #rgrdpswsrb .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #rgrdpswsrb .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #rgrdpswsrb .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #rgrdpswsrb .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #rgrdpswsrb .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #rgrdpswsrb .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #rgrdpswsrb .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #rgrdpswsrb .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #rgrdpswsrb .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #rgrdpswsrb .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #rgrdpswsrb .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #rgrdpswsrb .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #rgrdpswsrb .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #rgrdpswsrb .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #rgrdpswsrb .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #rgrdpswsrb .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #rgrdpswsrb .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #rgrdpswsrb .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #rgrdpswsrb .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #rgrdpswsrb .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #rgrdpswsrb .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #rgrdpswsrb .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #rgrdpswsrb .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #rgrdpswsrb .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #rgrdpswsrb .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #rgrdpswsrb .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #rgrdpswsrb .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #rgrdpswsrb .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #rgrdpswsrb .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #rgrdpswsrb .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #rgrdpswsrb .gt_left { #>   text-align: left; #> } #>  #> #rgrdpswsrb .gt_center { #>   text-align: center; #> } #>  #> #rgrdpswsrb .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #rgrdpswsrb .gt_font_normal { #>   font-weight: normal; #> } #>  #> #rgrdpswsrb .gt_font_bold { #>   font-weight: bold; #> } #>  #> #rgrdpswsrb .gt_font_italic { #>   font-style: italic; #> } #>  #> #rgrdpswsrb .gt_super { #>   font-size: 65%; #> } #>  #> #rgrdpswsrb .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #rgrdpswsrb .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #rgrdpswsrb .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #rgrdpswsrb .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #rgrdpswsrb .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"5\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>JoinCount Spatial Tests (Monte Carlo)<\/th> #>     <\/tr> #>      #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">pairs<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">pvalue<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Joincount<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Expected<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Variance<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"5\" class=\"gt_group_heading\">Older - multinomial - alternative: greater - Monte-Carlo simulation of #>         join-count statistic (nonfree sampling)<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_left\">high:high<\/td> #> <td class=\"gt_row gt_right\">0.44100<\/td> #> <td class=\"gt_row gt_right\">14<\/td> #> <td class=\"gt_row gt_right\">13.99<\/td> #> <td class=\"gt_row gt_right\">11.06<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">low:low<\/td> #> <td class=\"gt_row gt_right\">0.69700<\/td> #> <td class=\"gt_row gt_right\">7<\/td> #> <td class=\"gt_row gt_right\">8.31<\/td> #> <td class=\"gt_row gt_right\">6.57<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">middle:middle<\/td> #> <td class=\"gt_row gt_right\">0.54900<\/td> #> <td class=\"gt_row gt_right\">13<\/td> #> <td class=\"gt_row gt_right\">13.83<\/td> #> <td class=\"gt_row gt_right\">10.44<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">low:high<\/td> #> <td class=\"gt_row gt_right\">0.35800<\/td> #> <td class=\"gt_row gt_right\">24<\/td> #> <td class=\"gt_row gt_right\">22.88<\/td> #> <td class=\"gt_row gt_right\">15.87<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">middle:high<\/td> #> <td class=\"gt_row gt_right\">0.57000<\/td> #> <td class=\"gt_row gt_right\">28<\/td> #> <td class=\"gt_row gt_right\">29.15<\/td> #> <td class=\"gt_row gt_right\">20.45<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">middle:low<\/td> #> <td class=\"gt_row gt_right\">0.30300<\/td> #> <td class=\"gt_row gt_right\">25<\/td> #> <td class=\"gt_row gt_right\">22.83<\/td> #> <td class=\"gt_row gt_right\">17.09<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">Jtot<\/td> #> <td class=\"gt_row gt_right\">0.38300<\/td> #> <td class=\"gt_row gt_right\">77<\/td> #> <td class=\"gt_row gt_right\">74.86<\/td> #> <td class=\"gt_row gt_right\">23.27<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"5\" class=\"gt_group_heading\">Male2Female - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_left\">men-men<\/td> #> <td class=\"gt_row gt_right\">0.55100<\/td> #> <td class=\"gt_row gt_right\">60<\/td> #> <td class=\"gt_row gt_right\">60.62<\/td> #> <td class=\"gt_row gt_right\">22.64<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">woman-woman<\/td> #> <td class=\"gt_row gt_right\">0.01500<\/td> #> <td class=\"gt_row gt_right\">13<\/td> #> <td class=\"gt_row gt_right\">6.98<\/td> #> <td class=\"gt_row gt_right\">5.89<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div>  provinces_spain$Coast <- factor(provinces_spain$Coast) levels(provinces_spain$Coast) = c(\"no\",\"yes\") f2 <- ~ Male2Female + Coast jc2 <- jc.test(formula = f2,                data = provinces_spain,                distr = \"mc\",                zero.policy = TRUE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar summary(jc2) #> <div id=\"krjaggrbnb\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #krjaggrbnb .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #krjaggrbnb .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #krjaggrbnb .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #krjaggrbnb .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #krjaggrbnb .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #krjaggrbnb .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #krjaggrbnb .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #krjaggrbnb .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #krjaggrbnb .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #krjaggrbnb .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #krjaggrbnb .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #krjaggrbnb .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #krjaggrbnb .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #krjaggrbnb .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #krjaggrbnb .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #krjaggrbnb .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #krjaggrbnb .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #krjaggrbnb .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #krjaggrbnb .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #krjaggrbnb .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #krjaggrbnb .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #krjaggrbnb .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #krjaggrbnb .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #krjaggrbnb .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #krjaggrbnb .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #krjaggrbnb .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #krjaggrbnb .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #krjaggrbnb .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #krjaggrbnb .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #krjaggrbnb .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #krjaggrbnb .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #krjaggrbnb .gt_left { #>   text-align: left; #> } #>  #> #krjaggrbnb .gt_center { #>   text-align: center; #> } #>  #> #krjaggrbnb .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #krjaggrbnb .gt_font_normal { #>   font-weight: normal; #> } #>  #> #krjaggrbnb .gt_font_bold { #>   font-weight: bold; #> } #>  #> #krjaggrbnb .gt_font_italic { #>   font-style: italic; #> } #>  #> #krjaggrbnb .gt_super { #>   font-size: 65%; #> } #>  #> #krjaggrbnb .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #krjaggrbnb .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #krjaggrbnb .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #krjaggrbnb .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #krjaggrbnb .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"5\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>JoinCount Spatial Tests (Monte Carlo)<\/th> #>     <\/tr> #>      #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">pairs<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">pvalue<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Joincount<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Expected<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Variance<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"5\" class=\"gt_group_heading\">Male2Female - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_left\">men-men<\/td> #> <td class=\"gt_row gt_right\">0.52200<\/td> #> <td class=\"gt_row gt_right\">60<\/td> #> <td class=\"gt_row gt_right\">60.46<\/td> #> <td class=\"gt_row gt_right\">22.66<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">woman-woman<\/td> #> <td class=\"gt_row gt_right\">0.01000<\/td> #> <td class=\"gt_row gt_right\">13<\/td> #> <td class=\"gt_row gt_right\">6.96<\/td> #> <td class=\"gt_row gt_right\">5.66<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"5\" class=\"gt_group_heading\">Coast - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_left\">no-no<\/td> #> <td class=\"gt_row gt_right\">0.00100<\/td> #> <td class=\"gt_row gt_right\">64<\/td> #> <td class=\"gt_row gt_right\">36.62<\/td> #> <td class=\"gt_row gt_right\">22.03<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">yes-yes<\/td> #> <td class=\"gt_row gt_right\">0.90450<\/td> #> <td class=\"gt_row gt_right\">14<\/td> #> <td class=\"gt_row gt_right\">18.84<\/td> #> <td class=\"gt_row gt_right\">14.13<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div> # }  # Case 2: ## Multinomial using a sf multipoint data(\"FastFood.sf\") sf::sf_use_s2(FALSE) f1 <- ~ Type jc3 <- jc.test(formula = f1,                data = FastFood.sf,                distr = \"asymptotic\",                control = list(knn = 6)) #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: knearneigh: coordinates are not geographical: longlat argument wrong  summary(jc3) #> <div id=\"ltmvkjwapz\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #ltmvkjwapz .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #ltmvkjwapz .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #ltmvkjwapz .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #ltmvkjwapz .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #ltmvkjwapz .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #ltmvkjwapz .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #ltmvkjwapz .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #ltmvkjwapz .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #ltmvkjwapz .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #ltmvkjwapz .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #ltmvkjwapz .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #ltmvkjwapz .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #ltmvkjwapz .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #ltmvkjwapz .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #ltmvkjwapz .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #ltmvkjwapz .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #ltmvkjwapz .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ltmvkjwapz .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #ltmvkjwapz .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #ltmvkjwapz .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ltmvkjwapz .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #ltmvkjwapz .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #ltmvkjwapz .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #ltmvkjwapz .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ltmvkjwapz .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #ltmvkjwapz .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #ltmvkjwapz .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #ltmvkjwapz .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #ltmvkjwapz .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ltmvkjwapz .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #ltmvkjwapz .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ltmvkjwapz .gt_left { #>   text-align: left; #> } #>  #> #ltmvkjwapz .gt_center { #>   text-align: center; #> } #>  #> #ltmvkjwapz .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #ltmvkjwapz .gt_font_normal { #>   font-weight: normal; #> } #>  #> #ltmvkjwapz .gt_font_bold { #>   font-weight: bold; #> } #>  #> #ltmvkjwapz .gt_font_italic { #>   font-style: italic; #> } #>  #> #ltmvkjwapz .gt_super { #>   font-size: 65%; #> } #>  #> #ltmvkjwapz .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #ltmvkjwapz .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #ltmvkjwapz .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #ltmvkjwapz .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #ltmvkjwapz .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"6\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>JoinCount Spatial Tests (asymptotic)<\/th> #>     <\/tr> #>      #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">pairs<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">z-value<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">pvalue<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Joincount<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Expected<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Variance<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"6\" class=\"gt_group_heading\">Type - multinomial - alternative: greater - Join count test under nonfree sampling<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_left\">H:H<\/td> #> <td class=\"gt_row gt_right\">&minus;0.23<\/td> #> <td class=\"gt_row gt_right\">0.58942<\/td> #> <td class=\"gt_row gt_right\">255.5<\/td> #> <td class=\"gt_row gt_right\">258.05<\/td> #> <td class=\"gt_row gt_right\">127.06<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">P:P<\/td> #> <td class=\"gt_row gt_right\">0.30<\/td> #> <td class=\"gt_row gt_right\">0.38114<\/td> #> <td class=\"gt_row gt_right\">317.0<\/td> #> <td class=\"gt_row gt_right\">313.38<\/td> #> <td class=\"gt_row gt_right\">143.47<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">S:S<\/td> #> <td class=\"gt_row gt_right\">&minus;1.82<\/td> #> <td class=\"gt_row gt_right\">0.96574<\/td> #> <td class=\"gt_row gt_right\">283.5<\/td> #> <td class=\"gt_row gt_right\">305.14<\/td> #> <td class=\"gt_row gt_right\">141.19<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">P:H<\/td> #> <td class=\"gt_row gt_right\">0.02<\/td> #> <td class=\"gt_row gt_right\">0.49358<\/td> #> <td class=\"gt_row gt_right\">571.0<\/td> #> <td class=\"gt_row gt_right\">570.72<\/td> #> <td class=\"gt_row gt_right\">304.67<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">S:H<\/td> #> <td class=\"gt_row gt_right\">0.05<\/td> #> <td class=\"gt_row gt_right\">0.48128<\/td> #> <td class=\"gt_row gt_right\">564.0<\/td> #> <td class=\"gt_row gt_right\">563.18<\/td> #> <td class=\"gt_row gt_right\">301.61<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">S:P<\/td> #> <td class=\"gt_row gt_right\">1.08<\/td> #> <td class=\"gt_row gt_right\">0.14022<\/td> #> <td class=\"gt_row gt_right\">640.0<\/td> #> <td class=\"gt_row gt_right\">620.53<\/td> #> <td class=\"gt_row gt_right\">325.50<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">Jtot<\/td> #> <td class=\"gt_row gt_right\">0.90<\/td> #> <td class=\"gt_row gt_right\">0.18350<\/td> #> <td class=\"gt_row gt_right\">1775.0<\/td> #> <td class=\"gt_row gt_right\">1,754.43<\/td> #> <td class=\"gt_row gt_right\">519.87<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div>  # Examples function joincount.test data(oldcol, package = \"spdep\") HICRIME <- cut(COL.OLD$CRIME, breaks = c(0,35,80), labels = c(\"low\",\"high\")) names(HICRIME) <- rownames(COL.OLD) jc4 <- jc.test(fx = HICRIME,                listw = spdep::nb2listw(COL.nb,                style=\"B\")) summary(jc4) #> <div id=\"hbyizqonme\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #hbyizqonme .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #hbyizqonme .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #hbyizqonme .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #hbyizqonme .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #hbyizqonme .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #hbyizqonme .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #hbyizqonme .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #hbyizqonme .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #hbyizqonme .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #hbyizqonme .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #hbyizqonme .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #hbyizqonme .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #hbyizqonme .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #hbyizqonme .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #hbyizqonme .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #hbyizqonme .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #hbyizqonme .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #hbyizqonme .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #hbyizqonme .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #hbyizqonme .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #hbyizqonme .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #hbyizqonme .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #hbyizqonme .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #hbyizqonme .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #hbyizqonme .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #hbyizqonme .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #hbyizqonme .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #hbyizqonme .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #hbyizqonme .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #hbyizqonme .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #hbyizqonme .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #hbyizqonme .gt_left { #>   text-align: left; #> } #>  #> #hbyizqonme .gt_center { #>   text-align: center; #> } #>  #> #hbyizqonme .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #hbyizqonme .gt_font_normal { #>   font-weight: normal; #> } #>  #> #hbyizqonme .gt_font_bold { #>   font-weight: bold; #> } #>  #> #hbyizqonme .gt_font_italic { #>   font-style: italic; #> } #>  #> #hbyizqonme .gt_super { #>   font-size: 65%; #> } #>  #> #hbyizqonme .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #hbyizqonme .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #hbyizqonme .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #hbyizqonme .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #hbyizqonme .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"6\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>JoinCount Spatial Tests (asymptotic)<\/th> #>     <\/tr> #>      #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">pairs<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">z-value<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">pvalue<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Joincount<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Expected<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Variance<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"6\" class=\"gt_group_heading\">fx - binomial - alternative: greater - Join count test under nonfree sampling<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_left\">high-high<\/td> #> <td class=\"gt_row gt_right\">6.33<\/td> #> <td class=\"gt_row gt_right\">0.00000<\/td> #> <td class=\"gt_row gt_right\">54<\/td> #> <td class=\"gt_row gt_right\">27.22<\/td> #> <td class=\"gt_row gt_right\">17.89<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">low-low<\/td> #> <td class=\"gt_row gt_right\">1.01<\/td> #> <td class=\"gt_row gt_right\">0.15527<\/td> #> <td class=\"gt_row gt_right\">34<\/td> #> <td class=\"gt_row gt_right\">29.59<\/td> #> <td class=\"gt_row gt_right\">18.90<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">high-low<\/td> #> <td class=\"gt_row gt_right\">&minus;6.09<\/td> #> <td class=\"gt_row gt_right\">1.00000<\/td> #> <td class=\"gt_row gt_right\">28<\/td> #> <td class=\"gt_row gt_right\">59.18<\/td> #> <td class=\"gt_row gt_right\">26.23<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div>  jc5 <- jc.test(fx = HICRIME,                 listw = spdep::nb2listw(COL.nb, style=\"B\"),                 distr = \"mc\")  summary(jc5) #> <div id=\"ojlndidqrg\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #ojlndidqrg .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #ojlndidqrg .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #ojlndidqrg .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #ojlndidqrg .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #ojlndidqrg .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #ojlndidqrg .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #ojlndidqrg .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #ojlndidqrg .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #ojlndidqrg .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #ojlndidqrg .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #ojlndidqrg .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #ojlndidqrg .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #ojlndidqrg .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #ojlndidqrg .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #ojlndidqrg .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #ojlndidqrg .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #ojlndidqrg .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ojlndidqrg .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #ojlndidqrg .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #ojlndidqrg .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ojlndidqrg .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #ojlndidqrg .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #ojlndidqrg .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #ojlndidqrg .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ojlndidqrg .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #ojlndidqrg .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #ojlndidqrg .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #ojlndidqrg .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #ojlndidqrg .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ojlndidqrg .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #ojlndidqrg .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ojlndidqrg .gt_left { #>   text-align: left; #> } #>  #> #ojlndidqrg .gt_center { #>   text-align: center; #> } #>  #> #ojlndidqrg .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #ojlndidqrg .gt_font_normal { #>   font-weight: normal; #> } #>  #> #ojlndidqrg .gt_font_bold { #>   font-weight: bold; #> } #>  #> #ojlndidqrg .gt_font_italic { #>   font-style: italic; #> } #>  #> #ojlndidqrg .gt_super { #>   font-size: 65%; #> } #>  #> #ojlndidqrg .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #ojlndidqrg .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #ojlndidqrg .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #ojlndidqrg .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #ojlndidqrg .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"5\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>JoinCount Spatial Tests (Monte Carlo)<\/th> #>     <\/tr> #>      #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">pairs<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">pvalue<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Joincount<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Expected<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Variance<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"5\" class=\"gt_group_heading\">fx - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_left\">high-high<\/td> #> <td class=\"gt_row gt_right\">0.00100<\/td> #> <td class=\"gt_row gt_right\">54<\/td> #> <td class=\"gt_row gt_right\">27.37<\/td> #> <td class=\"gt_row gt_right\">18.76<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">low-low<\/td> #> <td class=\"gt_row gt_right\">0.13600<\/td> #> <td class=\"gt_row gt_right\">34<\/td> #> <td class=\"gt_row gt_right\">29.38<\/td> #> <td class=\"gt_row gt_right\">18.08<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div>  HICRIME <- cut(COL.OLD$CRIME, breaks = c(0, 35, 80),                 labels = c(\"low\",\"high\"))  names(HICRIME) <- rownames(COL.OLD)  jc6 <- jc.test(fx = HICRIME,                 listw = spdep::nb2listw(COL.nb,                                  style = \"B\")) summary(jc6) #> <div id=\"zcgtvsbuev\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #zcgtvsbuev .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #zcgtvsbuev .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #zcgtvsbuev .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #zcgtvsbuev .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #zcgtvsbuev .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #zcgtvsbuev .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #zcgtvsbuev .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #zcgtvsbuev .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #zcgtvsbuev .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #zcgtvsbuev .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #zcgtvsbuev .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #zcgtvsbuev .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #zcgtvsbuev .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #zcgtvsbuev .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #zcgtvsbuev .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #zcgtvsbuev .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #zcgtvsbuev .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #zcgtvsbuev .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #zcgtvsbuev .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #zcgtvsbuev .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #zcgtvsbuev .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #zcgtvsbuev .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #zcgtvsbuev .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #zcgtvsbuev .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #zcgtvsbuev .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #zcgtvsbuev .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #zcgtvsbuev .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #zcgtvsbuev .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #zcgtvsbuev .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #zcgtvsbuev .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #zcgtvsbuev .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #zcgtvsbuev .gt_left { #>   text-align: left; #> } #>  #> #zcgtvsbuev .gt_center { #>   text-align: center; #> } #>  #> #zcgtvsbuev .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #zcgtvsbuev .gt_font_normal { #>   font-weight: normal; #> } #>  #> #zcgtvsbuev .gt_font_bold { #>   font-weight: bold; #> } #>  #> #zcgtvsbuev .gt_font_italic { #>   font-style: italic; #> } #>  #> #zcgtvsbuev .gt_super { #>   font-size: 65%; #> } #>  #> #zcgtvsbuev .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #zcgtvsbuev .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #zcgtvsbuev .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #zcgtvsbuev .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #zcgtvsbuev .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"6\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>JoinCount Spatial Tests (asymptotic)<\/th> #>     <\/tr> #>      #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">pairs<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">z-value<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">pvalue<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Joincount<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Expected<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Variance<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"6\" class=\"gt_group_heading\">fx - binomial - alternative: greater - Join count test under nonfree sampling<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_left\">high-high<\/td> #> <td class=\"gt_row gt_right\">6.33<\/td> #> <td class=\"gt_row gt_right\">0.00000<\/td> #> <td class=\"gt_row gt_right\">54<\/td> #> <td class=\"gt_row gt_right\">27.22<\/td> #> <td class=\"gt_row gt_right\">17.89<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">low-low<\/td> #> <td class=\"gt_row gt_right\">1.01<\/td> #> <td class=\"gt_row gt_right\">0.15527<\/td> #> <td class=\"gt_row gt_right\">34<\/td> #> <td class=\"gt_row gt_right\">29.59<\/td> #> <td class=\"gt_row gt_right\">18.90<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">high-low<\/td> #> <td class=\"gt_row gt_right\">&minus;6.09<\/td> #> <td class=\"gt_row gt_right\">1.00000<\/td> #> <td class=\"gt_row gt_right\">28<\/td> #> <td class=\"gt_row gt_right\">59.18<\/td> #> <td class=\"gt_row gt_right\">26.23<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div>"},{"path":"https://f8l5h9.github.io/spqdep/reference/local.jc.test.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to calculate the local Join Count tests. — local.jc.test","title":"A function to calculate the local Join Count tests. — local.jc.test","text":"function calculates local Join Count tests.function   wrapper local_joincount rgeoda package.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/local.jc.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to calculate the local Join Count tests. — local.jc.test","text":"","code":"local.jc.test(formula = NULL, data = NULL, fx = NULL, case = NULL, coor = NULL,  listw = listw, nsim = 999, control = list())"},{"path":"https://f8l5h9.github.io/spqdep/reference/local.jc.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to calculate the local Join Count tests. — local.jc.test","text":"formula (optional) formula factor included data data (optional) data frame sf object containing variable testing . fx (optional) factor observations length neighbours list listw case level factor used obtain local Join Count test. See details. coor (optional) 2xN vector spatial coordinates. Used *data* spatial object. listw neighbourhood list (object type knn, listw nb). nsim number permutation obtain local Join Count tests. Default value 999. control Optional argument. See Control argument section.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/local.jc.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to calculate the local Join Count tests. — local.jc.test","text":"output object class localjc local.SRQ matrix ","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/local.jc.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"A function to calculate the local Join Count tests. — local.jc.test","text":"test develop Anselin Li (2019) can apply binary variables (usually named B W), count number joins type B-B proportion  observations B lower half. interest lies identifying co-occurrences uncommon events, .e., situations observations take value B constitute much less half sample.  statistic defined : $$BB_i = x_i  \\sum_j{w_{ij}x_j}$$ meaningful observations \\(x_i=1\\), since \\(x_i=0\\) result always equal zero. object listw can class: knn: Objects class knn consider neighbours     order proximity. nb: neighbours obtained sf object, code internally     call function nb2nb_order order order     proximity centroids. matrix: object matrix class based inverse     distance introduced argument, function nb2nb_order     also called internally transform object class matrix matrix      class nb ordered neighbours.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/local.jc.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A function to calculate the local Join Count tests. — local.jc.test","text":"Anselin, L., Li, X. (2019).     Operational local join Count statistics cluster detection.       Journal Geographical Systems, 21(2), 189-210.","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/local.jc.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A function to calculate the local Join Count tests. — local.jc.test","text":"","code":"# Case 1: Local spatial runs test based on knn library(lwgeom) #> Linking to liblwgeom 3.0.0beta1 r16016, GEOS 3.8.0, PROJ 6.3.1 N <- 100 cx <- runif(N) cy <- runif(N) coor <- cbind(cx,cy) listw <- spdep::knearneigh(coor, k = 4) p <- c(1/2,1/2) rho <- 0.5 fx <- dgp.spq(p = p, listw = listw, rho = rho) ljc <- local.jc.test(fx = fx, coor = coor, case= \"A\", listw = listw) print(ljc) #>     nn ljc pseudo.value #> 1    4   0           NA #> 2    4   1        0.053 #> 3    4   2        0.305 #> 4    4   0           NA #> 5    4   0           NA #> 6    4   3        0.314 #> 7    4   3        0.321 #> 8    4   2        0.316 #> 9    4   4        0.062 #> 10   4   3        0.321 #> 11   4   0           NA #> 12   4   0           NA #> 13   4   0           NA #> 14   4   0           NA #> 15   4   0           NA #> 16   4   0           NA #> 17   4   3        0.288 #> 18   4   0           NA #> 19   4   2        0.289 #> 20   4   0           NA #> 21   4   0           NA #> 22   4   2        0.304 #> 23   4   0           NA #> 24   4   0           NA #> 25   4   0           NA #> 26   4   0           NA #> 27   4   0           NA #> 28   4   0           NA #> 29   4   0           NA #> 30   4   0           NA #> 31   4   0           NA #> 32   4   0           NA #> 33   4   2        0.302 #> 34   4   3        0.333 #> 35   4   1        0.057 #> 36   4   4        0.052 #> 37   4   0           NA #> 38   4   4        0.069 #> 39   4   0           NA #> 40   4   0           NA #> 41   4   2        0.292 #> 42   4   0           NA #> 43   4   0           NA #> 44   4   0           NA #> 45   4   0           NA #> 46   4   1        0.053 #> 47   4   0           NA #> 48   4   1        0.065 #> 49   4   3        0.317 #> 50   4   1        0.064 #> 51   4   2        0.294 #> 52   4   1        0.049 #> 53   4   4        0.056 #> 54   4   0           NA #> 55   4   3        0.342 #> 56   4   1        0.050 #> 57   4   0           NA #> 58   4   2        0.321 #> 59   4   3        0.303 #> 60   4   0           NA #> 61   4   0           NA #> 62   4   3        0.328 #> 63   4   0           NA #> 64   4   0           NA #> 65   4   0           NA #> 66   4   0           NA #> 67   4   2        0.327 #> 68   4   1        0.057 #> 69   4   3        0.311 #> 70   4   3        0.310 #> 71   4   0           NA #> 72   4   1        0.051 #> 73   4   0           NA #> 74   4   0           NA #> 75   4   0           NA #> 76   4   0           NA #> 77   4   3        0.328 #> 78   4   1        0.065 #> 79   4   0           NA #> 80   4   3        0.306 #> 81   4   0           NA #> 82   4   1        0.051 #> 83   4   3        0.296 #> 84   4   0           NA #> 85   4   2        0.281 #> 86   4   0           NA #> 87   4   0           NA #> 88   4   0           NA #> 89   4   0           NA #> 90   4   2        0.302 #> 91   4   2        0.287 #> 92   4   0           NA #> 93   4   4        0.071 #> 94   4   3        0.312 #> 95   4   1        0.060 #> 96   4   0           NA #> 97   4   0           NA #> 98   4   2        0.311 #> 99   4   2        0.327 #> 100  4   0           NA plot(ljc, coor = coor, sig = 0.1)   # \\donttest{ # Case 2:Fastfood example. sf (points) library(lwgeom) data(\"FastFood.sf\") sf::sf_use_s2(FALSE) x <- sf::st_coordinates(sf::st_centroid(FastFood.sf)) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: st_centroid does not give correct centroids for longitude/latitude data listw <- spdep::knearneigh(x, k = 6) formula <- ~ Type ljc <- local.jc.test(formula = formula, data = FastFood.sf, case = \"H\",listw = listw) print(ljc) #>     nn ljc pseudo.value #> 1    6  14        0.222 #> 2    6  13        0.411 #> 3    6  13        0.427 #> 4    6  10        0.079 #> 5    6  13        0.431 #> 6    6  13        0.456 #> 7    6  13        0.438 #> 8    6  14        0.234 #> 9    6  13        0.422 #> 10   6  11        0.185 #> 11   6  14        0.254 #> 12   6  12        0.359 #> 13   6  13        0.427 #> 14   6  14        0.253 #> 15   6  13        0.423 #> 16   6  13        0.469 #> 17   6  11        0.197 #> 18   6  12        0.354 #> 19   6  11        0.187 #> 20   6  14        0.236 #> 21   6  13        0.410 #> 22   6  13        0.439 #> 23   6  14        0.229 #> 24   6  14        0.233 #> 25   6  15        0.101 #> 26   6  13        0.451 #> 27   6  13        0.445 #> 28   6  11        0.204 #> 29   6  14        0.244 #> 30   6  14        0.240 #> 31   6  13        0.423 #> 32   6  12        0.359 #> 33   6  12        0.358 #> 34   6  13        0.465 #> 35   6  14        0.235 #> 36   6  14        0.265 #> 37   6  14        0.263 #> 38   6  14        0.254 #> 39   6  13        0.441 #> 40   6  16        0.028 #> 41   6  15        0.091 #> 42   6  12        0.371 #> 43   6  14        0.220 #> 44   6  12        0.355 #> 45   6  13        0.422 #> 46   6  12        0.374 #> 47   6  14        0.288 #> 48   6  13        0.449 #> 49   6  16        0.045 #> 50   6  14        0.250 #> 51   6  13        0.434 #> 52   6  11        0.193 #> 53   6  14        0.249 #> 54   6  12        0.355 #> 55   6  14        0.238 #> 56   6  13        0.463 #> 57   6  13        0.450 #> 58   6  14        0.252 #> 59   6  13        0.428 #> 60   6  14        0.259 #> 61   6  14        0.211 #> 62   6  11        0.177 #> 63   6  10        0.077 #> 64   6  11        0.163 #> 65   6  10        0.055 #> 66   6  10        0.068 #> 67   6  10        0.079 #> 68   6  16        0.051 #> 69   6  12        0.384 #> 70   6  12        0.379 #> 71   6  15        0.109 #> 72   6  11        0.190 #> 73   6  12        0.386 #> 74   6  15        0.131 #> 75   6  11        0.204 #> 76   6  10        0.095 #> 77   6  14        0.277 #> 78   6  14        0.253 #> 79   6  13        0.415 #> 80   6  14        0.243 #> 81   6  16        0.037 #> 82   6  13        0.420 #> 83   6  13        0.406 #> 84   6  12        0.367 #> 85   6  15        0.095 #> 86   6  11        0.171 #> 87   6  11        0.191 #> 88   6  13        0.427 #> 89   6  14        0.252 #> 90   6  14        0.240 #> 91   6  13        0.441 #> 92   6  15        0.122 #> 93   6  14        0.235 #> 94   6  16        0.036 #> 95   6  12        0.379 #> 96   6  12        0.364 #> 97   6  13        0.468 #> 98   6  12        0.384 #> 99   6  13        0.451 #> 100  6  13        0.437 #> 101  6  14        0.255 #> 102  6  13        0.438 #> 103  6  13        0.410 #> 104  6  13        0.413 #> 105  6  14        0.225 #> 106  6  13        0.423 #> 107  6  14        0.221 #> 108  6  13        0.434 #> 109  6  14        0.231 #> 110  6  12        0.357 #> 111  6  11        0.199 #> 112  6  14        0.243 #> 113  6  13        0.446 #> 114  6  13        0.421 #> 115  6  14        0.244 #> 116  6  12        0.364 #> 117  6  15        0.126 #> 118  6  11        0.180 #> 119  6  10        0.097 #> 120  6  13        0.449 #> 121  6  13        0.435 #> 122  6  14        0.277 #> 123  6  11        0.209 #> 124  6  13        0.417 #> 125  6  13        0.405 #> 126  6  15        0.099 #> 127  6  14        0.226 #> 128  6  13        0.414 #> 129  6  12        0.362 #> 130  6  13        0.435 #> 131  6  10        0.104 #> 132  6   9        0.032 #> 133  6  14        0.269 #> 134  6  11        0.177 #> 135  6  13        0.432 #> 136  6  11        0.202 #> 137  6  14        0.254 #> 138  6  13        0.432 #> 139  6  11        0.192 #> 140  6  14        0.254 #> 141  6  10        0.092 #> 142  6  13        0.451 #> 143  6  13        0.449 #> 144  6  12        0.365 #> 145  6  14        0.227 #> 146  6  14        0.209 #> 147  6  10        0.088 #> 148  6  12        0.331 #> 149  6  12        0.335 #> 150  6  13        0.416 #> 151  6  11        0.198 #> 152  6  16        0.038 #> 153  6  15        0.120 #> 154  6  13        0.447 #> 155  6  14        0.249 #> 156  6  11        0.200 #> 157  6  14        0.237 #> 158  6  16        0.034 #> 159  6  14        0.259 #> 160  6  11        0.189 #> 161  6  12        0.364 #> 162  6  12        0.379 #> 163  6  10        0.077 #> 164  6  12        0.370 #> 165  6  14        0.242 #> 166  6  15        0.088 #> 167  6  13        0.408 #> 168  6  12        0.348 #> 169  6  12        0.372 #> 170  6  12        0.342 #> 171  6  11        0.168 #> 172  6  12        0.361 #> 173  6  12        0.357 #> 174  6  14        0.273 #> 175  6  15        0.136 #> 176  6  11        0.222 #> 177  6  12        0.338 #> 178  6  13        0.432 #> 179  6  15        0.111 #> 180  6  14        0.246 #> 181  6  13        0.449 #> 182  6  12        0.374 #> 183  6  14        0.265 #> 184  6  12        0.369 #> 185  6  12        0.355 #> 186  6  14        0.235 #> 187  6  11        0.178 #> 188  6  13        0.421 #> 189  6   9        0.021 #> 190  6  14        0.239 #> 191  6  14        0.225 #> 192  6  12        0.337 #> 193  6  13        0.430 #> 194  6  11        0.206 #> 195  6  12        0.354 #> 196  6  13        0.432 #> 197  6   9        0.028 #> 198  6  13        0.430 #> 199  6  12        0.351 #> 200  6  12        0.348 #> 201  6  15        0.095 #> 202  6  13        0.443 #> 203  6  13        0.452 #> 204  6  15        0.116 #> 205  6  12        0.374 #> 206  6  13        0.435 #> 207  6  14        0.276 #> 208  6  14        0.217 #> 209  6  16        0.032 #> 210  6  13        0.413 #> 211  6  15        0.101 #> 212  6  12        0.333 #> 213  6  12        0.361 #> 214  6  14        0.256 #> 215  6  14        0.248 #> 216  6  13        0.437 #> 217  6  12        0.393 #> 218  6  14        0.241 #> 219  6  12        0.349 #> 220  6  15        0.114 #> 221  6  14        0.261 #> 222  6  13        0.459 #> 223  6  14        0.233 #> 224  6  13        0.451 #> 225  6  13        0.448 #> 226  6  12        0.393 #> 227  6  11        0.202 #> 228  6  10        0.080 #> 229  6  10        0.061 #> 230  6  14        0.226 #> 231  6  10        0.073 #> 232  6  11        0.183 #> 233  6  13        0.409 #> 234  6  11        0.179 #> 235  6  11        0.187 #> 236  6  11        0.173 #> 237  6  11        0.197 #> 238  6  13        0.423 #> 239  6  12        0.375 #> 240  6  13        0.402 #> 241  6  12        0.354 #> 242  6  12        0.358 #> 243  6  10        0.101 #> 244  6  12        0.350 #> 245  6  10        0.102 #> 246  6  12        0.346 #> 247  6  14        0.242 #> 248  6  12        0.360 #> 249  6  15        0.111 #> 250  6  11        0.184 #> 251  6  10        0.060 #> 252  6  12        0.362 #> 253  6  11        0.171 #> 254  6  12        0.345 #> 255  6  15        0.099 #> 256  6  14        0.243 #> 257  6  14        0.261 #> 258  6  12        0.355 #> 259  6  13        0.425 #> 260  6  12        0.379 #> 261  6  12        0.371 #> 262  6  11        0.188 #> 263  6  11        0.183 #> 264  6  10        0.082 #> 265  6  14        0.267 #> 266  6  10        0.095 #> 267  6  14        0.260 #> 268  6  12        0.359 #> 269  6  10        0.092 #> 270  6  12        0.372 #> 271  6  12        0.359 #> 272  6  12        0.342 #> 273  6  13        0.443 #> 274  6  12        0.358 #> 275  6  14        0.221 #> 276  6  16        0.025 #> 277  6  10        0.091 #> 278  6   9        0.041 #> 279  6  11        0.201 #> 280  6  13        0.448 #> 281  6  16        0.044 #> 282  6  14        0.234 #> 283  6   9        0.030 #> 284  6  10        0.082 #> 285  6  13        0.427 #> 286  6  10        0.088 #> 287  6  13        0.418 #> 288  6  12        0.374 #> 289  6  10        0.078 #> 290  6  12        0.371 #> 291  6  12        0.360 #> 292  6  14        0.252 #> 293  6  11        0.160 #> 294  6  13        0.424 #> 295  6  13        0.416 #> 296  6  15        0.110 #> 297  6  12        0.347 #> 298  6  13        0.425 #> 299  6  10        0.080 #> 300  6  13        0.437 #> 301  6  12        0.367 #> 302  6   9        0.024 #> 303  6  13        0.442 #> 304  6  11        0.196 #> 305  6  14        0.246 #> 306  6  13        0.419 #> 307  6  13        0.423 #> 308  6  11        0.211 #> 309  6  14        0.252 #> 310  6  14        0.267 #> 311  6  12        0.363 #> 312  6  12        0.348 #> 313  6  14        0.237 #> 314  6  17        0.006 #> 315  6  10        0.080 #> 316  6  12        0.350 #> 317  6  11        0.168 #> 318  6  14        0.235 #> 319  6  10        0.090 #> 320  6  14        0.259 #> 321  6  11        0.212 #> 322  6  13        0.431 #> 323  6   9        0.030 #> 324  6  12        0.339 #> 325  6  12        0.365 #> 326  6  13        0.423 #> 327  6  13        0.449 #> 328  6  11        0.204 #> 329  6  15        0.131 #> 330  6  11        0.189 #> 331  6  12        0.361 #> 332  6  13        0.449 #> 333  6  12        0.349 #> 334  6  13        0.424 #> 335  6  15        0.095 #> 336  6   9        0.022 #> 337  6  13        0.418 #> 338  6  12        0.346 #> 339  6  11        0.185 #> 340  6  10        0.108 #> 341  6  13        0.453 #> 342  6  12        0.364 #> 343  6  10        0.090 #> 344  6  12        0.348 #> 345  6  12        0.355 #> 346  6  14        0.255 #> 347  6  11        0.195 #> 348  6  12        0.371 #> 349  6  13        0.452 #> 350  6  12        0.378 #> 351  6  10        0.097 #> 352  6  12        0.376 #> 353  6   9        0.033 #> 354  6  15        0.094 #> 355  6  11        0.166 #> 356  6  12        0.358 #> 357  6  11        0.182 #> 358  6  16        0.019 #> 359  6  14        0.250 #> 360  6  13        0.429 #> 361  6  13        0.436 #> 362  6  15        0.111 #> 363  6  10        0.090 #> 364  6   9        0.027 #> 365  6  12        0.340 #> 366  6  11        0.200 #> 367  6  11        0.212 #> 368  6  10        0.088 #> 369  6  13        0.430 #> 370  6  13        0.453 #> 371  6  14        0.253 #> 372  6  13        0.426 #> 373  6  14        0.242 #> 374  6  11        0.193 #> 375  6  11        0.186 #> 376  6  13        0.421 #> 377  6  13        0.417 #> 378  6  13        0.425 #> 379  6  15        0.086 #> 380  6  11        0.184 #> 381  6  13        0.441 #> 382  6  14        0.256 #> 383  6  13        0.421 #> 384  6  14        0.252 #> 385  6  13        0.436 #> 386  6  12        0.349 #> 387  6  14        0.252 #> 388  6  13        0.434 #> 389  6  11        0.222 #> 390  6  10        0.083 #> 391  6  15        0.122 #> 392  6  11        0.182 #> 393  6  12        0.362 #> 394  6  12        0.360 #> 395  6   9        0.025 #> 396  6  13        0.397 #> 397  6  12        0.360 #> 398  6  12        0.361 #> 399  6  12        0.358 #> 400  6  14        0.224 #> 401  6  12        0.365 #> 402  6  11        0.209 #> 403  6  12        0.364 #> 404  6  16        0.033 #> 405  6  16        0.043 #> 406  6  12        0.357 #> 407  6  10        0.070 #> 408  6  13        0.436 #> 409  6  11        0.193 #> 410  6  13        0.451 #> 411  6  14        0.254 #> 412  6  13        0.414 #> 413  6  11        0.203 #> 414  6  12        0.367 #> 415  6  14        0.272 #> 416  6   9        0.032 #> 417  6  12        0.355 #> 418  6  14        0.200 #> 419  6  13        0.422 #> 420  6  13        0.419 #> 421  6  13        0.414 #> 422  6  12        0.341 #> 423  6  12        0.375 #> 424  6  13        0.442 #> 425  6  14        0.233 #> 426  6  11        0.195 #> 427  6  12        0.353 #> 428  6  12        0.365 #> 429  6  14        0.245 #> 430  6  10        0.087 #> 431  6   9        0.039 #> 432  6   8        0.006 #> 433  6   9        0.032 #> 434  6  13        0.431 #> 435  6  14        0.252 #> 436  6  11        0.181 #> 437  6  12        0.368 #> 438  6  15        0.098 #> 439  6  15        0.085 #> 440  6  14        0.227 #> 441  6  15        0.061 #> 442  6  11        0.198 #> 443  6  12        0.354 #> 444  6  10        0.104 #> 445  6  11        0.195 #> 446  6  13        0.437 #> 447  6  10        0.096 #> 448  6  14        0.252 #> 449  6  13        0.448 #> 450  6   9        0.026 #> 451  6  12        0.343 #> 452  6  13        0.415 #> 453  6  12        0.371 #> 454  6  14        0.266 #> 455  6  10        0.080 #> 456  6  13        0.447 #> 457  6  13        0.424 #> 458  6  11        0.171 #> 459  6  13        0.428 #> 460  6  12        0.353 #> 461  6  13        0.431 #> 462  6  10        0.053 #> 463  6  10        0.073 #> 464  6  13        0.424 #> 465  6  11        0.202 #> 466  6  13        0.458 #> 467  6  11        0.210 #> 468  6  12        0.376 #> 469  6  13        0.447 #> 470  6  12        0.339 #> 471  6  12        0.352 #> 472  6  12        0.352 #> 473  6  12        0.366 #> 474  6  11        0.197 #> 475  6  12        0.364 #> 476  6  11        0.196 #> 477  6  14        0.263 #> 478  6  17        0.011 #> 479  6  13        0.420 #> 480  6  12        0.369 #> 481  6  13        0.422 #> 482  6  10        0.070 #> 483  6  12        0.352 #> 484  6  14        0.215 #> 485  6  14        0.259 #> 486  6  14        0.284 #> 487  6  13        0.438 #> 488  6  13        0.432 #> 489  6  13        0.418 #> 490  6  13        0.434 #> 491  6  13        0.427 #> 492  6  11        0.188 #> 493  6  13        0.431 #> 494  6  13        0.414 #> 495  6  10        0.084 #> 496  6  13        0.439 #> 497  6  12        0.368 #> 498  6  14        0.266 #> 499  6  16        0.037 #> 500  6  13        0.418 #> 501  6  13        0.429 #> 502  6  11        0.193 #> 503  6  12        0.348 #> 504  6  11        0.163 #> 505  6  12        0.366 #> 506  6  13        0.418 #> 507  6  10        0.087 #> 508  6  12        0.385 #> 509  6  13        0.439 #> 510  6  13        0.435 #> 511  6  13        0.457 #> 512  6  14        0.252 #> 513  6  15        0.121 #> 514  6  13        0.458 #> 515  6  12        0.359 #> 516  6  13        0.458 #> 517  6  11        0.198 #> 518  6  13        0.427 #> 519  6  11        0.205 #> 520  6   9        0.029 #> 521  6  11        0.188 #> 522  6  10        0.069 #> 523  6  12        0.355 #> 524  6  12        0.370 #> 525  6  12        0.353 #> 526  6  11        0.178 #> 527  6  13        0.425 #> 528  6  13        0.438 #> 529  6  12        0.382 #> 530  6  13        0.434 #> 531  6  11        0.200 #> 532  6  12        0.370 #> 533  6  10        0.073 #> 534  6   9        0.031 #> 535  6  16        0.042 #> 536  6  14        0.275 #> 537  6  14        0.259 #> 538  6  13        0.439 #> 539  6  14        0.250 #> 540  6  15        0.106 #> 541  6  10        0.099 #> 542  6  13        0.407 #> 543  6  10        0.053 #> 544  6  15        0.089 #> 545  6  15        0.088 #> 546  6  13        0.440 #> 547  6  11        0.186 #> 548  6  13        0.426 #> 549  6   9        0.034 #> 550  6  12        0.352 #> 551  6  12        0.374 #> 552  6  13        0.449 #> 553  6   9        0.015 #> 554  6  13        0.426 #> 555  6  12        0.358 #> 556  6   9        0.033 #> 557  6  12        0.359 #> 558  6  12        0.367 #> 559  6  13        0.453 #> 560  6  12        0.366 #> 561  6  12        0.358 #> 562  6   9        0.033 #> 563  6  10        0.069 #> 564  6  10        0.049 #> 565  6  11        0.174 #> 566  6  12        0.363 #> 567  6  11        0.181 #> 568  6  12        0.355 #> 569  6  12        0.361 #> 570  6  10        0.102 #> 571  6  13        0.432 #> 572  6  10        0.093 #> 573  6  12        0.357 #> 574  6  13        0.423 #> 575  6  12        0.365 #> 576  6  11        0.197 #> 577  6  12        0.371 #> 578  6  12        0.342 #> 579  6  10        0.087 #> 580  6  11        0.206 #> 581  6  12        0.348 #> 582  6  12        0.360 #> 583  6  12        0.376 #> 584  6  11        0.169 #> 585  6  14        0.227 #> 586  6  11        0.158 #> 587  6  15        0.067 #> 588  6  14        0.232 #> 589  6  15        0.122 #> 590  6  12        0.376 #> 591  6  12        0.366 #> 592  6  13        0.428 #> 593  6  11        0.182 #> 594  6  11        0.195 #> 595  6  14        0.261 #> 596  6  12        0.368 #> 597  6  12        0.351 #> 598  6  12        0.376 #> 599  6  13        0.429 #> 600  6  15        0.121 #> 601  6  12        0.356 #> 602  6  12        0.376 #> 603  6  12        0.360 #> 604  6  12        0.364 #> 605  6  11        0.178 #> 606  6  12        0.368 #> 607  6  18        0.001 #> 608  6  13        0.416 #> 609  6  10        0.070 #> 610  6  13        0.419 #> 611  6  11        0.196 #> 612  6  10        0.099 #> 613  6  10        0.102 #> 614  6   9        0.043 #> 615  6  10        0.081 #> 616  6  11        0.195 #> 617  6  14        0.241 #> 618  6  12        0.364 #> 619  6  12        0.363 #> 620  6  13        0.437 #> 621  6  13        0.455 #> 622  6  11        0.202 #> 623  6  13        0.437 #> 624  6  15        0.126 #> 625  6  11        0.183 #> 626  6  12        0.356 #> 627  6   9        0.019 #> 628  6  13        0.428 #> 629  6  10        0.061 #> 630  6  15        0.114 #> 631  6  10        0.072 #> 632  6  13        0.457 #> 633  6  10        0.077 #> 634  6  12        0.363 #> 635  6  13        0.417 #> 636  6  14        0.234 #> 637  6  11        0.203 #> 638  6  11        0.185 #> 639  6   9        0.028 #> 640  6  14        0.237 #> 641  6  13        0.435 #> 642  6  11        0.209 #> 643  6  10        0.099 #> 644  6  12        0.378 #> 645  6  10        0.079 #> 646  6  10        0.063 #> 647  6  11        0.176 #> 648  6  13        0.422 #> 649  6  13        0.421 #> 650  6  14        0.210 #> 651  6   9        0.025 #> 652  6  14        0.260 #> 653  6  11        0.193 #> 654  6  13        0.415 #> 655  6  13        0.444 #> 656  6  12        0.376 #> 657  6  12        0.354 #> 658  6  12        0.385 #> 659  6  15        0.114 #> 660  6  13        0.452 #> 661  6  10        0.082 #> 662  6  11        0.210 #> 663  6  11        0.204 #> 664  6  13        0.425 #> 665  6   9        0.028 #> 666  6   9        0.030 #> 667  6  11        0.174 #> 668  6   9        0.023 #> 669  6  12        0.376 #> 670  6  13        0.405 #> 671  6  15        0.096 #> 672  6  12        0.371 #> 673  6  11        0.200 #> 674  6  15        0.112 #> 675  6  12        0.378 #> 676  6  10        0.091 #> 677  6  11        0.200 #> 678  6  10        0.063 #> 679  6   9        0.025 #> 680  6  12        0.361 #> 681  6  12        0.353 #> 682  6  12        0.358 #> 683  6  10        0.084 #> 684  6  10        0.088 #> 685  6  13        0.435 #> 686  6   8        0.005 #> 687  6  14        0.248 #> 688  6  10        0.071 #> 689  6  11        0.172 #> 690  6  13        0.414 #> 691  6  12        0.369 #> 692  6   9        0.020 #> 693  6  11        0.182 #> 694  6  14        0.229 #> 695  6  12        0.365 #> 696  6  10        0.096 #> 697  6  10        0.097 #> 698  6  11        0.189 #> 699  6  13        0.428 #> 700  6  11        0.197 #> 701  6   8        0.003 #> 702  6  11        0.192 #> 703  6  12        0.358 #> 704  6  11        0.208 #> 705  6  10        0.086 #> 706  6  12        0.371 #> 707  6  13        0.448 #> 708  6   8        0.005 #> 709  6  14        0.230 #> 710  6  12        0.347 #> 711  6  10        0.072 #> 712  6  12        0.382 #> 713  6  12        0.362 #> 714  6  10        0.066 #> 715  6   9        0.034 #> 716  6  13        0.430 #> 717  6   9        0.026 #> 718  6  11        0.196 #> 719  6  12        0.346 #> 720  6  10        0.076 #> 721  6  12        0.370 #> 722  6  10        0.088 #> 723  6  12        0.362 #> 724  6  13        0.452 #> 725  6  12        0.365 #> 726  6  11        0.203 #> 727  6  15        0.117 #> 728  6  12        0.368 #> 729  6   9        0.024 #> 730  6   8        0.005 #> 731  6  10        0.055 #> 732  6  11        0.165 #> 733  6  11        0.144 #> 734  6  12        0.378 #> 735  6  10        0.091 #> 736  6   9        0.035 #> 737  6   9        0.027 #> 738  6  10        0.089 #> 739  6  12        0.362 #> 740  6  10        0.077 #> 741  6  12        0.354 #> 742  6   9        0.023 #> 743  6  15        0.098 #> 744  6  12        0.356 #> 745  6  14        0.253 #> 746  6   8        0.007 #> 747  6  10        0.080 #> 748  6  11        0.194 #> 749  6  14        0.244 #> 750  6  16        0.027 #> 751  6  13        0.426 #> 752  6  11        0.179 #> 753  6  12        0.369 #> 754  6  12        0.358 #> 755  6  10        0.070 #> 756  6  12        0.368 #> 757  6  12        0.350 #> 758  6  13        0.441 #> 759  6  10        0.097 #> 760  6  13        0.451 #> 761  6  11        0.190 #> 762  6   9        0.032 #> 763  6  13        0.430 #> 764  6  13        0.416 #> 765  6  14        0.272 #> 766  6  12        0.375 #> 767  6  13        0.446 #> 768  6  15        0.109 #> 769  6  12        0.357 #> 770  6  12        0.368 #> 771  6  11        0.196 #> 772  6  10        0.074 #> 773  6   9        0.020 #> 774  6  11        0.184 #> 775  6   9        0.015 #> 776  6  11        0.186 #> 777  6  12        0.370 #> 778  6  11        0.201 #> 779  6  12        0.364 #> 780  6  10        0.095 #> 781  6  11        0.218 #> 782  6  10        0.078 #> 783  6  11        0.199 #> 784  6  11        0.178 #> 785  6  12        0.359 #> 786  6  10        0.084 #> 787  6  12        0.373 #> 788  6  10        0.086 #> 789  6  11        0.203 #> 790  6  14        0.268 #> 791  6  14        0.268 #> 792  6  12        0.363 #> 793  6   8        0.006 #> 794  6  11        0.181 #> 795  6  12        0.369 #> 796  6  10        0.058 #> 797  6  13        0.425 #> 798  6  11        0.193 #> 799  6  16        0.045 #> 800  6  11        0.227 #> 801  6  13        0.430 #> 802  6  12        0.369 #> 803  6  10        0.087 #> 804  6  11        0.207 #> 805  6  13        0.423 #> 806  6  10        0.076 #> 807  6  14        0.277 #> 808  6  11        0.208 #> 809  6  12        0.351 #> 810  6   9        0.028 #> 811  6  12        0.359 #> 812  6  11        0.201 #> 813  6   9        0.015 #> 814  6  12        0.364 #> 815  6  12        0.361 #> 816  6  12        0.375 #> 817  6  11        0.172 #> 818  6  12        0.368 #> 819  6  12        0.353 #> 820  6  11        0.181 #> 821  6  12        0.372 #> 822  6  13        0.436 #> 823  6  15        0.114 #> 824  6  13        0.409 #> 825  6  15        0.121 #> 826  6  10        0.100 #> 827  6  12        0.374 #> 828  6  15        0.104 #> 829  6  11        0.210 #> 830  6  14        0.263 #> 831  6  14        0.248 #> 832  6  13        0.437 #> 833  6  14        0.253 #> 834  6  10        0.068 #> 835  6  13        0.402 #> 836  6  11        0.193 #> 837  6  12        0.373 #> 838  6  12        0.338 #> 839  6  13        0.431 #> 840  6  10        0.089 #> 841  6  12        0.368 #> 842  6  14        0.247 #> 843  6  14        0.228 #> 844  6  12        0.355 #> 845  6  12        0.376 #> 846  6  13        0.438 #> 847  6  11        0.193 #> 848  6  13        0.452 #> 849  6  14        0.232 #> 850  6  11        0.212 #> 851  6  11        0.198 #> 852  6  13        0.441 #> 853  6  10        0.105 #> 854  6  10        0.085 #> 855  6  13        0.430 #> 856  6  14        0.211 #> 857  6  10        0.065 #> 858  6   9        0.025 #> 859  6  13        0.403 #> 860  6  13        0.427 #> 861  6  14        0.245 #> 862  6  12        0.385 #> 863  6  12        0.379 #> 864  6  11        0.177 #> 865  6   9        0.029 #> 866  6  13        0.423 #> 867  6   8        0.015 #> 868  6  13        0.438 #> 869  6  10        0.096 #> 870  6  14        0.255 #> 871  6  11        0.202 #> 872  6  11        0.201 #> 873  6   7        0.002 #> 874  6  12        0.360 #> 875  6  12        0.377 #> 876  6   9        0.021 #> 877  6  10        0.056 plot(ljc, sf = FastFood.sf, sig = 0.05) #> Warning: bounding box has potentially an invalid value range for longlat data   # Case 3: With a sf object (poligons) library(lwgeom) fname <- system.file(\"shape/nc.shp\", package=\"sf\") nc <- sf::st_read(fname) #> Reading layer `nc' from data source  #>   `/home/runner/work/_temp/Library/sf/shape/nc.shp' using driver `ESRI Shapefile' #> Simple feature collection with 100 features and 14 fields #> Geometry type: MULTIPOLYGON #> Dimension:     XY #> Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965 #> Geodetic CRS:  NAD27 listw <- spdep::poly2nb(as(nc,\"Spatial\"), queen = FALSE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar p <- c(1/3,2/3) rho = 0.5 nc$fx <- dgp.spq(p = p, listw = listw, rho = rho) plot(nc[\"fx\"])  formula <- ~ fx ljc <- local.jc.test(formula = formula, data = nc, case = \"A\", listw = listw) ljc #>     nn ljc pseudo.value #> 1    3   4        0.043 #> 2    3   5        0.240 #> 3    5   8        0.233 #> 4    2   2        0.001 #> 5    4   7        0.442 #> 6    3   6        0.305 #> 7    3   5        0.267 #> 8    5   8        0.210 #> 9    4   8        0.185 #> 10   3   5        0.276 #> 11   4   4        0.001 #> 12   4   5        0.011 #> 13   5   7        0.041 #> 14   4   4        0.001 #> 15   3   5        0.281 #> 16   6  12        0.084 #> 17   3   5        0.281 #> 18   8  12        0.092 #> 19   4   7        0.427 #> 20   3   6        0.258 #> 21   2   4        0.423 #> 22   5   9        0.471 #> 23   5  10        0.133 #> 24   5   8        0.200 #> 25   6  10        0.367 #> 26   5   7        0.034 #> 27   6   7        0.002 #> 28   5   9        0.445 #> 29   5   6        0.003 #> 30   5   6        0.003 #> 31   5  10        0.118 #> 32   3   6        0.274 #> 33   5   9        0.443 #> 34   6  11        0.345 #> 35   4   8        0.169 #> 36   6  11        0.330 #> 37   6  10        0.344 #> 38   3   5        0.246 #> 39   9  15        0.380 #> 40   5   9        0.415 #> 41   4   8        0.174 #> 42   6  10        0.330 #> 43   6  12        0.072 #> 44   5  10        0.116 #> 45   2   4        0.430 #> 46   6  12        0.073 #> 47   6  10        0.337 #> 48   8  11        0.020 #> 49   6  11        0.354 #> 50   5  10        0.116 #> 51   7  12        0.415 #> 52   5   9        0.422 #> 53   6  11        0.318 #> 54   6  11        0.319 #> 55   5   9        0.474 #> 56   2   3        0.116 #> 57   6   9        0.103 #> 58   4   4        0.001 #> 59   4   6        0.129 #> 60   3   6        0.305 #> 61   6  12        0.082 #> 62   6  11        0.344 #> 63   7  13        0.255 #> 64   4   7        0.443 #> 65   5   9        0.475 #> 66   4   6        0.111 #> 67   8  14        0.465 #> 68   5   9        0.437 #> 69   5   9        0.428 #> 70   6  10        0.344 #> 71   5  10        0.106 #> 72   4   8        0.195 #> 73   3   5        0.268 #> 74   6   9        0.089 #> 75   3   4        0.037 #> 76   3   4        0.049 #> 77   2   4        0.420 #> 78   5   7        0.047 #> 79   7  14        0.050 #> 80   2   3        0.112 #> 81   3   3        0.001 #> 82   6  12        0.099 #> 83   5   6        0.003 #> 84   4   7        0.421 #> 85   4   7        0.452 #> 86   4   8        0.183 #> 87   4   7        0.441 #> 88   6   9        0.117 #> 89   4   8        0.186 #> 90   2   3        0.122 #> 91   6   7        0.002 #> 92   3   5        0.282 #> 93   4   6        0.116 #> 94   5   9        0.466 #> 95   3   3        0.001 #> 96   5   9        0.446 #> 97   7  12        0.466 #> 98   4   8        0.183 #> 99   2   4        0.430 #> 100  3   5        0.264 plot(ljc, sf = nc)   # Case 4: With isolated areas library(lwgeom) data(provinces_spain) sf::sf_use_s2(FALSE) listw <- spdep::poly2nb(as(provinces_spain,\"Spatial\"), queen = FALSE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") formula <- ~ Male2Female ljc <- local.jc.test(formula = formula, data = provinces_spain, listw = listw) #> The index of observations in SetNeighbor() function should start from 1. #> The index of observations in SetNeighbor() function should start from 1. #> The index of observations in SetNeighbor() function should start from 1. print(ljc) #>    nn ljc pseudo.value #> 1   5   6        0.209 #> 2   7   9        0.390 #> 3   3   4        0.398 #> 4   2   3        0.447 #> 5   6   8        0.465 #> 6   6   7        0.133 #> 7   0   0           NA #> 8   3   4        0.404 #> 9   8  10        0.377 #> 10  4   6        0.289 #> 11  3   3        0.001 #> 12  3   4        0.377 #> 13  6   8        0.496 #> 14  6   6        0.001 #> 15  2   2        0.001 #> 16  7  10        0.222 #> 17  2   3        0.466 #> 18  6   8        0.483 #> 19  6  10        0.021 #> 20  3   3        0.001 #> 21  3   4        0.406 #> 22  4   4        0.001 #> 23  7   7        0.001 #> 24  5   6        0.226 #> 25  5   7        0.400 #> 26  5   5        0.001 #> 27  5  10        0.001 #> 28  4   4        0.001 #> 29  4   5        0.318 #> 30  5   6        0.190 #> 31  4   4        0.001 #> 32  3   3        0.001 #> 33  4   5        0.279 #> 34  0   0           NA #> 35  3   3        0.001 #> 36  4   5        0.282 #> 37  0   0           NA #> 38  5   6        0.176 #> 39  6  10        0.025 #> 40  5   5        0.001 #> 41  5   8        0.082 #> 42  6   8        0.460 #> 43  6   8        0.459 #> 44  5   7        0.420 #> 45  7  10        0.298 #> 46  4   5        0.266 #> 47  4   4        0.001 #> 48  8  13        0.024 #> 49  5   7        0.418 #> 50  3   3        0.001 plot(ljc, sf = provinces_spain, sig = 0.1)   # Case 5: Regular lattice data(Boots.sf) listw <- spdep::poly2nb(as(Boots.sf,\"Spatial\"), queen = TRUE) formula <- ~ BW ljc <- local.jc.test(formula = formula, data = Boots.sf, case=\"B\", listw = listw) print(ljc) #>     nn ljc pseudo.value #> 1    3   6        0.423 #> 2    5  10        0.196 #> 3    5   9        0.394 #> 4    5   9        0.421 #> 5    5   7        0.019 #> 6    5   8        0.096 #> 7    5   8        0.117 #> 8    5   7        0.022 #> 9    5   9        0.388 #> 10   5   8        0.108 #> 11   5   9        0.385 #> 12   5  10        0.225 #> 13   5   8        0.122 #> 14   5  10        0.218 #> 15   5   9        0.397 #> 16   3   6        0.391 #> 17   5  10        0.200 #> 18   8  16        0.086 #> 19   8  15        0.331 #> 20   8  16        0.079 #> 21   8  12        0.030 #> 22   8  13        0.130 #> 23   8  12        0.029 #> 24   8  12        0.023 #> 25   8  14        0.369 #> 26   8  13        0.123 #> 27   8  15        0.345 #> 28   8  15        0.320 #> 29   8  14        0.347 #> 30   8  15        0.325 #> 31   8  15        0.353 #> 32   5  10        0.210 #> 33   5  10        0.208 #> 34   8  15        0.339 #> 35   8  14        0.357 #> 36   8  13        0.129 #> 37   8  12        0.032 #> 38   8  14        0.337 #> 39   8  14        0.330 #> 40   8  13        0.146 #> 41   8  13        0.135 #> 42   8  12        0.030 #> 43   8  14        0.334 #> 44   8  14        0.351 #> 45   8  14        0.335 #> 46   8  15        0.328 #> 47   8  16        0.091 #> 48   5  10        0.242 #> 49   5  10        0.211 #> 50   8  14        0.353 #> 51   8  15        0.350 #> 52   8  13        0.145 #> 53   8  15        0.351 #> 54   8  14        0.373 #> 55   8  15        0.335 #> 56   8  14        0.362 #> 57   8  14        0.366 #> 58   8  13        0.118 #> 59   8  13        0.131 #> 60   8  14        0.340 #> 61   8  15        0.328 #> 62   8  15        0.319 #> 63   8  16        0.074 #> 64   5  10        0.215 #> 65   5   9        0.392 #> 66   8  13        0.129 #> 67   8  13        0.129 #> 68   8  11        0.008 #> 69   8  13        0.112 #> 70   8  14        0.373 #> 71   8  16        0.084 #> 72   8  15        0.347 #> 73   8  14        0.369 #> 74   8  13        0.133 #> 75   8  13        0.120 #> 76   8  12        0.035 #> 77   8  13        0.135 #> 78   8  15        0.305 #> 79   8  16        0.084 #> 80   5  10        0.210 #> 81   5   9        0.387 #> 82   8  15        0.353 #> 83   8  12        0.032 #> 84   8  12        0.033 #> 85   8  13        0.132 #> 86   8  13        0.116 #> 87   8  15        0.341 #> 88   8  15        0.329 #> 89   8  15        0.329 #> 90   8  14        0.334 #> 91   8  12        0.034 #> 92   8  14        0.330 #> 93   8  14        0.332 #> 94   8  15        0.318 #> 95   8  14        0.368 #> 96   5   8        0.123 #> 97   5   8        0.129 #> 98   8  14        0.361 #> 99   8  11        0.003 #> 100  8  12        0.021 #> 101  8  12        0.028 #> 102  8  13        0.134 #> 103  8  16        0.084 #> 104  8  15        0.321 #> 105  8  15        0.320 #> 106  8  16        0.081 #> 107  8  13        0.119 #> 108  8  15        0.346 #> 109  8  14        0.356 #> 110  8  15        0.322 #> 111  8  15        0.350 #> 112  5   9        0.389 #> 113  5   9        0.394 #> 114  8  15        0.339 #> 115  8  12        0.026 #> 116  8  12        0.034 #> 117  8  11        0.006 #> 118  8  11        0.005 #> 119  8  13        0.123 #> 120  8  14        0.354 #> 121  8  15        0.305 #> 122  8  15        0.351 #> 123  8  13        0.126 #> 124  8  14        0.344 #> 125  8  13        0.130 #> 126  8  14        0.336 #> 127  8  13        0.134 #> 128  5   8        0.107 #> 129  5   8        0.123 #> 130  8  12        0.038 #> 131  8  12        0.039 #> 132  8  11        0.001 #> 133  8  12        0.025 #> 134  8  11        0.005 #> 135  8  13        0.126 #> 136  8  13        0.122 #> 137  8  14        0.374 #> 138  8  13        0.133 #> 139  8  13        0.147 #> 140  8  15        0.352 #> 141  8  14        0.357 #> 142  8  16        0.077 #> 143  8  15        0.325 #> 144  5  10        0.205 #> 145  5   8        0.104 #> 146  8  13        0.142 #> 147  8  13        0.112 #> 148  8  10        0.002 #> 149  8  10        0.001 #> 150  8   8        0.001 #> 151  8  11        0.003 #> 152  8  12        0.024 #> 153  8  14        0.349 #> 154  8  13        0.135 #> 155  8  13        0.104 #> 156  8  14        0.348 #> 157  8  14        0.341 #> 158  8  15        0.340 #> 159  8  15        0.349 #> 160  5  10        0.224 #> 161  5   9        0.403 #> 162  8  13        0.129 #> 163  8  13        0.139 #> 164  8  13        0.135 #> 165  8  11        0.006 #> 166  8  10        0.002 #> 167  8  11        0.004 #> 168  8  12        0.034 #> 169  8  12        0.032 #> 170  8  13        0.124 #> 171  8  13        0.129 #> 172  8  15        0.356 #> 173  8  15        0.349 #> 174  8  15        0.332 #> 175  8  15        0.340 #> 176  5  10        0.224 #> 177  5   7        0.014 #> 178  8  13        0.141 #> 179  8  14        0.341 #> 180  8  14        0.347 #> 181  8  12        0.041 #> 182  8  13        0.123 #> 183  8  11        0.009 #> 184  8  13        0.122 #> 185  8  11        0.009 #> 186  8  12        0.025 #> 187  8  13        0.118 #> 188  8  15        0.343 #> 189  8  15        0.351 #> 190  8  16        0.064 #> 191  8  15        0.310 #> 192  5  10        0.212 #> 193  5   9        0.386 #> 194  8  14        0.337 #> 195  8  14        0.348 #> 196  8  15        0.336 #> 197  8  14        0.360 #> 198  8  14        0.335 #> 199  8  11        0.004 #> 200  8  13        0.113 #> 201  8  12        0.030 #> 202  8  14        0.365 #> 203  8  15        0.348 #> 204  8  15        0.320 #> 205  8  15        0.352 #> 206  8  15        0.323 #> 207  8  15        0.311 #> 208  5  10        0.220 #> 209  5   8        0.103 #> 210  8  13        0.123 #> 211  8  15        0.353 #> 212  8  15        0.340 #> 213  8  15        0.342 #> 214  8  15        0.363 #> 215  8  12        0.034 #> 216  8  13        0.116 #> 217  8  11        0.002 #> 218  8  12        0.035 #> 219  8  13        0.137 #> 220  8  15        0.346 #> 221  8  16        0.096 #> 222  8  16        0.076 #> 223  8  16        0.089 #> 224  5  10        0.220 #> 225  5  10        0.199 #> 226  8  15        0.341 #> 227  8  15        0.327 #> 228  8  14        0.371 #> 229  8  14        0.357 #> 230  8  13        0.138 #> 231  8  14        0.340 #> 232  8  14        0.352 #> 233  8  14        0.356 #> 234  8  16        0.079 #> 235  8  15        0.340 #> 236  8  16        0.085 #> 237  8  16        0.088 #> 238  8  16        0.082 #> 239  8  16        0.079 #> 240  5  10        0.219 #> 241  3   6        0.403 #> 242  5  10        0.208 #> 243  5  10        0.234 #> 244  5   9        0.394 #> 245  5  10        0.207 #> 246  5   8        0.116 #> 247  5   9        0.388 #> 248  5   9        0.398 #> 249  5   9        0.391 #> 250  5   9        0.407 #> 251  5   9        0.374 #> 252  5  10        0.206 #> 253  5  10        0.210 #> 254  5  10        0.205 #> 255  5  10        0.216 #> 256  3   6        0.412 plot(ljc, sf = Boots.sf, sig = 0.05)  lsr <- local.sp.runs.test(formula = formula, data = Boots.sf, distr = \"bootstrap\", nsim= 99, listw = listw) #> Warning: st_centroid assumes attributes are constant over geometries of x print(lsr) #>     SRQ     EP.i     SdP.i zseudo.value pseudo.value #> 1     1 2.070707 0.9715601 -1.102049207  0.270440280 #> 2     1 2.676768 1.2843507 -1.305537218  0.191709982 #> 3     2 2.707071 1.1715377 -0.603540735  0.546149025 #> 4     3 2.727273 1.2763003  0.213685815  0.830792074 #> 5     2 2.959596 1.2282324 -0.781282048  0.434636626 #> 6     4 2.787879 1.2394265  0.977969399  0.328089459 #> 7     4 2.979798 1.2615167  0.808710657  0.418681597 #> 8     6 2.797980 1.2204031  2.623739897  0.008697017 #> 9     4 2.909091 1.2296582  0.887164467  0.374990360 #> 10    5 2.949495 1.3429615  1.526853160  0.126797529 #> 11    3 2.959596 1.3546533  0.029826112  0.976205734 #> 12    2 2.686869 1.1662469 -0.588956474  0.555890472 #> 13    5 3.000000 1.2205720  1.638576061  0.101301581 #> 14    2 3.050505 1.3429615 -0.782230191  0.434079305 #> 15    3 3.101010 1.2330065 -0.081921789  0.934708907 #> 16    1 2.141414 0.9584224 -1.190930164  0.233681002 #> 17    1 2.909091 1.2784789 -1.493251769  0.135371295 #> 18    1 3.858586 1.6963953 -1.685094143  0.091970409 #> 19    3 3.565657 1.5854029 -0.356790418  0.721248710 #> 20    2 3.808081 1.6392928 -1.102963899  0.270042843 #> 21    6 3.949495 1.7459793  1.174415460  0.240228656 #> 22    7 4.060606 1.6525687  1.778681844  0.075291937 #> 23    5 4.202020 1.7260300  0.462320933  0.643851191 #> 24    6 3.909091 1.6168179  1.293224837  0.195933308 #> 25    6 4.171717 1.5455030  1.182969409  0.236821271 #> 26    5 3.989899 1.6751177  0.603003000  0.546506694 #> 27    2 4.232323 1.6526311 -1.350769253  0.176769360 #> 28    3 4.090909 1.5259049 -0.714925982  0.474654781 #> 29    4 3.909091 1.5720188  0.057829520  0.953884424 #> 30    3 3.868687 1.5691312 -0.553610090  0.579845719 #> 31    3 4.080808 1.5231330 -0.709595357  0.477955100 #> 32    1 2.838384 1.2347607 -1.488858345  0.136524675 #> 33    1 2.919192 1.2178667 -1.575863674  0.115057224 #> 34    3 3.858586 1.5908546 -0.539701022  0.589403235 #> 35    4 4.000000 1.7554580  0.000000000  1.000000000 #> 36    5 3.929293 1.4931990  0.717055826  0.473339651 #> 37    6 3.969697 1.6064573  1.263838789  0.206287896 #> 38    6 3.979798 1.6097902  1.254947406  0.209497853 #> 39    5 4.161616 1.5953189  0.525527442  0.599216582 #> 40    4 3.989899 1.2575888  0.008032045  0.993591424 #> 41    8 4.070707 1.5534854  2.529340132  0.011427722 #> 42    5 3.989899 1.6319198  0.618964860  0.535939509 #> 43    3 4.171717 1.4641317 -0.800281252  0.423547863 #> 44    5 3.959596 1.6408011  0.634082955  0.526026686 #> 45    5 3.878788 1.6798489  0.667448190  0.504485893 #> 46    3 3.878788 1.5989329 -0.549608995  0.582587588 #> 47    1 3.909091 1.6604088 -1.752032956  0.079768141 #> 48    1 2.848485 1.2565229 -1.471111186  0.141261050 #> 49    1 2.898990 1.3362676 -1.421114931  0.155283350 #> 50    5 4.030303 1.5013908  0.645865791  0.518366276 #> 51    4 4.010101 1.6319198 -0.006189649  0.995061406 #> 52    7 3.929293 1.5988039  1.920627681  0.054778663 #> 53    3 4.030303 1.6000928 -0.643902063  0.519638944 #> 54    5 4.232323 1.5960940  0.480972161  0.630536285 #> 55    3 3.929293 1.4725552 -0.631075097  0.527991423 #> 56    4 4.212121 1.6491973 -0.128620886  0.897657639 #> 57    4 3.848485 1.4594075  0.103819636  0.917312483 #> 58    6 4.111111 1.7431434  1.083610757  0.278537419 #> 59    3 4.333333 1.7320508 -0.769800359  0.441418327 #> 60    6 4.191919 1.5096747  1.197662520  0.231048426 #> 61    2 4.171717 1.7556928 -1.236957380  0.216102906 #> 62    3 3.979798 1.7436754 -0.561915341  0.574173701 #> 63    1 3.919192 1.6205112 -1.801401901  0.071639557 #> 64    1 2.858586 1.2122681 -1.533147568  0.125239500 #> 65    3 3.040404 1.2447374 -0.032459890  0.974105302 #> 66    4 3.959596 1.4632867  0.027611841  0.977971737 #> 67    6 4.212121 1.5861179  1.127204229  0.259656143 #> 68    6 4.272727 1.7309793  0.997858670  0.318347896 #> 69    7 4.090909 1.6231169  1.792286789  0.073087038 #> 70    3 4.414141 1.4846844 -0.952486206  0.340850458 #> 71    1 4.131313 1.5296156 -2.047124263  0.040645885 #> 72    2 4.252525 1.5736571 -1.431395235  0.152316973 #> 73    4 4.050505 1.5277951 -0.033057476  0.973628753 #> 74    3 4.050505 1.6374055 -0.641566837  0.521154471 #> 75    5 4.050505 1.6059439  0.591237925  0.554361015 #> 76    6 4.080808 1.7535781  1.094443380  0.273760567 #> 77    3 4.181818 1.6435628 -0.719058728  0.472104735 #> 78    3 4.090909 1.4783534 -0.737921728  0.460562015 #> 79    1 4.171717 1.6101743 -1.969797402  0.048861594 #> 80    1 2.878788 1.2476323 -1.505882727  0.132097281 #> 81    3 2.777778 1.2580805  0.176635938  0.859794363 #> 82    3 4.191919 1.7183094 -0.693658087  0.487896656 #> 83    7 4.080808 1.4685601  1.987791951  0.046834704 #> 84    8 4.242424 1.8410895  2.040952297  0.041255569 #> 85    4 4.050505 1.5738536 -0.032090057  0.974400233 #> 86    5 4.373737 1.5358695  0.407757712  0.683451563 #> 87    3 4.282828 1.4288600 -0.897798443  0.369293015 #> 88    3 4.070707 1.5000172 -0.713796539  0.475353000 #> 89    3 4.141414 1.5584536 -0.732401756  0.463923387 #> 90    4 4.040404 1.4977479 -0.026976529  0.978478454 #> 91    5 4.353535 1.4379203  0.449583072  0.653011097 #> 92    6 4.141414 1.4777955  1.257674575  0.208509471 #> 93    5 4.363636 1.6316671  0.390008244  0.696530451 #> 94    3 3.929293 1.4725552 -0.631075097  0.527991423 #> 95    5 4.070707 1.4725552  0.631075097  0.527991423 #> 96    4 2.909091 1.2379287  0.881237399  0.378189341 #> 97    2 2.909091 1.1960045 -0.760106609  0.447190863 #> 98    5 4.000000 1.5518258  0.644402233  0.519314637 #> 99    4 4.272727 1.7012491 -0.160310014  0.872636871 #> 100   5 4.171717 1.5846226  0.522700389  0.601182767 #> 101   4 3.919192 1.4823917  0.054511964  0.956527277 #> 102   7 4.060606 1.4833648  1.981571888  0.047527176 #> 103   2 3.939394 1.5374122 -1.261466445  0.207140842 #> 104   3 4.141414 1.6721616 -0.682597975  0.494860914 #> 105   3 3.767677 1.5832560 -0.484872159  0.627767033 #> 106   2 3.979798 1.4706641 -1.346193140  0.178240237 #> 107   6 4.363636 1.5678827  1.043677362  0.296634687 #> 108   4 4.030303 1.4030182 -0.021598458  0.982768263 #> 109   5 4.202020 1.5712974  0.507847723  0.611560139 #> 110   3 4.101010 1.4742341 -0.746835300  0.455162984 #> 111   4 4.101010 1.5485012 -0.065230881  0.947990174 #> 112   2 2.959596 1.2198962 -0.786620983  0.431503772 #> 113   3 2.919192 1.1665120  0.069273250  0.944772118 #> 114   4 4.121212 1.6919541 -0.071640312  0.942888158 #> 115   4 4.181818 1.6620840 -0.109391693  0.912891822 #> 116   5 4.141414 1.4569335  0.589310273  0.555653155 #> 117   7 4.141414 1.4708744  1.943460225  0.051960577 #> 118   4 3.979798 1.6535663  0.012217242  0.990252294 #> 119   7 4.181818 1.8259112  1.543438583  0.122724398 #> 120   3 4.050505 1.6311617 -0.644022628  0.519560761 #> 121   2 3.919192 1.6142021 -1.188941556  0.234462666 #> 122   3 4.111111 1.5510950 -0.716339820  0.473781545 #> 123   4 4.151515 1.5410283 -0.098320813  0.921677552 #> 124   5 4.212121 1.5989329  0.492752892  0.622187200 #> 125   3 4.212121 1.4587717 -0.830919068  0.406019351 #> 126   4 4.151515 1.4733250 -0.102838922  0.918090814 #> 127   6 4.050505 1.6311617  1.195157378  0.232025548 #> 128   3 2.818182 1.1460993  0.158640863  0.873951832 #> 129   2 2.989899 1.3286094 -0.745063943  0.456233065 #> 130   5 4.121212 1.5666989  0.560916891  0.574854194 #> 131   7 4.181818 1.5476357  1.820959430  0.068613024 #> 132   7 4.131313 1.6515081  1.737010517  0.082385314 #> 133   8 4.101010 1.5016654  2.596443857  0.009419430 #> 134   4 4.212121 1.6429983 -0.129106167  0.897273643 #> 135   4 3.929293 1.7452707  0.040513526  0.967683724 #> 136   5 4.111111 1.9160381  0.463920269  0.642704870 #> 137   5 3.616162 1.5889097  0.870935817  0.383789199 #> 138   5 3.858586 1.7143458  0.665801565  0.505537945 #> 139   5 4.010101 1.7231612  0.574466836  0.565651936 #> 140   4 3.939394 1.7191489  0.035253525  0.971877582 #> 141   5 4.151515 1.4733250  0.575897964  0.564684152 #> 142   2 4.222222 1.4537464 -1.528617492  0.126359297 #> 143   3 4.131313 1.6821176 -0.672552929  0.501231757 #> 144   1 2.949495 1.1725930 -1.662550457  0.096402455 #> 145   3 2.949495 1.2320030  0.040994260  0.967300472 #> 146   7 4.111111 1.5771900  1.831668259  0.067000860 #> 147   6 4.050505 1.4024304  1.390083229  0.164503605 #> 148   4 4.050505 1.6804624 -0.030054258  0.976023781 #> 149   5 3.767677 1.6024744  0.769012751  0.441885741 #> 150   1 4.121212 1.6053020 -1.944314632  0.051857521 #> 151   4 3.898990 1.5352654  0.065793251  0.947542429 #> 152   5 4.131313 1.4044133  0.618540742  0.536218950 #> 153   6 3.858586 1.3477881  1.588835956  0.112097433 #> 154   2 3.969697 1.5283347 -1.288786370  0.197472366 #> 155   7 4.141414 1.6660481  1.715788289  0.086200798 #> 156   3 4.080808 1.7123606 -0.631180174  0.527922724 #> 157   4 4.262626 1.5225238 -0.172494027  0.863049157 #> 158   3 3.898990 1.4321024 -0.627741346  0.530173396 #> 159   3 4.181818 1.6559333 -0.713687077  0.475420699 #> 160   1 2.818182 1.2068143 -1.506596190  0.131914195 #> 161   3 3.050505 1.2320030 -0.040994260  0.967300472 #> 162   6 3.949495 1.4454273  1.418615184  0.156011237 #> 163   3 4.020202 1.4913341 -0.684086815  0.493920347 #> 164   7 3.909091 1.5524234  1.991021909  0.046478479 #> 165   5 4.070707 1.5336533  0.605934175  0.544558464 #> 166   3 4.202020 1.6535663 -0.726925908  0.467271345 #> 167   4 4.030303 1.6870125 -0.017962541  0.985668737 #> 168   6 4.141414 1.5714942  1.182687091  0.236933182 #> 169   6 4.111111 1.4769583  1.278904662  0.200930631 #> 170   5 4.292929 1.4374902  0.491878629  0.622805147 #> 171   5 4.191919 1.5364734  0.525932199  0.598935316 #> 172   3 3.828283 1.6164991 -0.512392990  0.608375996 #> 173   3 4.080808 1.6205112 -0.666955029  0.504800859 #> 174   3 4.181818 1.6185382 -0.730176248  0.465282459 #> 175   3 4.171717 1.6600984 -0.705811890  0.480305127 #> 176   1 2.949495 1.2153251 -1.604093409  0.108693465 #> 177   5 2.727273 1.2190510  1.864341419  0.062273774 #> 178   5 3.868687 1.5949312  0.709317844  0.478127257 #> 179   4 4.050505 1.6436255 -0.030727833  0.975486594 #> 180   4 4.000000 1.4568627  0.000000000  1.000000000 #> 181   4 4.141414 1.5649875 -0.090361198  0.928000190 #> 182   5 3.989899 1.7466875  0.578295197  0.563064837 #> 183   7 4.000000 1.6475089  1.820930936  0.068617356 #> 184   8 4.202020 1.6535663  2.296841524  0.021627812 #> 185   4 4.181818 1.7691439 -0.102771845  0.918144052 #> 186   7 4.343434 1.5330483  1.732864953  0.083119675 #> 187   5 4.272727 1.5571965  0.467039799  0.640471404 #> 188   3 4.232323 1.5638015 -0.788030466  0.430678885 #> 189   3 4.272727 1.6831590 -0.756153932  0.449556910 #> 190   2 4.030303 1.5613609 -1.300341918  0.193483807 #> 191   3 4.323232 1.5638015 -0.846163861  0.397461339 #> 192   1 3.090909 1.2129481 -1.723824067  0.084739608 #> 193   4 2.818182 1.1897833  0.993305364  0.320561164 #> 194   4 4.060606 1.6831590 -0.036007330  0.971276514 #> 195   3 3.898990 1.4462827 -0.621586565  0.534213757 #> 196   3 3.868687 1.5885205 -0.546852806  0.584479861 #> 197   2 4.181818 1.7045176 -1.280020898  0.200537786 #> 198   5 4.070707 1.7742634  0.523762658  0.600443629 #> 199   4 4.101010 1.5746392 -0.064148090  0.948852310 #> 200   4 4.141414 1.6288853 -0.086816512  0.930817363 #> 201   6 4.030303 1.6626420  1.184678932  0.236144415 #> 202   4 4.181818 1.3729429 -0.132429530  0.894644558 #> 203   2 4.454545 1.5204237 -1.614382497  0.106444486 #> 204   3 4.131313 1.4260439 -0.793322772  0.427589793 #> 205   2 4.141414 1.5051619 -1.422713516  0.154819221 #> 206   3 4.353535 1.5991907 -0.846387718  0.397336488 #> 207   3 4.141414 1.5649875 -0.729343956  0.465791291 #> 208   1 3.010101 1.2079241 -1.664095476  0.096093351 #> 209   4 2.969697 1.2813780  0.804058643  0.421363108 #> 210   3 4.020202 1.4844761 -0.687247176  0.491926980 #> 211   4 4.030303 1.5548118 -0.019489838  0.984450343 #> 212   3 3.858586 1.3924732 -0.616590574  0.537504813 #> 213   3 4.121212 1.5271203 -0.734200250  0.462826701 #> 214   4 3.979798 1.5184565  0.013304313  0.989385007 #> 215   4 3.888889 1.5576597  0.071332081  0.943133463 #> 216   5 4.060606 1.6525687  0.568444713  0.569733037 #> 217   6 4.000000 1.5185923  1.317009216  0.187835535 #> 218   6 4.222222 1.4537464  1.222893993  0.221369738 #> 219   5 4.252525 1.4522568  0.514698758  0.606763542 #> 220   3 4.222222 1.5290090 -0.799355813  0.424084124 #> 221   1 4.333333 1.5907898 -2.095395190  0.036135877 #> 222   1 4.363636 1.5081719 -2.230273820  0.025729270 #> 223   1 4.181818 1.4733250 -2.159617365  0.030802303 #> 224   1 2.898990 1.1994467 -1.583221551  0.113370976 #> 225   1 2.868687 1.2342598 -1.514014212  0.130022235 #> 226   2 3.909091 1.5524234 -1.229748826  0.218791177 #> 227   3 3.838384 1.8990173 -0.441482989  0.658863374 #> 228   5 4.171717 1.5388865  0.538235181  0.590414694 #> 229   4 4.262626 1.3966860 -0.188035293  0.850848985 #> 230   5 4.494949 1.5277951  0.330574762  0.740965713 #> 231   5 3.989899 1.6130523  0.626204746  0.531180655 #> 232   5 4.040404 1.4422148  0.665362722  0.505818522 #> 233   5 3.888889 1.4769583  0.752296860  0.451872556 #> 234   2 4.222222 1.3743685 -1.616904167  0.105898969 #> 235   3 4.010101 1.4321024 -0.705327354  0.480606541 #> 236   1 4.252525 1.5671594 -2.075427259  0.037946954 #> 237   1 4.070707 1.5988039 -1.920627681  0.054778663 #> 238   1 4.242424 1.5784965 -2.054121906  0.039963894 #> 239   1 4.191919 1.4754921 -2.163291302  0.030518782 #> 240   1 2.989899 1.3053653 -1.524400099  0.127408795 #> 241   1 2.222222 0.9954545 -1.227803175  0.219520864 #> 242   1 2.787879 1.1717136 -1.525866697  0.127043066 #> 243   1 2.707071 1.2392602 -1.377491764  0.168360259 #> 244   3 2.909091 1.2296582  0.073930372  0.941065788 #> 245   2 3.050505 1.1898700 -0.882873820  0.377304450 #> 246   4 3.070707 1.1180570  0.831167731  0.405878882 #> 247   3 2.828283 1.2700667  0.135203269  0.892451163 #> 248   3 2.757576 1.1701291  0.207177338  0.835871365 #> 249   2 3.010101 1.2494484 -0.808437526  0.418838757 #> 250   3 3.101010 1.1202674 -0.090166066  0.928155250 #> 251   3 3.020202 1.1778552 -0.017151532  0.986315729 #> 252   1 3.111111 1.1770673 -1.793534690  0.072887469 #> 253   1 2.868687 1.2092034 -1.545386774  0.122252737 #> 254   1 3.282828 1.3173908 -1.732840649  0.083123996 #> 255   1 2.808081 1.2094590 -1.494950010  0.134927489 #> 256   1 2.222222 0.9954545 -1.227803175  0.219520864 plot(lsr, sf = Boots.sf, sig = 0.1)  scan <- scan.test(formula = formula, data = Boots.sf, nsim = 299, dist = \"bernoulli\", nv = 60 , case = \"B\", windows = \"elliptic\") plot(scan, sf = Boots.sf)  # }"},{"path":"https://f8l5h9.github.io/spqdep/reference/local.sp.runs.test.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to calculate the local spatial runs tests. — local.sp.runs.test","title":"A function to calculate the local spatial runs tests. — local.sp.runs.test","text":"function calculates local spatial runs tests localizations.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/local.sp.runs.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to calculate the local spatial runs tests. — local.sp.runs.test","text":"","code":"local.sp.runs.test(formula = NULL, data = NULL, fx = NULL, distr = \"asymptotic\", listw = listw, alternative = \"two.sided\" , nsim = NULL, control = list())"},{"path":"https://f8l5h9.github.io/spqdep/reference/local.sp.runs.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to calculate the local spatial runs tests. — local.sp.runs.test","text":"formula (optional) formula factor included data data (optional) data frame sf object containing variable testing . fx (optional) factor observations length neighbors list listw distr character string specifying distribution \"asymptotic\" (default) \"bootstrap\" listw neighbourhood list (object type knn nb) W matrix indicates order elements  $m_i-environment$ (example inverse distance). calculate number runs $m_i-environment$, order must established, example nearest neighbour furthest one. alternative character string specifying alternative hypothesis, must one \"two.sided\" (default), \"greater\" \"less\". nsim Default value NULL obtain asymptotic version local test. bootstrap version nsim number permutations obtain pseudo-value. control Optional argument. See Control Argument section.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/local.sp.runs.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to calculate the local spatial runs tests. — local.sp.runs.test","text":"output object class localsrq local.SRQ matrix MeanNeig Mean run.MaxNeig Maximum run. listw object listwalternative character string describing alternative hypothesis","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/local.sp.runs.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"A function to calculate the local spatial runs tests. — local.sp.runs.test","text":"object listw can class: knn: Objects class knn consider neighbours     order proximity. nb: neighbours obtained sf object, code internally     call function nb2nb_order order order     proximity centroids. matrix: object matrix class based inverse     distance introduced argument, function nb2nb_order     also called internally transform object class matrix matrix      class nb ordered neighbours.","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/local.sp.runs.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"A function to calculate the local spatial runs tests. — local.sp.runs.test","text":"@references Ruiz, M., López, F., Páez, . (2021).     test global local homogeneity categorical data based spatial runs.       Working paper.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/local.sp.runs.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A function to calculate the local spatial runs tests. — local.sp.runs.test","text":"","code":"# Case 1: Local spatial runs test based on knn library(lwgeom) N <- 100 cx <- runif(N) cy <- runif(N) x <- cbind(cx,cy) listw <- spdep::knearneigh(cbind(cx,cy), k = 10) p <- c(1/6,3/6,2/6) rho <- 0.5 fx <- dgp.spq(p = p, listw = listw, rho = rho)  # Asymtotic version lsrq <- local.sp.runs.test(fx = fx, listw = listw, alternative = \"less\") print(lsrq) #>     runs.i      E.i   Std.i    z.value     p.value #> 1        6 7.183838 1.59988 -0.7399544 0.229663845 #> 2        8 7.183838 1.59988  0.5101392 0.695023022 #> 3        4 7.183838 1.59988 -1.9900479 0.023292830 #> 4        8 7.183838 1.59988  0.5101392 0.695023022 #> 5        5 7.183838 1.59988 -1.3650011 0.086126348 #> 6        9 7.183838 1.59988  1.1351860 0.871851293 #> 7        7 7.183838 1.59988 -0.1149076 0.454259185 #> 8        7 7.183838 1.59988 -0.1149076 0.454259185 #> 9        4 7.183838 1.59988 -1.9900479 0.023292830 #> 10       6 7.183838 1.59988 -0.7399544 0.229663845 #> 11       6 7.183838 1.59988 -0.7399544 0.229663845 #> 12       5 7.183838 1.59988 -1.3650011 0.086126348 #> 13       9 7.183838 1.59988  1.1351860 0.871851293 #> 14       7 7.183838 1.59988 -0.1149076 0.454259185 #> 15       7 7.183838 1.59988 -0.1149076 0.454259185 #> 16       7 7.183838 1.59988 -0.1149076 0.454259185 #> 17       8 7.183838 1.59988  0.5101392 0.695023022 #> 18       5 7.183838 1.59988 -1.3650011 0.086126348 #> 19       7 7.183838 1.59988 -0.1149076 0.454259185 #> 20       5 7.183838 1.59988 -1.3650011 0.086126348 #> 21       5 7.183838 1.59988 -1.3650011 0.086126348 #> 22       7 7.183838 1.59988 -0.1149076 0.454259185 #> 23       7 7.183838 1.59988 -0.1149076 0.454259185 #> 24       9 7.183838 1.59988  1.1351860 0.871851293 #> 25       7 7.183838 1.59988 -0.1149076 0.454259185 #> 26       5 7.183838 1.59988 -1.3650011 0.086126348 #> 27       5 7.183838 1.59988 -1.3650011 0.086126348 #> 28       7 7.183838 1.59988 -0.1149076 0.454259185 #> 29       6 7.183838 1.59988 -0.7399544 0.229663845 #> 30       7 7.183838 1.59988 -0.1149076 0.454259185 #> 31       7 7.183838 1.59988 -0.1149076 0.454259185 #> 32       7 7.183838 1.59988 -0.1149076 0.454259185 #> 33       8 7.183838 1.59988  0.5101392 0.695023022 #> 34       6 7.183838 1.59988 -0.7399544 0.229663845 #> 35       6 7.183838 1.59988 -0.7399544 0.229663845 #> 36       8 7.183838 1.59988  0.5101392 0.695023022 #> 37       7 7.183838 1.59988 -0.1149076 0.454259185 #> 38       8 7.183838 1.59988  0.5101392 0.695023022 #> 39       7 7.183838 1.59988 -0.1149076 0.454259185 #> 40       6 7.183838 1.59988 -0.7399544 0.229663845 #> 41       6 7.183838 1.59988 -0.7399544 0.229663845 #> 42       8 7.183838 1.59988  0.5101392 0.695023022 #> 43       5 7.183838 1.59988 -1.3650011 0.086126348 #> 44       8 7.183838 1.59988  0.5101392 0.695023022 #> 45       4 7.183838 1.59988 -1.9900479 0.023292830 #> 46       7 7.183838 1.59988 -0.1149076 0.454259185 #> 47      11 7.183838 1.59988  2.3852795 0.991466925 #> 48       8 7.183838 1.59988  0.5101392 0.695023022 #> 49       5 7.183838 1.59988 -1.3650011 0.086126348 #> 50       4 7.183838 1.59988 -1.9900479 0.023292830 #> 51       7 7.183838 1.59988 -0.1149076 0.454259185 #> 52       7 7.183838 1.59988 -0.1149076 0.454259185 #> 53       7 7.183838 1.59988 -0.1149076 0.454259185 #> 54       8 7.183838 1.59988  0.5101392 0.695023022 #> 55       8 7.183838 1.59988  0.5101392 0.695023022 #> 56       6 7.183838 1.59988 -0.7399544 0.229663845 #> 57       6 7.183838 1.59988 -0.7399544 0.229663845 #> 58       5 7.183838 1.59988 -1.3650011 0.086126348 #> 59       9 7.183838 1.59988  1.1351860 0.871851293 #> 60       7 7.183838 1.59988 -0.1149076 0.454259185 #> 61       9 7.183838 1.59988  1.1351860 0.871851293 #> 62       7 7.183838 1.59988 -0.1149076 0.454259185 #> 63       5 7.183838 1.59988 -1.3650011 0.086126348 #> 64       9 7.183838 1.59988  1.1351860 0.871851293 #> 65       5 7.183838 1.59988 -1.3650011 0.086126348 #> 66       8 7.183838 1.59988  0.5101392 0.695023022 #> 67       6 7.183838 1.59988 -0.7399544 0.229663845 #> 68       7 7.183838 1.59988 -0.1149076 0.454259185 #> 69       5 7.183838 1.59988 -1.3650011 0.086126348 #> 70       5 7.183838 1.59988 -1.3650011 0.086126348 #> 71       9 7.183838 1.59988  1.1351860 0.871851293 #> 72      10 7.183838 1.59988  1.7602327 0.960815822 #> 73       7 7.183838 1.59988 -0.1149076 0.454259185 #> 74      10 7.183838 1.59988  1.7602327 0.960815822 #> 75       6 7.183838 1.59988 -0.7399544 0.229663845 #> 76       7 7.183838 1.59988 -0.1149076 0.454259185 #> 77       4 7.183838 1.59988 -1.9900479 0.023292830 #> 78       6 7.183838 1.59988 -0.7399544 0.229663845 #> 79       5 7.183838 1.59988 -1.3650011 0.086126348 #> 80       6 7.183838 1.59988 -0.7399544 0.229663845 #> 81      10 7.183838 1.59988  1.7602327 0.960815822 #> 82       4 7.183838 1.59988 -1.9900479 0.023292830 #> 83       3 7.183838 1.59988 -2.6150947 0.004460136 #> 84       8 7.183838 1.59988  0.5101392 0.695023022 #> 85       5 7.183838 1.59988 -1.3650011 0.086126348 #> 86       7 7.183838 1.59988 -0.1149076 0.454259185 #> 87       8 7.183838 1.59988  0.5101392 0.695023022 #> 88       9 7.183838 1.59988  1.1351860 0.871851293 #> 89       7 7.183838 1.59988 -0.1149076 0.454259185 #> 90       5 7.183838 1.59988 -1.3650011 0.086126348 #> 91       8 7.183838 1.59988  0.5101392 0.695023022 #> 92       5 7.183838 1.59988 -1.3650011 0.086126348 #> 93       8 7.183838 1.59988  0.5101392 0.695023022 #> 94       6 7.183838 1.59988 -0.7399544 0.229663845 #> 95       8 7.183838 1.59988  0.5101392 0.695023022 #> 96       3 7.183838 1.59988 -2.6150947 0.004460136 #> 97       7 7.183838 1.59988 -0.1149076 0.454259185 #> 98       6 7.183838 1.59988 -0.7399544 0.229663845 #> 99       5 7.183838 1.59988 -1.3650011 0.086126348 #> 100      6 7.183838 1.59988 -0.7399544 0.229663845 plot(lsrq, sig = 0.05)  # Asymtotic version lsrq <- local.sp.runs.test(fx = fx, listw = listw, alternative = \"two.sided\",                            distr =\"bootstrap\", nsim = 399) print(lsrq) #>     SRQ     EP.i    SdP.i zseudo.value pseudo.value #> 1     6 7.197995 1.600376  -0.74857115  0.454115727 #> 2     8 7.080201 1.631531   0.56376464  0.572914316 #> 3     4 7.250627 1.651052  -1.96882125  0.048973622 #> 4     8 7.170426 1.685298   0.49224174  0.622548457 #> 5     5 7.263158 1.573468  -1.43832514  0.150341823 #> 6     9 7.298246 1.459253   1.16618195  0.243540890 #> 7     7 7.130326 1.537817  -0.08474727  0.932462317 #> 8     7 7.150376 1.573155  -0.09558874  0.923847206 #> 9     4 7.160401 1.600671  -1.97442302  0.048333663 #> 10    6 7.115288 1.659976  -0.67187019  0.501666337 #> 11    6 7.135338 1.582482  -0.71744137  0.473101802 #> 12    5 7.223058 1.611164  -1.37978372  0.167653245 #> 13    9 7.243108 1.603560   1.09562016  0.273245033 #> 14    7 7.215539 1.584681  -0.13601399  0.891810220 #> 15    7 7.263158 1.648334  -0.15965080  0.873156160 #> 16    7 7.228070 1.554896  -0.14667870  0.883385629 #> 17    8 7.125313 1.552866   0.56327250  0.573249339 #> 18    5 7.210526 1.530523  -1.44429433  0.148656201 #> 19    7 7.135338 1.542278  -0.08775222  0.930073615 #> 20    5 7.055138 1.647891  -1.24713206  0.212349080 #> 21    5 7.200501 1.548187  -1.42134039  0.155217828 #> 22    7 7.406015 1.550025  -0.26194100  0.793366930 #> 23    7 7.293233 1.529190  -0.19175715  0.847932434 #> 24    9 7.303258 1.612066   1.05252601  0.292558284 #> 25    7 7.187970 1.555427  -0.12084781  0.903811577 #> 26    5 7.070175 1.636606  -1.26491965  0.205900134 #> 27    5 7.130326 1.566951  -1.35953600  0.173976802 #> 28    7 7.165414 1.632800  -0.10130665  0.919307037 #> 29    6 7.155388 1.647570  -0.70126817  0.483135672 #> 30    7 7.085213 1.672346  -0.05095419  0.959362022 #> 31    7 7.082707 1.649022  -0.05015505  0.959998834 #> 32    7 7.107769 1.622987  -0.06640192  0.947057840 #> 33    8 7.077694 1.553559   0.59367272  0.552731031 #> 34    6 7.150376 1.626552  -0.70724810  0.479412310 #> 35    6 7.290727 1.627555  -0.79304672  0.427750603 #> 36    8 7.017544 1.603135   0.61283415  0.539986006 #> 37    7 7.253133 1.639213  -0.15442340  0.877275906 #> 38    8 7.260652 1.654059   0.44699041  0.654881983 #> 39    7 7.358396 1.570575  -0.22819407  0.819495368 #> 40    6 7.215539 1.547785  -0.78534106  0.432253625 #> 41    6 7.243108 1.612933  -0.77071240  0.440877420 #> 42    8 7.165414 1.609553   0.51852073  0.604095002 #> 43    5 7.190476 1.639282  -1.33624116  0.181470462 #> 44    8 7.092732 1.598970   0.56740779  0.570437159 #> 45    4 7.140351 1.585218  -1.98102172  0.047588838 #> 46    7 7.177945 1.535481  -0.11588864  0.907740797 #> 47   11 7.135338 1.621690   2.38310741  0.017167184 #> 48    8 7.177945 1.577453   0.52112828  0.602277412 #> 49    5 7.190476 1.645402  -1.33127150  0.183099692 #> 50    4 7.240602 1.512845  -2.14205825  0.032188795 #> 51    7 7.335840 1.629654  -0.20608029  0.836728193 #> 52    7 7.268170 1.507357  -0.17790771  0.858795456 #> 53    7 7.348371 1.525805  -0.22831940  0.819397944 #> 54    8 7.253133 1.555856   0.48003623  0.631201633 #> 55    8 7.005013 1.569167   0.63408624  0.526024541 #> 56    6 7.195489 1.635621  -0.73090816  0.464835250 #> 57    6 7.270677 1.499386  -0.84746475  0.396736130 #> 58    5 7.092732 1.554349  -1.34637149  0.178182741 #> 59    9 7.177945 1.519030   1.19948597  0.230339036 #> 60    7 6.979950 1.644115   0.01219509  0.990269970 #> 61    9 7.218045 1.664007   1.07088175  0.284222602 #> 62    7 7.223058 1.606479  -0.13884881  0.889569623 #> 63    5 7.090226 1.629465  -1.28276817  0.199573307 #> 64    9 7.152882 1.534915   1.20340039  0.228821417 #> 65    5 7.253133 1.611387  -1.39825714  0.162035863 #> 66    8 7.240602 1.651025   0.45995566  0.645548051 #> 67    6 7.290727 1.688176  -0.76456877  0.444528369 #> 68    7 7.172932 1.544212  -0.11198739  0.910833401 #> 69    5 7.127820 1.530659  -1.39013279  0.164488558 #> 70    5 7.002506 1.757252  -1.13956715  0.254466678 #> 71    9 7.117794 1.643828   1.14501376  0.252203456 #> 72   10 7.213033 1.593716   1.74872290  0.080338929 #> 73    7 7.192982 1.596274  -0.12089556  0.903773763 #> 74   10 7.228070 1.556511   1.78086062  0.074935223 #> 75    6 7.305764 1.552026  -0.84132877  0.400163780 #> 76    7 7.037594 1.546950  -0.02430200  0.980611720 #> 77    4 7.105263 1.608379  -1.93067921  0.053522736 #> 78    6 7.263158 1.612894  -0.78316220  0.433531867 #> 79    5 7.320802 1.596901  -1.45331585  0.146136078 #> 80    6 7.265664 1.605455  -0.78835221  0.430490717 #> 81   10 7.235589 1.668399   1.65692467  0.097534707 #> 82    4 7.278195 1.580440  -2.07423001  0.038057955 #> 83    3 7.055138 1.543984  -2.62641169  0.008629038 #> 84    8 7.345865 1.596377   0.40976250  0.681980176 #> 85    5 7.105263 1.608379  -1.30893506  0.190556350 #> 86    7 7.225564 1.637883  -0.13771672  0.890464302 #> 87    8 7.220551 1.658382   0.47000556  0.638351043 #> 88    9 7.187970 1.635736   1.10777629  0.267958444 #> 89    7 7.162907 1.563088  -0.10422144  0.916993622 #> 90    5 7.102757 1.621764  -1.29658636  0.194773549 #> 91    8 7.208020 1.592803   0.49722409  0.619031036 #> 92    5 7.223058 1.598639  -1.39059356  0.164348711 #> 93    8 7.238095 1.677804   0.45410822  0.649750936 #> 94    6 7.095238 1.500738  -0.72979985  0.465512538 #> 95    8 7.218045 1.628908   0.48004847  0.631192927 #> 96    3 7.270677 1.695965  -2.51813898  0.011797676 #> 97    7 7.152882 1.630176  -0.09378265  0.925281810 #> 98    6 7.110276 1.579667  -0.70285447  0.482146450 #> 99    5 7.127820 1.662837  -1.27963178  0.200674669 #> 100   6 7.182957 1.663716  -0.71103337  0.477063560 plot(lsrq, sig = 0.1)  # \\donttest{ # Case 2:Fastfood example. sf (points) library(lwgeom) data(\"FastFood.sf\") sf::sf_use_s2(FALSE) x <- sf::st_coordinates(sf::st_centroid(FastFood.sf)) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: st_centroid does not give correct centroids for longitude/latitude data listw <- spdep::knearneigh(x, k = 10) formula <- ~ Type lsrq <- local.sp.runs.test(formula = formula, data = FastFood.sf, listw = listw) print(lsrq) #>     runs.i      E.i    Std.i    z.value    p.value #> 1        8 7.668307 1.490157  0.2225895 0.82385504 #> 2        9 7.668307 1.490157  0.8936597 0.37150400 #> 3        9 7.668307 1.490157  0.8936597 0.37150400 #> 4        8 7.668307 1.490157  0.2225895 0.82385504 #> 5       10 7.668307 1.490157  1.5647299 0.11764625 #> 6        8 7.668307 1.490157  0.2225895 0.82385504 #> 7        8 7.668307 1.490157  0.2225895 0.82385504 #> 8        7 7.668307 1.490157 -0.4484808 0.65380626 #> 9        7 7.668307 1.490157 -0.4484808 0.65380626 #> 10       7 7.668307 1.490157 -0.4484808 0.65380626 #> 11       7 7.668307 1.490157 -0.4484808 0.65380626 #> 12       8 7.668307 1.490157  0.2225895 0.82385504 #> 13       9 7.668307 1.490157  0.8936597 0.37150400 #> 14       7 7.668307 1.490157 -0.4484808 0.65380626 #> 15      10 7.668307 1.490157  1.5647299 0.11764625 #> 16       9 7.668307 1.490157  0.8936597 0.37150400 #> 17       7 7.668307 1.490157 -0.4484808 0.65380626 #> 18       9 7.668307 1.490157  0.8936597 0.37150400 #> 19      10 7.668307 1.490157  1.5647299 0.11764625 #> 20       9 7.668307 1.490157  0.8936597 0.37150400 #> 21       9 7.668307 1.490157  0.8936597 0.37150400 #> 22      10 7.668307 1.490157  1.5647299 0.11764625 #> 23       7 7.668307 1.490157 -0.4484808 0.65380626 #> 24       6 7.668307 1.490157 -1.1195510 0.26290515 #> 25       9 7.668307 1.490157  0.8936597 0.37150400 #> 26       9 7.668307 1.490157  0.8936597 0.37150400 #> 27      10 7.668307 1.490157  1.5647299 0.11764625 #> 28       8 7.668307 1.490157  0.2225895 0.82385504 #> 29       8 7.668307 1.490157  0.2225895 0.82385504 #> 30      10 7.668307 1.490157  1.5647299 0.11764625 #> 31       9 7.668307 1.490157  0.8936597 0.37150400 #> 32       8 7.668307 1.490157  0.2225895 0.82385504 #> 33       6 7.668307 1.490157 -1.1195510 0.26290515 #> 34       8 7.668307 1.490157  0.2225895 0.82385504 #> 35       8 7.668307 1.490157  0.2225895 0.82385504 #> 36       9 7.668307 1.490157  0.8936597 0.37150400 #> 37       8 7.668307 1.490157  0.2225895 0.82385504 #> 38       7 7.668307 1.490157 -0.4484808 0.65380626 #> 39       8 7.668307 1.490157  0.2225895 0.82385504 #> 40       9 7.668307 1.490157  0.8936597 0.37150400 #> 41       8 7.668307 1.490157  0.2225895 0.82385504 #> 42       9 7.668307 1.490157  0.8936597 0.37150400 #> 43       7 7.668307 1.490157 -0.4484808 0.65380626 #> 44       8 7.668307 1.490157  0.2225895 0.82385504 #> 45       8 7.668307 1.490157  0.2225895 0.82385504 #> 46       8 7.668307 1.490157  0.2225895 0.82385504 #> 47       7 7.668307 1.490157 -0.4484808 0.65380626 #> 48       6 7.668307 1.490157 -1.1195510 0.26290515 #> 49       6 7.668307 1.490157 -1.1195510 0.26290515 #> 50       8 7.668307 1.490157  0.2225895 0.82385504 #> 51       6 7.668307 1.490157 -1.1195510 0.26290515 #> 52       7 7.668307 1.490157 -0.4484808 0.65380626 #> 53       4 7.668307 1.490157 -2.4616914 0.01382836 #> 54       7 7.668307 1.490157 -0.4484808 0.65380626 #> 55       8 7.668307 1.490157  0.2225895 0.82385504 #> 56       8 7.668307 1.490157  0.2225895 0.82385504 #> 57       4 7.668307 1.490157 -2.4616914 0.01382836 #> 58       5 7.668307 1.490157 -1.7906212 0.07335410 #> 59       9 7.668307 1.490157  0.8936597 0.37150400 #> 60      11 7.668307 1.490157  2.2358001 0.02536487 #> 61       4 7.668307 1.490157 -2.4616914 0.01382836 #> 62       7 7.668307 1.490157 -0.4484808 0.65380626 #> 63       6 7.668307 1.490157 -1.1195510 0.26290515 #> 64      10 7.668307 1.490157  1.5647299 0.11764625 #> 65       9 7.668307 1.490157  0.8936597 0.37150400 #> 66       7 7.668307 1.490157 -0.4484808 0.65380626 #> 67       7 7.668307 1.490157 -0.4484808 0.65380626 #> 68       6 7.668307 1.490157 -1.1195510 0.26290515 #> 69       8 7.668307 1.490157  0.2225895 0.82385504 #> 70      10 7.668307 1.490157  1.5647299 0.11764625 #> 71       8 7.668307 1.490157  0.2225895 0.82385504 #> 72       8 7.668307 1.490157  0.2225895 0.82385504 #> 73       6 7.668307 1.490157 -1.1195510 0.26290515 #> 74       8 7.668307 1.490157  0.2225895 0.82385504 #> 75       8 7.668307 1.490157  0.2225895 0.82385504 #> 76       8 7.668307 1.490157  0.2225895 0.82385504 #> 77      10 7.668307 1.490157  1.5647299 0.11764625 #> 78       8 7.668307 1.490157  0.2225895 0.82385504 #> 79       9 7.668307 1.490157  0.8936597 0.37150400 #> 80       8 7.668307 1.490157  0.2225895 0.82385504 #> 81       8 7.668307 1.490157  0.2225895 0.82385504 #> 82       8 7.668307 1.490157  0.2225895 0.82385504 #> 83       9 7.668307 1.490157  0.8936597 0.37150400 #> 84       8 7.668307 1.490157  0.2225895 0.82385504 #> 85       9 7.668307 1.490157  0.8936597 0.37150400 #> 86      10 7.668307 1.490157  1.5647299 0.11764625 #> 87       7 7.668307 1.490157 -0.4484808 0.65380626 #> 88       9 7.668307 1.490157  0.8936597 0.37150400 #> 89       7 7.668307 1.490157 -0.4484808 0.65380626 #> 90       7 7.668307 1.490157 -0.4484808 0.65380626 #> 91       8 7.668307 1.490157  0.2225895 0.82385504 #> 92      11 7.668307 1.490157  2.2358001 0.02536487 #> 93       7 7.668307 1.490157 -0.4484808 0.65380626 #> 94       6 7.668307 1.490157 -1.1195510 0.26290515 #> 95       9 7.668307 1.490157  0.8936597 0.37150400 #> 96       8 7.668307 1.490157  0.2225895 0.82385504 #> 97       8 7.668307 1.490157  0.2225895 0.82385504 #> 98       9 7.668307 1.490157  0.8936597 0.37150400 #> 99      10 7.668307 1.490157  1.5647299 0.11764625 #> 100     10 7.668307 1.490157  1.5647299 0.11764625 #> 101      9 7.668307 1.490157  0.8936597 0.37150400 #> 102      7 7.668307 1.490157 -0.4484808 0.65380626 #> 103     10 7.668307 1.490157  1.5647299 0.11764625 #> 104     10 7.668307 1.490157  1.5647299 0.11764625 #> 105      9 7.668307 1.490157  0.8936597 0.37150400 #> 106     10 7.668307 1.490157  1.5647299 0.11764625 #> 107      7 7.668307 1.490157 -0.4484808 0.65380626 #> 108      8 7.668307 1.490157  0.2225895 0.82385504 #> 109     10 7.668307 1.490157  1.5647299 0.11764625 #> 110      7 7.668307 1.490157 -0.4484808 0.65380626 #> 111     11 7.668307 1.490157  2.2358001 0.02536487 #> 112      7 7.668307 1.490157 -0.4484808 0.65380626 #> 113      9 7.668307 1.490157  0.8936597 0.37150400 #> 114     10 7.668307 1.490157  1.5647299 0.11764625 #> 115      5 7.668307 1.490157 -1.7906212 0.07335410 #> 116      7 7.668307 1.490157 -0.4484808 0.65380626 #> 117      8 7.668307 1.490157  0.2225895 0.82385504 #> 118      9 7.668307 1.490157  0.8936597 0.37150400 #> 119      7 7.668307 1.490157 -0.4484808 0.65380626 #> 120      9 7.668307 1.490157  0.8936597 0.37150400 #> 121      9 7.668307 1.490157  0.8936597 0.37150400 #> 122      3 7.668307 1.490157 -3.1327617 0.00173170 #> 123      7 7.668307 1.490157 -0.4484808 0.65380626 #> 124      9 7.668307 1.490157  0.8936597 0.37150400 #> 125      9 7.668307 1.490157  0.8936597 0.37150400 #> 126      7 7.668307 1.490157 -0.4484808 0.65380626 #> 127      7 7.668307 1.490157 -0.4484808 0.65380626 #> 128     10 7.668307 1.490157  1.5647299 0.11764625 #> 129      9 7.668307 1.490157  0.8936597 0.37150400 #> 130      8 7.668307 1.490157  0.2225895 0.82385504 #> 131      6 7.668307 1.490157 -1.1195510 0.26290515 #> 132      9 7.668307 1.490157  0.8936597 0.37150400 #> 133      8 7.668307 1.490157  0.2225895 0.82385504 #> 134      9 7.668307 1.490157  0.8936597 0.37150400 #> 135      8 7.668307 1.490157  0.2225895 0.82385504 #> 136      7 7.668307 1.490157 -0.4484808 0.65380626 #> 137      5 7.668307 1.490157 -1.7906212 0.07335410 #> 138      9 7.668307 1.490157  0.8936597 0.37150400 #> 139      8 7.668307 1.490157  0.2225895 0.82385504 #> 140      8 7.668307 1.490157  0.2225895 0.82385504 #> 141      7 7.668307 1.490157 -0.4484808 0.65380626 #> 142      7 7.668307 1.490157 -0.4484808 0.65380626 #> 143     10 7.668307 1.490157  1.5647299 0.11764625 #> 144      8 7.668307 1.490157  0.2225895 0.82385504 #> 145      9 7.668307 1.490157  0.8936597 0.37150400 #> 146      7 7.668307 1.490157 -0.4484808 0.65380626 #> 147      9 7.668307 1.490157  0.8936597 0.37150400 #> 148      9 7.668307 1.490157  0.8936597 0.37150400 #> 149      9 7.668307 1.490157  0.8936597 0.37150400 #> 150      8 7.668307 1.490157  0.2225895 0.82385504 #> 151      9 7.668307 1.490157  0.8936597 0.37150400 #> 152      7 7.668307 1.490157 -0.4484808 0.65380626 #> 153      7 7.668307 1.490157 -0.4484808 0.65380626 #> 154      9 7.668307 1.490157  0.8936597 0.37150400 #> 155      9 7.668307 1.490157  0.8936597 0.37150400 #> 156      9 7.668307 1.490157  0.8936597 0.37150400 #> 157     10 7.668307 1.490157  1.5647299 0.11764625 #> 158      8 7.668307 1.490157  0.2225895 0.82385504 #> 159      8 7.668307 1.490157  0.2225895 0.82385504 #> 160      8 7.668307 1.490157  0.2225895 0.82385504 #> 161      8 7.668307 1.490157  0.2225895 0.82385504 #> 162      9 7.668307 1.490157  0.8936597 0.37150400 #> 163      8 7.668307 1.490157  0.2225895 0.82385504 #> 164     10 7.668307 1.490157  1.5647299 0.11764625 #> 165      8 7.668307 1.490157  0.2225895 0.82385504 #> 166      8 7.668307 1.490157  0.2225895 0.82385504 #> 167     10 7.668307 1.490157  1.5647299 0.11764625 #> 168      8 7.668307 1.490157  0.2225895 0.82385504 #> 169      6 7.668307 1.490157 -1.1195510 0.26290515 #> 170      9 7.668307 1.490157  0.8936597 0.37150400 #> 171      9 7.668307 1.490157  0.8936597 0.37150400 #> 172      9 7.668307 1.490157  0.8936597 0.37150400 #> 173      7 7.668307 1.490157 -0.4484808 0.65380626 #> 174      9 7.668307 1.490157  0.8936597 0.37150400 #> 175      7 7.668307 1.490157 -0.4484808 0.65380626 #> 176     10 7.668307 1.490157  1.5647299 0.11764625 #> 177      9 7.668307 1.490157  0.8936597 0.37150400 #> 178      7 7.668307 1.490157 -0.4484808 0.65380626 #> 179      7 7.668307 1.490157 -0.4484808 0.65380626 #> 180     10 7.668307 1.490157  1.5647299 0.11764625 #> 181      8 7.668307 1.490157  0.2225895 0.82385504 #> 182     11 7.668307 1.490157  2.2358001 0.02536487 #> 183      8 7.668307 1.490157  0.2225895 0.82385504 #> 184      8 7.668307 1.490157  0.2225895 0.82385504 #> 185      9 7.668307 1.490157  0.8936597 0.37150400 #> 186      4 7.668307 1.490157 -2.4616914 0.01382836 #> 187      8 7.668307 1.490157  0.2225895 0.82385504 #> 188      7 7.668307 1.490157 -0.4484808 0.65380626 #> 189      9 7.668307 1.490157  0.8936597 0.37150400 #> 190      8 7.668307 1.490157  0.2225895 0.82385504 #> 191      9 7.668307 1.490157  0.8936597 0.37150400 #> 192      8 7.668307 1.490157  0.2225895 0.82385504 #> 193      7 7.668307 1.490157 -0.4484808 0.65380626 #> 194      9 7.668307 1.490157  0.8936597 0.37150400 #> 195     10 7.668307 1.490157  1.5647299 0.11764625 #> 196      8 7.668307 1.490157  0.2225895 0.82385504 #> 197      8 7.668307 1.490157  0.2225895 0.82385504 #> 198     10 7.668307 1.490157  1.5647299 0.11764625 #> 199      7 7.668307 1.490157 -0.4484808 0.65380626 #> 200     10 7.668307 1.490157  1.5647299 0.11764625 #> 201      7 7.668307 1.490157 -0.4484808 0.65380626 #> 202      8 7.668307 1.490157  0.2225895 0.82385504 #> 203      7 7.668307 1.490157 -0.4484808 0.65380626 #> 204      9 7.668307 1.490157  0.8936597 0.37150400 #> 205      7 7.668307 1.490157 -0.4484808 0.65380626 #> 206      8 7.668307 1.490157  0.2225895 0.82385504 #> 207      7 7.668307 1.490157 -0.4484808 0.65380626 #> 208      8 7.668307 1.490157  0.2225895 0.82385504 #> 209      6 7.668307 1.490157 -1.1195510 0.26290515 #> 210      8 7.668307 1.490157  0.2225895 0.82385504 #> 211      9 7.668307 1.490157  0.8936597 0.37150400 #> 212      8 7.668307 1.490157  0.2225895 0.82385504 #> 213     10 7.668307 1.490157  1.5647299 0.11764625 #> 214      7 7.668307 1.490157 -0.4484808 0.65380626 #> 215      8 7.668307 1.490157  0.2225895 0.82385504 #> 216      7 7.668307 1.490157 -0.4484808 0.65380626 #> 217      8 7.668307 1.490157  0.2225895 0.82385504 #> 218      9 7.668307 1.490157  0.8936597 0.37150400 #> 219      7 7.668307 1.490157 -0.4484808 0.65380626 #> 220      8 7.668307 1.490157  0.2225895 0.82385504 #> 221      6 7.668307 1.490157 -1.1195510 0.26290515 #> 222      9 7.668307 1.490157  0.8936597 0.37150400 #> 223      7 7.668307 1.490157 -0.4484808 0.65380626 #> 224      4 7.668307 1.490157 -2.4616914 0.01382836 #> 225     11 7.668307 1.490157  2.2358001 0.02536487 #> 226      6 7.668307 1.490157 -1.1195510 0.26290515 #> 227      9 7.668307 1.490157  0.8936597 0.37150400 #> 228      6 7.668307 1.490157 -1.1195510 0.26290515 #> 229      6 7.668307 1.490157 -1.1195510 0.26290515 #> 230      7 7.668307 1.490157 -0.4484808 0.65380626 #> 231      7 7.668307 1.490157 -0.4484808 0.65380626 #> 232      7 7.668307 1.490157 -0.4484808 0.65380626 #> 233      6 7.668307 1.490157 -1.1195510 0.26290515 #> 234      7 7.668307 1.490157 -0.4484808 0.65380626 #> 235      8 7.668307 1.490157  0.2225895 0.82385504 #> 236      9 7.668307 1.490157  0.8936597 0.37150400 #> 237      6 7.668307 1.490157 -1.1195510 0.26290515 #> 238     10 7.668307 1.490157  1.5647299 0.11764625 #> 239     10 7.668307 1.490157  1.5647299 0.11764625 #> 240     10 7.668307 1.490157  1.5647299 0.11764625 #> 241     11 7.668307 1.490157  2.2358001 0.02536487 #> 242     11 7.668307 1.490157  2.2358001 0.02536487 #> 243      6 7.668307 1.490157 -1.1195510 0.26290515 #> 244      8 7.668307 1.490157  0.2225895 0.82385504 #> 245      7 7.668307 1.490157 -0.4484808 0.65380626 #> 246      7 7.668307 1.490157 -0.4484808 0.65380626 #> 247      9 7.668307 1.490157  0.8936597 0.37150400 #> 248      9 7.668307 1.490157  0.8936597 0.37150400 #> 249      7 7.668307 1.490157 -0.4484808 0.65380626 #> 250      9 7.668307 1.490157  0.8936597 0.37150400 #> 251      9 7.668307 1.490157  0.8936597 0.37150400 #> 252      6 7.668307 1.490157 -1.1195510 0.26290515 #> 253      7 7.668307 1.490157 -0.4484808 0.65380626 #> 254     10 7.668307 1.490157  1.5647299 0.11764625 #> 255      5 7.668307 1.490157 -1.7906212 0.07335410 #> 256      5 7.668307 1.490157 -1.7906212 0.07335410 #> 257     10 7.668307 1.490157  1.5647299 0.11764625 #> 258      8 7.668307 1.490157  0.2225895 0.82385504 #> 259      9 7.668307 1.490157  0.8936597 0.37150400 #> 260      7 7.668307 1.490157 -0.4484808 0.65380626 #> 261     10 7.668307 1.490157  1.5647299 0.11764625 #> 262      6 7.668307 1.490157 -1.1195510 0.26290515 #> 263      8 7.668307 1.490157  0.2225895 0.82385504 #> 264      6 7.668307 1.490157 -1.1195510 0.26290515 #> 265      7 7.668307 1.490157 -0.4484808 0.65380626 #> 266      7 7.668307 1.490157 -0.4484808 0.65380626 #> 267      7 7.668307 1.490157 -0.4484808 0.65380626 #> 268      9 7.668307 1.490157  0.8936597 0.37150400 #> 269      6 7.668307 1.490157 -1.1195510 0.26290515 #> 270      7 7.668307 1.490157 -0.4484808 0.65380626 #> 271      7 7.668307 1.490157 -0.4484808 0.65380626 #> 272      8 7.668307 1.490157  0.2225895 0.82385504 #> 273      8 7.668307 1.490157  0.2225895 0.82385504 #> 274     10 7.668307 1.490157  1.5647299 0.11764625 #> 275      5 7.668307 1.490157 -1.7906212 0.07335410 #> 276      7 7.668307 1.490157 -0.4484808 0.65380626 #> 277     10 7.668307 1.490157  1.5647299 0.11764625 #> 278      7 7.668307 1.490157 -0.4484808 0.65380626 #> 279      8 7.668307 1.490157  0.2225895 0.82385504 #> 280      7 7.668307 1.490157 -0.4484808 0.65380626 #> 281      7 7.668307 1.490157 -0.4484808 0.65380626 #> 282      8 7.668307 1.490157  0.2225895 0.82385504 #> 283      8 7.668307 1.490157  0.2225895 0.82385504 #> 284      9 7.668307 1.490157  0.8936597 0.37150400 #> 285     10 7.668307 1.490157  1.5647299 0.11764625 #> 286      8 7.668307 1.490157  0.2225895 0.82385504 #> 287      8 7.668307 1.490157  0.2225895 0.82385504 #> 288      9 7.668307 1.490157  0.8936597 0.37150400 #> 289      9 7.668307 1.490157  0.8936597 0.37150400 #> 290     10 7.668307 1.490157  1.5647299 0.11764625 #> 291      9 7.668307 1.490157  0.8936597 0.37150400 #> 292      9 7.668307 1.490157  0.8936597 0.37150400 #> 293     10 7.668307 1.490157  1.5647299 0.11764625 #> 294      8 7.668307 1.490157  0.2225895 0.82385504 #> 295     10 7.668307 1.490157  1.5647299 0.11764625 #> 296      8 7.668307 1.490157  0.2225895 0.82385504 #> 297     10 7.668307 1.490157  1.5647299 0.11764625 #> 298      8 7.668307 1.490157  0.2225895 0.82385504 #> 299      9 7.668307 1.490157  0.8936597 0.37150400 #> 300      9 7.668307 1.490157  0.8936597 0.37150400 #> 301      9 7.668307 1.490157  0.8936597 0.37150400 #> 302      7 7.668307 1.490157 -0.4484808 0.65380626 #> 303      7 7.668307 1.490157 -0.4484808 0.65380626 #> 304      9 7.668307 1.490157  0.8936597 0.37150400 #> 305      8 7.668307 1.490157  0.2225895 0.82385504 #> 306     10 7.668307 1.490157  1.5647299 0.11764625 #> 307      9 7.668307 1.490157  0.8936597 0.37150400 #> 308      6 7.668307 1.490157 -1.1195510 0.26290515 #> 309      8 7.668307 1.490157  0.2225895 0.82385504 #> 310      7 7.668307 1.490157 -0.4484808 0.65380626 #> 311      8 7.668307 1.490157  0.2225895 0.82385504 #> 312      8 7.668307 1.490157  0.2225895 0.82385504 #> 313      9 7.668307 1.490157  0.8936597 0.37150400 #> 314      4 7.668307 1.490157 -2.4616914 0.01382836 #> 315      6 7.668307 1.490157 -1.1195510 0.26290515 #> 316      7 7.668307 1.490157 -0.4484808 0.65380626 #> 317      8 7.668307 1.490157  0.2225895 0.82385504 #> 318      9 7.668307 1.490157  0.8936597 0.37150400 #> 319      8 7.668307 1.490157  0.2225895 0.82385504 #> 320      9 7.668307 1.490157  0.8936597 0.37150400 #> 321      7 7.668307 1.490157 -0.4484808 0.65380626 #> 322      9 7.668307 1.490157  0.8936597 0.37150400 #> 323      9 7.668307 1.490157  0.8936597 0.37150400 #> 324      9 7.668307 1.490157  0.8936597 0.37150400 #> 325      9 7.668307 1.490157  0.8936597 0.37150400 #> 326      5 7.668307 1.490157 -1.7906212 0.07335410 #> 327      6 7.668307 1.490157 -1.1195510 0.26290515 #> 328      8 7.668307 1.490157  0.2225895 0.82385504 #> 329      9 7.668307 1.490157  0.8936597 0.37150400 #> 330     10 7.668307 1.490157  1.5647299 0.11764625 #> 331      8 7.668307 1.490157  0.2225895 0.82385504 #> 332      8 7.668307 1.490157  0.2225895 0.82385504 #> 333      9 7.668307 1.490157  0.8936597 0.37150400 #> 334      8 7.668307 1.490157  0.2225895 0.82385504 #> 335      7 7.668307 1.490157 -0.4484808 0.65380626 #> 336      5 7.668307 1.490157 -1.7906212 0.07335410 #> 337      6 7.668307 1.490157 -1.1195510 0.26290515 #> 338      9 7.668307 1.490157  0.8936597 0.37150400 #> 339      8 7.668307 1.490157  0.2225895 0.82385504 #> 340      6 7.668307 1.490157 -1.1195510 0.26290515 #> 341      6 7.668307 1.490157 -1.1195510 0.26290515 #> 342     11 7.668307 1.490157  2.2358001 0.02536487 #> 343      9 7.668307 1.490157  0.8936597 0.37150400 #> 344     11 7.668307 1.490157  2.2358001 0.02536487 #> 345      9 7.668307 1.490157  0.8936597 0.37150400 #> 346      8 7.668307 1.490157  0.2225895 0.82385504 #> 347      9 7.668307 1.490157  0.8936597 0.37150400 #> 348      8 7.668307 1.490157  0.2225895 0.82385504 #> 349     11 7.668307 1.490157  2.2358001 0.02536487 #> 350      9 7.668307 1.490157  0.8936597 0.37150400 #> 351      9 7.668307 1.490157  0.8936597 0.37150400 #> 352      9 7.668307 1.490157  0.8936597 0.37150400 #> 353      7 7.668307 1.490157 -0.4484808 0.65380626 #> 354      9 7.668307 1.490157  0.8936597 0.37150400 #> 355      8 7.668307 1.490157  0.2225895 0.82385504 #> 356     11 7.668307 1.490157  2.2358001 0.02536487 #> 357      8 7.668307 1.490157  0.2225895 0.82385504 #> 358      9 7.668307 1.490157  0.8936597 0.37150400 #> 359      9 7.668307 1.490157  0.8936597 0.37150400 #> 360      9 7.668307 1.490157  0.8936597 0.37150400 #> 361      9 7.668307 1.490157  0.8936597 0.37150400 #> 362      8 7.668307 1.490157  0.2225895 0.82385504 #> 363      9 7.668307 1.490157  0.8936597 0.37150400 #> 364      6 7.668307 1.490157 -1.1195510 0.26290515 #> 365     10 7.668307 1.490157  1.5647299 0.11764625 #> 366      8 7.668307 1.490157  0.2225895 0.82385504 #> 367     10 7.668307 1.490157  1.5647299 0.11764625 #> 368     10 7.668307 1.490157  1.5647299 0.11764625 #> 369      7 7.668307 1.490157 -0.4484808 0.65380626 #> 370      8 7.668307 1.490157  0.2225895 0.82385504 #> 371      8 7.668307 1.490157  0.2225895 0.82385504 #> 372      9 7.668307 1.490157  0.8936597 0.37150400 #> 373      9 7.668307 1.490157  0.8936597 0.37150400 #> 374     10 7.668307 1.490157  1.5647299 0.11764625 #> 375      9 7.668307 1.490157  0.8936597 0.37150400 #> 376      8 7.668307 1.490157  0.2225895 0.82385504 #> 377     10 7.668307 1.490157  1.5647299 0.11764625 #> 378      8 7.668307 1.490157  0.2225895 0.82385504 #> 379      8 7.668307 1.490157  0.2225895 0.82385504 #> 380      8 7.668307 1.490157  0.2225895 0.82385504 #> 381      7 7.668307 1.490157 -0.4484808 0.65380626 #> 382      6 7.668307 1.490157 -1.1195510 0.26290515 #> 383      8 7.668307 1.490157  0.2225895 0.82385504 #> 384     10 7.668307 1.490157  1.5647299 0.11764625 #> 385      7 7.668307 1.490157 -0.4484808 0.65380626 #> 386      9 7.668307 1.490157  0.8936597 0.37150400 #> 387      8 7.668307 1.490157  0.2225895 0.82385504 #> 388      9 7.668307 1.490157  0.8936597 0.37150400 #> 389      8 7.668307 1.490157  0.2225895 0.82385504 #> 390      7 7.668307 1.490157 -0.4484808 0.65380626 #> 391      4 7.668307 1.490157 -2.4616914 0.01382836 #> 392     10 7.668307 1.490157  1.5647299 0.11764625 #> 393      6 7.668307 1.490157 -1.1195510 0.26290515 #> 394      8 7.668307 1.490157  0.2225895 0.82385504 #> 395      8 7.668307 1.490157  0.2225895 0.82385504 #> 396      7 7.668307 1.490157 -0.4484808 0.65380626 #> 397      8 7.668307 1.490157  0.2225895 0.82385504 #> 398      8 7.668307 1.490157  0.2225895 0.82385504 #> 399      9 7.668307 1.490157  0.8936597 0.37150400 #> 400      9 7.668307 1.490157  0.8936597 0.37150400 #> 401      9 7.668307 1.490157  0.8936597 0.37150400 #> 402      9 7.668307 1.490157  0.8936597 0.37150400 #> 403      9 7.668307 1.490157  0.8936597 0.37150400 #> 404      8 7.668307 1.490157  0.2225895 0.82385504 #> 405      5 7.668307 1.490157 -1.7906212 0.07335410 #> 406      7 7.668307 1.490157 -0.4484808 0.65380626 #> 407      8 7.668307 1.490157  0.2225895 0.82385504 #> 408      8 7.668307 1.490157  0.2225895 0.82385504 #> 409      8 7.668307 1.490157  0.2225895 0.82385504 #> 410      8 7.668307 1.490157  0.2225895 0.82385504 #> 411      8 7.668307 1.490157  0.2225895 0.82385504 #> 412      7 7.668307 1.490157 -0.4484808 0.65380626 #> 413      8 7.668307 1.490157  0.2225895 0.82385504 #> 414     10 7.668307 1.490157  1.5647299 0.11764625 #> 415      8 7.668307 1.490157  0.2225895 0.82385504 #> 416      9 7.668307 1.490157  0.8936597 0.37150400 #> 417      9 7.668307 1.490157  0.8936597 0.37150400 #> 418      8 7.668307 1.490157  0.2225895 0.82385504 #> 419      9 7.668307 1.490157  0.8936597 0.37150400 #> 420      8 7.668307 1.490157  0.2225895 0.82385504 #> 421     11 7.668307 1.490157  2.2358001 0.02536487 #> 422      7 7.668307 1.490157 -0.4484808 0.65380626 #> 423      6 7.668307 1.490157 -1.1195510 0.26290515 #> 424      8 7.668307 1.490157  0.2225895 0.82385504 #> 425      9 7.668307 1.490157  0.8936597 0.37150400 #> 426      5 7.668307 1.490157 -1.7906212 0.07335410 #> 427      9 7.668307 1.490157  0.8936597 0.37150400 #> 428      9 7.668307 1.490157  0.8936597 0.37150400 #> 429     11 7.668307 1.490157  2.2358001 0.02536487 #> 430      8 7.668307 1.490157  0.2225895 0.82385504 #> 431      7 7.668307 1.490157 -0.4484808 0.65380626 #> 432      7 7.668307 1.490157 -0.4484808 0.65380626 #> 433      7 7.668307 1.490157 -0.4484808 0.65380626 #> 434      9 7.668307 1.490157  0.8936597 0.37150400 #> 435      9 7.668307 1.490157  0.8936597 0.37150400 #> 436      8 7.668307 1.490157  0.2225895 0.82385504 #> 437     10 7.668307 1.490157  1.5647299 0.11764625 #> 438      9 7.668307 1.490157  0.8936597 0.37150400 #> 439     10 7.668307 1.490157  1.5647299 0.11764625 #> 440      8 7.668307 1.490157  0.2225895 0.82385504 #> 441     10 7.668307 1.490157  1.5647299 0.11764625 #> 442      9 7.668307 1.490157  0.8936597 0.37150400 #> 443      7 7.668307 1.490157 -0.4484808 0.65380626 #> 444      8 7.668307 1.490157  0.2225895 0.82385504 #> 445     10 7.668307 1.490157  1.5647299 0.11764625 #> 446      8 7.668307 1.490157  0.2225895 0.82385504 #> 447      5 7.668307 1.490157 -1.7906212 0.07335410 #> 448      6 7.668307 1.490157 -1.1195510 0.26290515 #> 449      8 7.668307 1.490157  0.2225895 0.82385504 #> 450      8 7.668307 1.490157  0.2225895 0.82385504 #> 451      8 7.668307 1.490157  0.2225895 0.82385504 #> 452      8 7.668307 1.490157  0.2225895 0.82385504 #> 453      9 7.668307 1.490157  0.8936597 0.37150400 #> 454     10 7.668307 1.490157  1.5647299 0.11764625 #> 455     10 7.668307 1.490157  1.5647299 0.11764625 #> 456      8 7.668307 1.490157  0.2225895 0.82385504 #> 457      7 7.668307 1.490157 -0.4484808 0.65380626 #> 458      7 7.668307 1.490157 -0.4484808 0.65380626 #> 459      9 7.668307 1.490157  0.8936597 0.37150400 #> 460      9 7.668307 1.490157  0.8936597 0.37150400 #> 461      6 7.668307 1.490157 -1.1195510 0.26290515 #> 462      5 7.668307 1.490157 -1.7906212 0.07335410 #> 463     10 7.668307 1.490157  1.5647299 0.11764625 #> 464      8 7.668307 1.490157  0.2225895 0.82385504 #> 465      8 7.668307 1.490157  0.2225895 0.82385504 #> 466      7 7.668307 1.490157 -0.4484808 0.65380626 #> 467      6 7.668307 1.490157 -1.1195510 0.26290515 #> 468      9 7.668307 1.490157  0.8936597 0.37150400 #> 469      8 7.668307 1.490157  0.2225895 0.82385504 #> 470      8 7.668307 1.490157  0.2225895 0.82385504 #> 471      8 7.668307 1.490157  0.2225895 0.82385504 #> 472      7 7.668307 1.490157 -0.4484808 0.65380626 #> 473     10 7.668307 1.490157  1.5647299 0.11764625 #> 474      8 7.668307 1.490157  0.2225895 0.82385504 #> 475      9 7.668307 1.490157  0.8936597 0.37150400 #> 476     10 7.668307 1.490157  1.5647299 0.11764625 #> 477      7 7.668307 1.490157 -0.4484808 0.65380626 #> 478      4 7.668307 1.490157 -2.4616914 0.01382836 #> 479      6 7.668307 1.490157 -1.1195510 0.26290515 #> 480      8 7.668307 1.490157  0.2225895 0.82385504 #> 481      8 7.668307 1.490157  0.2225895 0.82385504 #> 482      8 7.668307 1.490157  0.2225895 0.82385504 #> 483      7 7.668307 1.490157 -0.4484808 0.65380626 #> 484      7 7.668307 1.490157 -0.4484808 0.65380626 #> 485      6 7.668307 1.490157 -1.1195510 0.26290515 #> 486      8 7.668307 1.490157  0.2225895 0.82385504 #> 487      9 7.668307 1.490157  0.8936597 0.37150400 #> 488      8 7.668307 1.490157  0.2225895 0.82385504 #> 489     10 7.668307 1.490157  1.5647299 0.11764625 #> 490     10 7.668307 1.490157  1.5647299 0.11764625 #> 491      8 7.668307 1.490157  0.2225895 0.82385504 #> 492      6 7.668307 1.490157 -1.1195510 0.26290515 #> 493      9 7.668307 1.490157  0.8936597 0.37150400 #> 494      6 7.668307 1.490157 -1.1195510 0.26290515 #> 495      7 7.668307 1.490157 -0.4484808 0.65380626 #> 496      9 7.668307 1.490157  0.8936597 0.37150400 #> 497      8 7.668307 1.490157  0.2225895 0.82385504 #> 498      6 7.668307 1.490157 -1.1195510 0.26290515 #> 499      7 7.668307 1.490157 -0.4484808 0.65380626 #> 500      8 7.668307 1.490157  0.2225895 0.82385504 #> 501      9 7.668307 1.490157  0.8936597 0.37150400 #> 502     10 7.668307 1.490157  1.5647299 0.11764625 #> 503      7 7.668307 1.490157 -0.4484808 0.65380626 #> 504      5 7.668307 1.490157 -1.7906212 0.07335410 #> 505      9 7.668307 1.490157  0.8936597 0.37150400 #> 506      7 7.668307 1.490157 -0.4484808 0.65380626 #> 507      6 7.668307 1.490157 -1.1195510 0.26290515 #> 508     10 7.668307 1.490157  1.5647299 0.11764625 #> 509      8 7.668307 1.490157  0.2225895 0.82385504 #> 510      7 7.668307 1.490157 -0.4484808 0.65380626 #> 511      8 7.668307 1.490157  0.2225895 0.82385504 #> 512     10 7.668307 1.490157  1.5647299 0.11764625 #> 513      9 7.668307 1.490157  0.8936597 0.37150400 #> 514      9 7.668307 1.490157  0.8936597 0.37150400 #> 515     10 7.668307 1.490157  1.5647299 0.11764625 #> 516     11 7.668307 1.490157  2.2358001 0.02536487 #> 517      7 7.668307 1.490157 -0.4484808 0.65380626 #> 518      7 7.668307 1.490157 -0.4484808 0.65380626 #> 519      9 7.668307 1.490157  0.8936597 0.37150400 #> 520      9 7.668307 1.490157  0.8936597 0.37150400 #> 521      7 7.668307 1.490157 -0.4484808 0.65380626 #> 522      6 7.668307 1.490157 -1.1195510 0.26290515 #> 523     10 7.668307 1.490157  1.5647299 0.11764625 #> 524      8 7.668307 1.490157  0.2225895 0.82385504 #> 525     10 7.668307 1.490157  1.5647299 0.11764625 #> 526      7 7.668307 1.490157 -0.4484808 0.65380626 #> 527      6 7.668307 1.490157 -1.1195510 0.26290515 #> 528      7 7.668307 1.490157 -0.4484808 0.65380626 #> 529      9 7.668307 1.490157  0.8936597 0.37150400 #> 530      6 7.668307 1.490157 -1.1195510 0.26290515 #> 531      9 7.668307 1.490157  0.8936597 0.37150400 #> 532     10 7.668307 1.490157  1.5647299 0.11764625 #> 533     10 7.668307 1.490157  1.5647299 0.11764625 #> 534      8 7.668307 1.490157  0.2225895 0.82385504 #> 535     10 7.668307 1.490157  1.5647299 0.11764625 #> 536      8 7.668307 1.490157  0.2225895 0.82385504 #> 537      9 7.668307 1.490157  0.8936597 0.37150400 #> 538      8 7.668307 1.490157  0.2225895 0.82385504 #> 539      8 7.668307 1.490157  0.2225895 0.82385504 #> 540      8 7.668307 1.490157  0.2225895 0.82385504 #> 541      9 7.668307 1.490157  0.8936597 0.37150400 #> 542      9 7.668307 1.490157  0.8936597 0.37150400 #> 543      8 7.668307 1.490157  0.2225895 0.82385504 #> 544      8 7.668307 1.490157  0.2225895 0.82385504 #> 545      8 7.668307 1.490157  0.2225895 0.82385504 #> 546      9 7.668307 1.490157  0.8936597 0.37150400 #> 547      9 7.668307 1.490157  0.8936597 0.37150400 #> 548      8 7.668307 1.490157  0.2225895 0.82385504 #> 549      7 7.668307 1.490157 -0.4484808 0.65380626 #> 550     10 7.668307 1.490157  1.5647299 0.11764625 #> 551     10 7.668307 1.490157  1.5647299 0.11764625 #> 552      9 7.668307 1.490157  0.8936597 0.37150400 #> 553     10 7.668307 1.490157  1.5647299 0.11764625 #> 554      9 7.668307 1.490157  0.8936597 0.37150400 #> 555      8 7.668307 1.490157  0.2225895 0.82385504 #> 556      8 7.668307 1.490157  0.2225895 0.82385504 #> 557     10 7.668307 1.490157  1.5647299 0.11764625 #> 558      7 7.668307 1.490157 -0.4484808 0.65380626 #> 559      9 7.668307 1.490157  0.8936597 0.37150400 #> 560      8 7.668307 1.490157  0.2225895 0.82385504 #> 561      9 7.668307 1.490157  0.8936597 0.37150400 #> 562      9 7.668307 1.490157  0.8936597 0.37150400 #> 563      8 7.668307 1.490157  0.2225895 0.82385504 #> 564      9 7.668307 1.490157  0.8936597 0.37150400 #> 565      6 7.668307 1.490157 -1.1195510 0.26290515 #> 566     10 7.668307 1.490157  1.5647299 0.11764625 #> 567     10 7.668307 1.490157  1.5647299 0.11764625 #> 568     10 7.668307 1.490157  1.5647299 0.11764625 #> 569     10 7.668307 1.490157  1.5647299 0.11764625 #> 570      8 7.668307 1.490157  0.2225895 0.82385504 #> 571      9 7.668307 1.490157  0.8936597 0.37150400 #> 572      6 7.668307 1.490157 -1.1195510 0.26290515 #> 573      9 7.668307 1.490157  0.8936597 0.37150400 #> 574      9 7.668307 1.490157  0.8936597 0.37150400 #> 575      9 7.668307 1.490157  0.8936597 0.37150400 #> 576      8 7.668307 1.490157  0.2225895 0.82385504 #> 577     10 7.668307 1.490157  1.5647299 0.11764625 #> 578      7 7.668307 1.490157 -0.4484808 0.65380626 #> 579      8 7.668307 1.490157  0.2225895 0.82385504 #> 580      7 7.668307 1.490157 -0.4484808 0.65380626 #> 581      8 7.668307 1.490157  0.2225895 0.82385504 #> 582     10 7.668307 1.490157  1.5647299 0.11764625 #> 583      7 7.668307 1.490157 -0.4484808 0.65380626 #> 584      9 7.668307 1.490157  0.8936597 0.37150400 #> 585      7 7.668307 1.490157 -0.4484808 0.65380626 #> 586      5 7.668307 1.490157 -1.7906212 0.07335410 #> 587      6 7.668307 1.490157 -1.1195510 0.26290515 #> 588      6 7.668307 1.490157 -1.1195510 0.26290515 #> 589      7 7.668307 1.490157 -0.4484808 0.65380626 #> 590     10 7.668307 1.490157  1.5647299 0.11764625 #> 591      7 7.668307 1.490157 -0.4484808 0.65380626 #> 592      8 7.668307 1.490157  0.2225895 0.82385504 #> 593      9 7.668307 1.490157  0.8936597 0.37150400 #> 594      9 7.668307 1.490157  0.8936597 0.37150400 #> 595     10 7.668307 1.490157  1.5647299 0.11764625 #> 596      9 7.668307 1.490157  0.8936597 0.37150400 #> 597      5 7.668307 1.490157 -1.7906212 0.07335410 #> 598      9 7.668307 1.490157  0.8936597 0.37150400 #> 599     10 7.668307 1.490157  1.5647299 0.11764625 #> 600      6 7.668307 1.490157 -1.1195510 0.26290515 #> 601      5 7.668307 1.490157 -1.7906212 0.07335410 #> 602      8 7.668307 1.490157  0.2225895 0.82385504 #> 603      9 7.668307 1.490157  0.8936597 0.37150400 #> 604     10 7.668307 1.490157  1.5647299 0.11764625 #> 605      8 7.668307 1.490157  0.2225895 0.82385504 #> 606      8 7.668307 1.490157  0.2225895 0.82385504 #> 607      4 7.668307 1.490157 -2.4616914 0.01382836 #> 608      9 7.668307 1.490157  0.8936597 0.37150400 #> 609      8 7.668307 1.490157  0.2225895 0.82385504 #> 610      9 7.668307 1.490157  0.8936597 0.37150400 #> 611     10 7.668307 1.490157  1.5647299 0.11764625 #> 612      7 7.668307 1.490157 -0.4484808 0.65380626 #> 613      8 7.668307 1.490157  0.2225895 0.82385504 #> 614      9 7.668307 1.490157  0.8936597 0.37150400 #> 615      7 7.668307 1.490157 -0.4484808 0.65380626 #> 616      6 7.668307 1.490157 -1.1195510 0.26290515 #> 617      4 7.668307 1.490157 -2.4616914 0.01382836 #> 618      6 7.668307 1.490157 -1.1195510 0.26290515 #> 619      6 7.668307 1.490157 -1.1195510 0.26290515 #> 620      8 7.668307 1.490157  0.2225895 0.82385504 #> 621      8 7.668307 1.490157  0.2225895 0.82385504 #> 622      7 7.668307 1.490157 -0.4484808 0.65380626 #> 623      5 7.668307 1.490157 -1.7906212 0.07335410 #> 624      6 7.668307 1.490157 -1.1195510 0.26290515 #> 625      9 7.668307 1.490157  0.8936597 0.37150400 #> 626      8 7.668307 1.490157  0.2225895 0.82385504 #> 627      7 7.668307 1.490157 -0.4484808 0.65380626 #> 628      9 7.668307 1.490157  0.8936597 0.37150400 #> 629      9 7.668307 1.490157  0.8936597 0.37150400 #> 630      7 7.668307 1.490157 -0.4484808 0.65380626 #> 631      8 7.668307 1.490157  0.2225895 0.82385504 #> 632      8 7.668307 1.490157  0.2225895 0.82385504 #> 633      9 7.668307 1.490157  0.8936597 0.37150400 #> 634      8 7.668307 1.490157  0.2225895 0.82385504 #> 635      8 7.668307 1.490157  0.2225895 0.82385504 #> 636      8 7.668307 1.490157  0.2225895 0.82385504 #> 637     10 7.668307 1.490157  1.5647299 0.11764625 #> 638      9 7.668307 1.490157  0.8936597 0.37150400 #> 639      7 7.668307 1.490157 -0.4484808 0.65380626 #> 640      9 7.668307 1.490157  0.8936597 0.37150400 #> 641      7 7.668307 1.490157 -0.4484808 0.65380626 #> 642     11 7.668307 1.490157  2.2358001 0.02536487 #> 643      8 7.668307 1.490157  0.2225895 0.82385504 #> 644      9 7.668307 1.490157  0.8936597 0.37150400 #> 645      7 7.668307 1.490157 -0.4484808 0.65380626 #> 646     10 7.668307 1.490157  1.5647299 0.11764625 #> 647      5 7.668307 1.490157 -1.7906212 0.07335410 #> 648      5 7.668307 1.490157 -1.7906212 0.07335410 #> 649      8 7.668307 1.490157  0.2225895 0.82385504 #> 650      9 7.668307 1.490157  0.8936597 0.37150400 #> 651      9 7.668307 1.490157  0.8936597 0.37150400 #> 652      6 7.668307 1.490157 -1.1195510 0.26290515 #> 653      7 7.668307 1.490157 -0.4484808 0.65380626 #> 654      8 7.668307 1.490157  0.2225895 0.82385504 #> 655      7 7.668307 1.490157 -0.4484808 0.65380626 #> 656      8 7.668307 1.490157  0.2225895 0.82385504 #> 657      8 7.668307 1.490157  0.2225895 0.82385504 #> 658      9 7.668307 1.490157  0.8936597 0.37150400 #> 659      7 7.668307 1.490157 -0.4484808 0.65380626 #> 660      9 7.668307 1.490157  0.8936597 0.37150400 #> 661      9 7.668307 1.490157  0.8936597 0.37150400 #> 662      7 7.668307 1.490157 -0.4484808 0.65380626 #> 663      9 7.668307 1.490157  0.8936597 0.37150400 #> 664      8 7.668307 1.490157  0.2225895 0.82385504 #> 665      8 7.668307 1.490157  0.2225895 0.82385504 #> 666     11 7.668307 1.490157  2.2358001 0.02536487 #> 667      8 7.668307 1.490157  0.2225895 0.82385504 #> 668      9 7.668307 1.490157  0.8936597 0.37150400 #> 669      9 7.668307 1.490157  0.8936597 0.37150400 #> 670      8 7.668307 1.490157  0.2225895 0.82385504 #> 671      9 7.668307 1.490157  0.8936597 0.37150400 #> 672     10 7.668307 1.490157  1.5647299 0.11764625 #> 673     10 7.668307 1.490157  1.5647299 0.11764625 #> 674      8 7.668307 1.490157  0.2225895 0.82385504 #> 675      9 7.668307 1.490157  0.8936597 0.37150400 #> 676      9 7.668307 1.490157  0.8936597 0.37150400 #> 677      9 7.668307 1.490157  0.8936597 0.37150400 #> 678      9 7.668307 1.490157  0.8936597 0.37150400 #> 679      9 7.668307 1.490157  0.8936597 0.37150400 #> 680      9 7.668307 1.490157  0.8936597 0.37150400 #> 681      6 7.668307 1.490157 -1.1195510 0.26290515 #> 682      6 7.668307 1.490157 -1.1195510 0.26290515 #> 683      7 7.668307 1.490157 -0.4484808 0.65380626 #> 684      8 7.668307 1.490157  0.2225895 0.82385504 #> 685      8 7.668307 1.490157  0.2225895 0.82385504 #> 686      7 7.668307 1.490157 -0.4484808 0.65380626 #> 687      8 7.668307 1.490157  0.2225895 0.82385504 #> 688      8 7.668307 1.490157  0.2225895 0.82385504 #> 689      8 7.668307 1.490157  0.2225895 0.82385504 #> 690      8 7.668307 1.490157  0.2225895 0.82385504 #> 691      7 7.668307 1.490157 -0.4484808 0.65380626 #> 692      6 7.668307 1.490157 -1.1195510 0.26290515 #> 693     10 7.668307 1.490157  1.5647299 0.11764625 #> 694      7 7.668307 1.490157 -0.4484808 0.65380626 #> 695      6 7.668307 1.490157 -1.1195510 0.26290515 #> 696     11 7.668307 1.490157  2.2358001 0.02536487 #> 697      8 7.668307 1.490157  0.2225895 0.82385504 #> 698      6 7.668307 1.490157 -1.1195510 0.26290515 #> 699      7 7.668307 1.490157 -0.4484808 0.65380626 #> 700      7 7.668307 1.490157 -0.4484808 0.65380626 #> 701      6 7.668307 1.490157 -1.1195510 0.26290515 #> 702      8 7.668307 1.490157  0.2225895 0.82385504 #> 703      8 7.668307 1.490157  0.2225895 0.82385504 #> 704      8 7.668307 1.490157  0.2225895 0.82385504 #> 705      8 7.668307 1.490157  0.2225895 0.82385504 #> 706     10 7.668307 1.490157  1.5647299 0.11764625 #> 707      9 7.668307 1.490157  0.8936597 0.37150400 #> 708      6 7.668307 1.490157 -1.1195510 0.26290515 #> 709      8 7.668307 1.490157  0.2225895 0.82385504 #> 710     10 7.668307 1.490157  1.5647299 0.11764625 #> 711      9 7.668307 1.490157  0.8936597 0.37150400 #> 712      9 7.668307 1.490157  0.8936597 0.37150400 #> 713      8 7.668307 1.490157  0.2225895 0.82385504 #> 714      8 7.668307 1.490157  0.2225895 0.82385504 #> 715     10 7.668307 1.490157  1.5647299 0.11764625 #> 716      7 7.668307 1.490157 -0.4484808 0.65380626 #> 717      7 7.668307 1.490157 -0.4484808 0.65380626 #> 718      9 7.668307 1.490157  0.8936597 0.37150400 #> 719      8 7.668307 1.490157  0.2225895 0.82385504 #> 720      8 7.668307 1.490157  0.2225895 0.82385504 #> 721      9 7.668307 1.490157  0.8936597 0.37150400 #> 722      9 7.668307 1.490157  0.8936597 0.37150400 #> 723      8 7.668307 1.490157  0.2225895 0.82385504 #> 724      8 7.668307 1.490157  0.2225895 0.82385504 #> 725      6 7.668307 1.490157 -1.1195510 0.26290515 #> 726     10 7.668307 1.490157  1.5647299 0.11764625 #> 727      8 7.668307 1.490157  0.2225895 0.82385504 #> 728      9 7.668307 1.490157  0.8936597 0.37150400 #> 729      7 7.668307 1.490157 -0.4484808 0.65380626 #> 730      9 7.668307 1.490157  0.8936597 0.37150400 #> 731      9 7.668307 1.490157  0.8936597 0.37150400 #> 732      7 7.668307 1.490157 -0.4484808 0.65380626 #> 733     10 7.668307 1.490157  1.5647299 0.11764625 #> 734      6 7.668307 1.490157 -1.1195510 0.26290515 #> 735      6 7.668307 1.490157 -1.1195510 0.26290515 #> 736      5 7.668307 1.490157 -1.7906212 0.07335410 #> 737      6 7.668307 1.490157 -1.1195510 0.26290515 #> 738      7 7.668307 1.490157 -0.4484808 0.65380626 #> 739     10 7.668307 1.490157  1.5647299 0.11764625 #> 740      9 7.668307 1.490157  0.8936597 0.37150400 #> 741      9 7.668307 1.490157  0.8936597 0.37150400 #> 742      7 7.668307 1.490157 -0.4484808 0.65380626 #> 743      8 7.668307 1.490157  0.2225895 0.82385504 #> 744      7 7.668307 1.490157 -0.4484808 0.65380626 #> 745      9 7.668307 1.490157  0.8936597 0.37150400 #> 746      9 7.668307 1.490157  0.8936597 0.37150400 #> 747      6 7.668307 1.490157 -1.1195510 0.26290515 #> 748      9 7.668307 1.490157  0.8936597 0.37150400 #> 749      9 7.668307 1.490157  0.8936597 0.37150400 #> 750      6 7.668307 1.490157 -1.1195510 0.26290515 #> 751      8 7.668307 1.490157  0.2225895 0.82385504 #> 752      8 7.668307 1.490157  0.2225895 0.82385504 #> 753      9 7.668307 1.490157  0.8936597 0.37150400 #> 754      9 7.668307 1.490157  0.8936597 0.37150400 #> 755      7 7.668307 1.490157 -0.4484808 0.65380626 #> 756      9 7.668307 1.490157  0.8936597 0.37150400 #> 757     11 7.668307 1.490157  2.2358001 0.02536487 #> 758      7 7.668307 1.490157 -0.4484808 0.65380626 #> 759      9 7.668307 1.490157  0.8936597 0.37150400 #> 760      7 7.668307 1.490157 -0.4484808 0.65380626 #> 761      9 7.668307 1.490157  0.8936597 0.37150400 #> 762      7 7.668307 1.490157 -0.4484808 0.65380626 #> 763      8 7.668307 1.490157  0.2225895 0.82385504 #> 764      8 7.668307 1.490157  0.2225895 0.82385504 #> 765      4 7.668307 1.490157 -2.4616914 0.01382836 #> 766      8 7.668307 1.490157  0.2225895 0.82385504 #> 767      9 7.668307 1.490157  0.8936597 0.37150400 #> 768      8 7.668307 1.490157  0.2225895 0.82385504 #> 769     11 7.668307 1.490157  2.2358001 0.02536487 #> 770      8 7.668307 1.490157  0.2225895 0.82385504 #> 771     10 7.668307 1.490157  1.5647299 0.11764625 #> 772      7 7.668307 1.490157 -0.4484808 0.65380626 #> 773      6 7.668307 1.490157 -1.1195510 0.26290515 #> 774     10 7.668307 1.490157  1.5647299 0.11764625 #> 775      7 7.668307 1.490157 -0.4484808 0.65380626 #> 776      9 7.668307 1.490157  0.8936597 0.37150400 #> 777      8 7.668307 1.490157  0.2225895 0.82385504 #> 778      6 7.668307 1.490157 -1.1195510 0.26290515 #> 779      8 7.668307 1.490157  0.2225895 0.82385504 #> 780     10 7.668307 1.490157  1.5647299 0.11764625 #> 781     10 7.668307 1.490157  1.5647299 0.11764625 #> 782     10 7.668307 1.490157  1.5647299 0.11764625 #> 783      9 7.668307 1.490157  0.8936597 0.37150400 #> 784      6 7.668307 1.490157 -1.1195510 0.26290515 #> 785     10 7.668307 1.490157  1.5647299 0.11764625 #> 786      7 7.668307 1.490157 -0.4484808 0.65380626 #> 787      8 7.668307 1.490157  0.2225895 0.82385504 #> 788      9 7.668307 1.490157  0.8936597 0.37150400 #> 789     10 7.668307 1.490157  1.5647299 0.11764625 #> 790      5 7.668307 1.490157 -1.7906212 0.07335410 #> 791      9 7.668307 1.490157  0.8936597 0.37150400 #> 792      8 7.668307 1.490157  0.2225895 0.82385504 #> 793      8 7.668307 1.490157  0.2225895 0.82385504 #> 794      8 7.668307 1.490157  0.2225895 0.82385504 #> 795      7 7.668307 1.490157 -0.4484808 0.65380626 #> 796      7 7.668307 1.490157 -0.4484808 0.65380626 #> 797      6 7.668307 1.490157 -1.1195510 0.26290515 #> 798      8 7.668307 1.490157  0.2225895 0.82385504 #> 799      8 7.668307 1.490157  0.2225895 0.82385504 #> 800      9 7.668307 1.490157  0.8936597 0.37150400 #> 801      8 7.668307 1.490157  0.2225895 0.82385504 #> 802     10 7.668307 1.490157  1.5647299 0.11764625 #> 803      7 7.668307 1.490157 -0.4484808 0.65380626 #> 804      9 7.668307 1.490157  0.8936597 0.37150400 #> 805     10 7.668307 1.490157  1.5647299 0.11764625 #> 806      8 7.668307 1.490157  0.2225895 0.82385504 #> 807     10 7.668307 1.490157  1.5647299 0.11764625 #> 808      8 7.668307 1.490157  0.2225895 0.82385504 #> 809      7 7.668307 1.490157 -0.4484808 0.65380626 #> 810     10 7.668307 1.490157  1.5647299 0.11764625 #> 811     10 7.668307 1.490157  1.5647299 0.11764625 #> 812      9 7.668307 1.490157  0.8936597 0.37150400 #> 813      9 7.668307 1.490157  0.8936597 0.37150400 #> 814      5 7.668307 1.490157 -1.7906212 0.07335410 #> 815     10 7.668307 1.490157  1.5647299 0.11764625 #> 816     10 7.668307 1.490157  1.5647299 0.11764625 #> 817      9 7.668307 1.490157  0.8936597 0.37150400 #> 818     10 7.668307 1.490157  1.5647299 0.11764625 #> 819      9 7.668307 1.490157  0.8936597 0.37150400 #> 820      7 7.668307 1.490157 -0.4484808 0.65380626 #> 821      8 7.668307 1.490157  0.2225895 0.82385504 #> 822      7 7.668307 1.490157 -0.4484808 0.65380626 #> 823      6 7.668307 1.490157 -1.1195510 0.26290515 #> 824      5 7.668307 1.490157 -1.7906212 0.07335410 #> 825      7 7.668307 1.490157 -0.4484808 0.65380626 #> 826      7 7.668307 1.490157 -0.4484808 0.65380626 #> 827      9 7.668307 1.490157  0.8936597 0.37150400 #> 828      6 7.668307 1.490157 -1.1195510 0.26290515 #> 829      8 7.668307 1.490157  0.2225895 0.82385504 #> 830      9 7.668307 1.490157  0.8936597 0.37150400 #> 831      9 7.668307 1.490157  0.8936597 0.37150400 #> 832      9 7.668307 1.490157  0.8936597 0.37150400 #> 833      7 7.668307 1.490157 -0.4484808 0.65380626 #> 834      8 7.668307 1.490157  0.2225895 0.82385504 #> 835      8 7.668307 1.490157  0.2225895 0.82385504 #> 836      8 7.668307 1.490157  0.2225895 0.82385504 #> 837      9 7.668307 1.490157  0.8936597 0.37150400 #> 838      8 7.668307 1.490157  0.2225895 0.82385504 #> 839      8 7.668307 1.490157  0.2225895 0.82385504 #> 840      7 7.668307 1.490157 -0.4484808 0.65380626 #> 841      9 7.668307 1.490157  0.8936597 0.37150400 #> 842      9 7.668307 1.490157  0.8936597 0.37150400 #> 843      7 7.668307 1.490157 -0.4484808 0.65380626 #> 844     10 7.668307 1.490157  1.5647299 0.11764625 #> 845      9 7.668307 1.490157  0.8936597 0.37150400 #> 846      9 7.668307 1.490157  0.8936597 0.37150400 #> 847      9 7.668307 1.490157  0.8936597 0.37150400 #> 848      8 7.668307 1.490157  0.2225895 0.82385504 #> 849      5 7.668307 1.490157 -1.7906212 0.07335410 #> 850      9 7.668307 1.490157  0.8936597 0.37150400 #> 851     10 7.668307 1.490157  1.5647299 0.11764625 #> 852      8 7.668307 1.490157  0.2225895 0.82385504 #> 853      7 7.668307 1.490157 -0.4484808 0.65380626 #> 854     10 7.668307 1.490157  1.5647299 0.11764625 #> 855      7 7.668307 1.490157 -0.4484808 0.65380626 #> 856      9 7.668307 1.490157  0.8936597 0.37150400 #> 857      9 7.668307 1.490157  0.8936597 0.37150400 #> 858      7 7.668307 1.490157 -0.4484808 0.65380626 #> 859      8 7.668307 1.490157  0.2225895 0.82385504 #> 860     10 7.668307 1.490157  1.5647299 0.11764625 #> 861      8 7.668307 1.490157  0.2225895 0.82385504 #> 862      7 7.668307 1.490157 -0.4484808 0.65380626 #> 863      7 7.668307 1.490157 -0.4484808 0.65380626 #> 864      7 7.668307 1.490157 -0.4484808 0.65380626 #> 865      7 7.668307 1.490157 -0.4484808 0.65380626 #> 866      9 7.668307 1.490157  0.8936597 0.37150400 #> 867      6 7.668307 1.490157 -1.1195510 0.26290515 #> 868      8 7.668307 1.490157  0.2225895 0.82385504 #> 869      9 7.668307 1.490157  0.8936597 0.37150400 #> 870      8 7.668307 1.490157  0.2225895 0.82385504 #> 871      8 7.668307 1.490157  0.2225895 0.82385504 #> 872     10 7.668307 1.490157  1.5647299 0.11764625 #> 873      6 7.668307 1.490157 -1.1195510 0.26290515 #> 874      7 7.668307 1.490157 -0.4484808 0.65380626 #> 875      8 7.668307 1.490157  0.2225895 0.82385504 #> 876      8 7.668307 1.490157  0.2225895 0.82385504 #> 877      7 7.668307 1.490157 -0.4484808 0.65380626 plot(lsrq, sf = FastFood.sf, sig = 0.05) #> Warning: bounding box has potentially an invalid value range for longlat data  # }  # Case 3: With a sf object (poligons) library(lwgeom) fname <- system.file(\"shape/nc.shp\", package=\"sf\") nc <- sf::st_read(fname) #> Reading layer `nc' from data source  #>   `/home/runner/work/_temp/Library/sf/shape/nc.shp' using driver `ESRI Shapefile' #> Simple feature collection with 100 features and 14 fields #> Geometry type: MULTIPOLYGON #> Dimension:     XY #> Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965 #> Geodetic CRS:  NAD27 listw <- spdep::poly2nb(as(nc,\"Spatial\"), queen = FALSE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar p <- c(1/6,3/6,2/6) rho = 0.5 nc$fx <- dgp.spq(p = p, listw = listw, rho = rho) plot(nc[\"fx\"])  formula <- ~ fx lsrq <- local.sp.runs.test(formula = formula, data = nc, listw = listw) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data print(lsrq) #>     runs.i      E.i     Std.i     z.value     p.value #> 1        3 2.855152 0.8722689  0.16605945 0.868110166 #> 2        3 2.855152 0.8722689  0.16605945 0.868110166 #> 3        5 4.091919 1.1317511  0.80236794 0.422340153 #> 4        3 2.236768 0.7064182  1.08042568 0.279952664 #> 5        3 3.473535 1.0106752 -0.46853368 0.639402990 #> 6        3 2.855152 0.8722689  0.16605945 0.868110166 #> 7        3 2.855152 0.8722689  0.16605945 0.868110166 #> 8        5 4.091919 1.1317511  0.80236794 0.422340153 #> 9        3 3.473535 1.0106752 -0.46853368 0.639402990 #> 10       4 2.855152 0.8722689  1.31249497 0.189353181 #> 11       2 3.473535 1.0106752 -1.45797128 0.144848459 #> 12       2 3.473535 1.0106752 -1.45797128 0.144848459 #> 13       5 4.091919 1.1317511  0.80236794 0.422340153 #> 14       3 3.473535 1.0106752 -0.46853368 0.639402990 #> 15       4 2.855152 0.8722689  1.31249497 0.189353181 #> 16       5 4.710303 1.2405813  0.23351712 0.815359874 #> 17       3 2.855152 0.8722689  0.16605945 0.868110166 #> 18       7 5.947071 1.4323964  0.73508234 0.462289347 #> 19       5 3.473535 1.0106752  1.51034151 0.130956304 #> 20       3 2.855152 0.8722689  0.16605945 0.868110166 #> 21       2 2.236768 0.7064182 -0.33516646 0.737499518 #> 22       4 4.091919 1.1317511 -0.08121856 0.935268142 #> 23       3 4.091919 1.1317511 -0.96480505 0.334642465 #> 24       4 4.091919 1.1317511 -0.08121856 0.935268142 #> 25       4 4.710303 1.2405813 -0.57255663 0.566944931 #> 26       3 4.091919 1.1317511 -0.96480505 0.334642465 #> 27       5 4.710303 1.2405813  0.23351712 0.815359874 #> 28       5 4.091919 1.1317511  0.80236794 0.422340153 #> 29       4 4.091919 1.1317511 -0.08121856 0.935268142 #> 30       5 4.091919 1.1317511  0.80236794 0.422340153 #> 31       1 4.091919 1.1317511 -2.73197805 0.006295534 #> 32       4 2.855152 0.8722689  1.31249497 0.189353181 #> 33       2 4.091919 1.1317511 -1.84839155 0.064545720 #> 34       6 4.710303 1.2405813  1.03959088 0.298530015 #> 35       4 3.473535 1.0106752  0.52090392 0.602433708 #> 36       4 4.710303 1.2405813 -0.57255663 0.566944931 #> 37       5 4.710303 1.2405813  0.23351712 0.815359874 #> 38       3 2.855152 0.8722689  0.16605945 0.868110166 #> 39       7 6.565455 1.5186493  0.28613944 0.774771326 #> 40       1 4.091919 1.1317511 -2.73197805 0.006295534 #> 41       3 3.473535 1.0106752 -0.46853368 0.639402990 #> 42       4 4.710303 1.2405813 -0.57255663 0.566944931 #> 43       5 4.710303 1.2405813  0.23351712 0.815359874 #> 44       5 4.091919 1.1317511  0.80236794 0.422340153 #> 45       2 2.236768 0.7064182 -0.33516646 0.737499518 #> 46       6 4.710303 1.2405813  1.03959088 0.298530015 #> 47       6 4.710303 1.2405813  1.03959088 0.298530015 #> 48       5 5.947071 1.4323964 -0.66117921 0.508497395 #> 49       1 4.710303 1.2405813 -2.99077790 0.002782678 #> 50       4 4.091919 1.1317511 -0.08121856 0.935268142 #> 51       5 5.328687 1.3401523 -0.24526083 0.806254475 #> 52       5 4.091919 1.1317511  0.80236794 0.422340153 #> 53       5 4.710303 1.2405813  0.23351712 0.815359874 #> 54       5 4.710303 1.2405813  0.23351712 0.815359874 #> 55       6 4.091919 1.1317511  1.68595444 0.091804576 #> 56       1 2.236768 0.7064182 -1.75075861 0.079987499 #> 57       3 4.710303 1.2405813 -1.37863039 0.168008742 #> 58       5 3.473535 1.0106752  1.51034151 0.130956304 #> 59       1 3.473535 1.0106752 -2.44740888 0.014388750 #> 60       2 2.855152 0.8722689 -0.98037608 0.326900515 #> 61       5 4.710303 1.2405813  0.23351712 0.815359874 #> 62       3 4.710303 1.2405813 -1.37863039 0.168008742 #> 63       7 5.328687 1.3401523  1.24710688 0.212358312 #> 64       2 3.473535 1.0106752 -1.45797128 0.144848459 #> 65       4 4.091919 1.1317511 -0.08121856 0.935268142 #> 66       5 3.473535 1.0106752  1.51034151 0.130956304 #> 67       5 5.947071 1.4323964 -0.66117921 0.508497395 #> 68       3 4.091919 1.1317511 -0.96480505 0.334642465 #> 69       6 4.091919 1.1317511  1.68595444 0.091804576 #> 70       2 4.710303 1.2405813 -2.18470415 0.028910546 #> 71       3 4.091919 1.1317511 -0.96480505 0.334642465 #> 72       4 3.473535 1.0106752  0.52090392 0.602433708 #> 73       4 2.855152 0.8722689  1.31249497 0.189353181 #> 74       3 4.710303 1.2405813 -1.37863039 0.168008742 #> 75       3 2.855152 0.8722689  0.16605945 0.868110166 #> 76       2 2.855152 0.8722689 -0.98037608 0.326900515 #> 77       3 2.236768 0.7064182  1.08042568 0.279952664 #> 78       3 4.091919 1.1317511 -0.96480505 0.334642465 #> 79       5 5.328687 1.3401523 -0.24526083 0.806254475 #> 80       3 2.236768 0.7064182  1.08042568 0.279952664 #> 81       3 2.855152 0.8722689  0.16605945 0.868110166 #> 82       5 4.710303 1.2405813  0.23351712 0.815359874 #> 83       3 4.091919 1.1317511 -0.96480505 0.334642465 #> 84       3 3.473535 1.0106752 -0.46853368 0.639402990 #> 85       1 3.473535 1.0106752 -2.44740888 0.014388750 #> 86       2 3.473535 1.0106752 -1.45797128 0.144848459 #> 87       4 3.473535 1.0106752  0.52090392 0.602433708 #> 88       3 4.710303 1.2405813 -1.37863039 0.168008742 #> 89       1 3.473535 1.0106752 -2.44740888 0.014388750 #> 90       1 2.236768 0.7064182 -1.75075861 0.079987499 #> 91       3 4.710303 1.2405813 -1.37863039 0.168008742 #> 92       3 2.855152 0.8722689  0.16605945 0.868110166 #> 93       4 3.473535 1.0106752  0.52090392 0.602433708 #> 94       5 4.091919 1.1317511  0.80236794 0.422340153 #> 95       1 2.855152 0.8722689 -2.12681160 0.033435740 #> 96       4 4.091919 1.1317511 -0.08121856 0.935268142 #> 97       6 5.328687 1.3401523  0.50092302 0.616425301 #> 98       3 3.473535 1.0106752 -0.46853368 0.639402990 #> 99       1 2.236768 0.7064182 -1.75075861 0.079987499 #> 100      1 2.855152 0.8722689 -2.12681160 0.033435740 plot(lsrq, sf = nc)  # Version boot lsrq <- local.sp.runs.test(formula = formula, data = nc, listw = listw,                            distr =\"bootstrap\", nsim = 399) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data print(lsrq) #>     SRQ     EP.i     SdP.i zseudo.value pseudo.value #> 1     3 2.919799 0.8166508   0.09820660  0.921768240 #> 2     3 2.849624 0.8491460   0.17709080  0.859437065 #> 3     5 4.072682 1.0877253   0.85252987  0.393920070 #> 4     3 2.182957 0.7257713   1.12575765  0.260268114 #> 5     3 3.436090 1.0076595  -0.43277539  0.665177955 #> 6     3 2.857143 0.8400424   0.17005945  0.864963386 #> 7     3 2.781955 0.8967138   0.24316020  0.807881296 #> 8     5 4.160401 1.0863871   0.77283591  0.439619498 #> 9     3 3.508772 1.0096510  -0.50390869  0.614325546 #> 10    4 2.819549 0.8550875   1.38050328  0.167431741 #> 11    2 3.388471 1.0282284  -1.35035285  0.176902828 #> 12    2 3.538847 1.0139081  -1.51773820  0.129080411 #> 13    5 4.085213 1.1464417   0.79793589  0.424907694 #> 14    3 3.353383 1.0360014  -0.34110328  0.733025835 #> 15    4 2.776942 0.8982785   1.36155735  0.173337622 #> 16    5 4.729323 1.1996303   0.22563342  0.821486543 #> 17    3 2.794486 0.8870196   0.23169025  0.816778603 #> 18    7 6.000000 1.3431382   0.74452505  0.456558893 #> 19    5 3.516291 0.9637189   1.53956650  0.123666057 #> 20    3 2.889724 0.8038036   0.13719234  0.890878769 #> 21    2 2.233083 0.6749713  -0.34532242  0.729851996 #> 22    4 4.045113 1.1421438  -0.03949834  0.968493078 #> 23    3 4.070175 1.1275837  -0.94908738  0.342576171 #> 24    4 4.032581 1.0896688  -0.02990033  0.976146544 #> 25    4 4.694236 1.2468017  -0.55681316  0.577655088 #> 26    3 4.100251 1.1386208  -0.96630122  0.333893475 #> 27    5 4.679198 1.2729672   0.25201120  0.801032404 #> 28    5 4.057644 1.1666149   0.80776943  0.419223324 #> 29    4 4.067669 1.1355084  -0.05959373  0.952479216 #> 30    5 3.984962 1.1882060   0.85426059  0.392960619 #> 31    1 4.082707 1.1007885  -2.80045323  0.005103090 #> 32    4 2.847118 0.8905904   1.29451455  0.195487745 #> 33    2 4.102757 1.1127256  -1.88973538  0.058793360 #> 34    6 4.701754 1.2045858   1.07775267  0.281144147 #> 35    4 3.416040 1.0501703   0.55606210  0.578168403 #> 36    4 4.741855 1.1950600  -0.62076769  0.534752485 #> 37    5 4.671679 1.2641063   0.25972563  0.795075424 #> 38    3 2.807018 0.8884241   0.21721885  0.828037798 #> 39    7 6.596491 1.5137851   0.26655617  0.789810905 #> 40    1 4.165414 1.1017149  -2.87316949  0.004063760 #> 41    3 3.446115 0.9881096  -0.45148363  0.651641022 #> 42    4 4.669173 1.2444155  -0.53774076  0.590756035 #> 43    5 4.644110 1.2635831   0.28165121  0.778210967 #> 44    5 4.057644 1.1360628   0.82949279  0.406825616 #> 45    2 2.288221 0.7261356  -0.39692385  0.691423615 #> 46    6 4.709273 1.2157630   1.06165991  0.288390105 #> 47    6 4.694236 1.2923205   1.01040291  0.312302294 #> 48    5 6.062657 1.3537901  -0.78494932  0.432483281 #> 49    1 4.864662 1.1911438  -3.24449643  0.001176585 #> 50    4 4.120301 1.1210924  -0.10730672  0.914545650 #> 51    5 5.250627 1.3080129  -0.19160863  0.848048782 #> 52    5 4.125313 1.1602009   0.75390969  0.450903451 #> 53    5 4.754386 1.2236466   0.20072301  0.840915168 #> 54    5 4.759398 1.2018644   0.20019022  0.841331812 #> 55    6 3.972431 1.1869228   1.70825675  0.087588712 #> 56    1 2.218045 0.7264391  -1.67673398  0.093594513 #> 57    3 4.804511 1.2943168  -1.39418053  0.163263097 #> 58    5 3.448622 1.0182959   1.52350460  0.127632511 #> 59    1 3.418546 1.0310540  -2.34570302  0.018991233 #> 60    2 2.882206 0.8528163  -1.03446138  0.300920524 #> 61    5 4.796992 1.1825324   0.17167184  0.863695522 #> 62    3 4.724311 1.2397055  -1.39090351  0.164254689 #> 63    7 5.290727 1.3638142   1.25330355  0.210095255 #> 64    2 3.431078 1.0246395  -1.39666463  0.162514444 #> 65    4 4.117794 1.0411914  -0.11313432  0.909924063 #> 66    5 3.458647 1.0261256   1.50210979  0.133068756 #> 67    5 5.944862 1.4586314  -0.64777310  0.517131718 #> 68    3 4.042607 1.0445788  -0.99811185  0.318225124 #> 69    6 4.157895 1.1016806   1.67208655  0.094507257 #> 70    2 4.674185 1.2457406  -2.14666318  0.031820106 #> 71    3 4.030075 1.1136872  -0.92492323  0.355005842 #> 72    4 3.471178 0.9815107   0.53878381  0.590036036 #> 73    4 2.889724 0.8784807   1.26385896  0.206280653 #> 74    3 4.739348 1.2729227  -1.36642103  0.171806851 #> 75    3 2.807018 0.8299367   0.23252673  0.816128929 #> 76    2 2.872180 0.8775268  -0.99390749  0.320267909 #> 77    3 2.225564 0.6976256   1.11010268  0.266954781 #> 78    3 4.112782 1.0912222  -1.01975745  0.307843507 #> 79    5 5.280702 1.3750847  -0.20413416  0.838248658 #> 80    3 2.190476 0.7255630   1.11571808  0.264542828 #> 81    3 2.909774 0.8721715   0.10344934  0.917606356 #> 82    5 4.749373 1.2490573   0.20065258  0.840970240 #> 83    3 4.067669 1.0694160  -0.99836656  0.318101643 #> 84    3 3.446115 1.0804237  -0.41290774  0.679674211 #> 85    1 3.466165 1.0858769  -2.27112790  0.023139236 #> 86    2 3.478697 0.9893515  -1.49461212  0.135015701 #> 87    4 3.438596 1.0373013   0.54121546  0.588359080 #> 88    3 4.659148 1.2274541  -1.35169854  0.176471773 #> 89    1 3.446115 1.0255425  -2.38519157  0.017070229 #> 90    1 2.243108 0.6971200  -1.78320494  0.074552948 #> 91    3 4.656642 1.2318633  -1.34482585  0.178681481 #> 92    3 2.817043 0.8848872   0.20675786  0.836198964 #> 93    4 3.453634 1.0405017   0.52509853  0.599514698 #> 94    5 4.135338 1.1415978   0.75741356  0.448802137 #> 95    1 2.892231 0.8511977  -2.22302133  0.026214362 #> 96    4 4.230576 1.1306455  -0.20393346  0.838405501 #> 97    6 5.360902 1.3617441   0.46932295  0.638838814 #> 98    3 3.556391 0.9543358  -0.58301385  0.559883979 #> 99    1 2.260652 0.6475548  -1.94678758  0.051560207 #> 100   1 2.859649 0.8389697  -2.21658664  0.026651351 plot(lsrq, sf = nc)   # Case 4: With isolated areas library(lwgeom) data(provinces_spain) listw <- spdep::poly2nb(as(provinces_spain,\"Spatial\"), queen = FALSE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") plot(provinces_spain[\"Male2Female\"])  formula <- ~ Male2Female lsrq <- local.sp.runs.test(formula = formula, data = provinces_spain, listw = listw) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data print(lsrq) #>    runs.i      E.i     Std.i     z.value    p.value #> 1       3 2.963265 1.2181954  0.03015501 0.97594343 #> 2       3 3.748571 1.4356803 -0.52140538 0.60208441 #> 3       3 2.177959 0.9361800  0.87807987 0.37990038 #> 4       3 1.785306 0.7491685  1.62138936 0.10493416 #> 5       4 3.355918 1.3328119  0.48325020 0.62891810 #> 6       3 3.355918 1.3328119 -0.26704320 0.78943590 #> 7       0 1.000000       NaN         NaN        NaN #> 8       3 2.177959 0.9361800  0.87807987 0.37990038 #> 9       4 4.141224 1.5291733 -0.09235349 0.92641719 #> 10      2 2.570612 1.0881246 -0.52439971 0.60000056 #> 11      1 2.177959 0.9361800 -1.25826142 0.20829723 #> 12      3 2.177959 0.9361800  0.87807987 0.37990038 #> 13      5 3.355918 1.3328119  1.23354359 0.21737302 #> 14      1 3.355918 1.3328119 -1.76762999 0.07712278 #> 15      1 1.785306 0.7491685 -1.04823694 0.29452945 #> 16      5 3.748571 1.4356803  0.87166242 0.38339257 #> 17      2 1.785306 0.7491685  0.28657621 0.77443683 #> 18      5 3.355918 1.3328119  1.23354359 0.21737302 #> 19      5 3.355918 1.3328119  1.23354359 0.21737302 #> 20      1 2.177959 0.9361800 -1.25826142 0.20829723 #> 21      2 2.177959 0.9361800 -0.19009078 0.84923800 #> 22      1 2.570612 1.0881246 -1.44341209 0.14890442 #> 23      1 3.748571 1.4356803 -1.91447317 0.05555972 #> 24      4 2.963265 1.2181954  0.85104136 0.39474638 #> 25      5 2.963265 1.2181954  1.67192771 0.09453858 #> 26      1 2.963265 1.2181954 -1.61161769 0.10704516 #> 27      2 2.963265 1.2181954 -0.79073134 0.42910078 #> 28      1 2.570612 1.0881246 -1.44341209 0.14890442 #> 29      4 2.570612 1.0881246  1.31362503 0.18897242 #> 30      2 2.963265 1.2181954 -0.79073134 0.42910078 #> 31      1 2.570612 1.0881246 -1.44341209 0.14890442 #> 32      1 2.177959 0.9361800 -1.25826142 0.20829723 #> 33      3 2.570612 1.0881246  0.39461266 0.69312877 #> 34      0 1.000000       NaN         NaN        NaN #> 35      1 2.177959 0.9361800 -1.25826142 0.20829723 #> 36      3 2.570612 1.0881246  0.39461266 0.69312877 #> 37      0 1.000000       NaN         NaN        NaN #> 38      3 2.963265 1.2181954  0.03015501 0.97594343 #> 39      3 3.355918 1.3328119 -0.26704320 0.78943590 #> 40      1 2.963265 1.2181954 -1.61161769 0.10704516 #> 41      5 2.963265 1.2181954  1.67192771 0.09453858 #> 42      5 3.355918 1.3328119  1.23354359 0.21737302 #> 43      4 3.355918 1.3328119  0.48325020 0.62891810 #> 44      4 2.963265 1.2181954  0.85104136 0.39474638 #> 45      5 3.748571 1.4356803  0.87166242 0.38339257 #> 46      3 2.570612 1.0881246  0.39461266 0.69312877 #> 47      1 2.570612 1.0881246 -1.44341209 0.14890442 #> 48      8 4.141224 1.5291733  2.52343903 0.01162132 #> 49      5 2.963265 1.2181954  1.67192771 0.09453858 #> 50      1 2.177959 0.9361800 -1.25826142 0.20829723 plot(lsrq, sf = provinces_spain, sig = 0.1)   # Boots Version lsrq <- local.sp.runs.test(formula = formula, data = provinces_spain, listw = listw,                            distr =\"bootstrap\", nsim = 199) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data print(lsrq) #>    SRQ     EP.i     SdP.i zseudo.value pseudo.value #> 1    3 2.904523 1.2333455   0.07741334   0.93829473 #> 2    3 3.748744 1.3696516  -0.54666730   0.58460732 #> 3    3 2.120603 0.9241582   0.95156545   0.34131741 #> 4    3 1.768844 0.7432077   1.65654326   0.09761185 #> 5    4 3.296482 1.2900308   0.54534945   0.58551320 #> 6    3 3.487437 1.2667436  -0.38479546   0.70038896 #> 7    0 0.000000 0.0000000          NaN          NaN #> 8    3 2.266332 0.9125512   0.80397503   0.42141140 #> 9    4 4.160804 1.5256300  -0.10540172   0.91605705 #> 10   2 2.623116 1.1297932  -0.55153065   0.58126996 #> 11   1 2.261307 0.9385462  -1.34389390   0.17898270 #> 12   3 2.211055 1.0128859   0.77890782   0.43603401 #> 13   5 3.467337 1.3362424   1.14699493   0.25138372 #> 14   1 3.457286 1.2897947  -1.90517640   0.05675714 #> 15   1 1.723618 0.7170330  -1.00918379   0.31288650 #> 16   5 3.814070 1.4179951   0.83634255   0.40296222 #> 17   2 1.824121 0.7681942   0.22895174   0.81890643 #> 18   5 3.195980 1.2700051   1.42048252   0.15546725 #> 19   5 3.552764 1.4688620   0.98527719   0.32448793 #> 20   1 2.221106 0.9163811  -1.33253024   0.18268601 #> 21   2 2.100503 0.8989049  -0.11180550   0.91097763 #> 22   1 2.567839 1.0797357  -1.45205833   0.14648539 #> 23   1 3.839196 1.5189947  -1.86912834   0.06160496 #> 24   4 3.005025 1.1827783   0.84121840   0.40022559 #> 25   5 2.919598 1.2364693   1.68253426   0.09246529 #> 26   1 2.869347 1.1472475  -1.62941887   0.10322438 #> 27   2 3.030151 1.2427956  -0.82889798   0.40716214 #> 28   1 2.633166 1.1464066  -1.42459567   0.15427411 #> 29   4 2.452261 1.0132867   1.52744402   0.12665064 #> 30   2 3.035176 1.2406291  -0.83439597   0.40405789 #> 31   1 2.603015 1.0580098  -1.51512304   0.12974125 #> 32   1 2.110553 0.9308621  -1.19303683   0.23285495 #> 33   3 2.547739 1.0232067   0.44200386   0.65848641 #> 34   0 0.000000 0.0000000          NaN          NaN #> 35   1 2.125628 0.8985378  -1.25273320   0.21030282 #> 36   3 2.587940 1.1595259   0.35536964   0.72231269 #> 37   0 0.000000 0.0000000          NaN          NaN #> 38   3 2.864322 1.2499226   0.10854944   0.91355987 #> 39   3 3.417085 1.4431691  -0.28900663   0.77257630 #> 40   1 2.974874 1.1825208  -1.67005468   0.09490855 #> 41   5 2.934673 1.1852433   1.74253384   0.08141508 #> 42   5 3.351759 1.3768961   1.19707015   0.23127922 #> 43   4 3.452261 1.3013134   0.42091220   0.67381919 #> 44   4 2.974874 1.1739478   0.87322932   0.38253809 #> 45   5 3.944724 1.4536474   0.72595073   0.46786897 #> 46   3 2.648241 1.1750282   0.29936199   0.76466386 #> 47   1 2.497487 1.0292410  -1.45494340   0.14568493 #> 48   8 4.130653 1.5995628   2.41900273   0.01556312 #> 49   5 2.984925 1.2491508   1.61315625   0.10671056 #> 50   1 2.251256 0.9832876  -1.27252322   0.20318728 plot(lsrq, sf = provinces_spain, sig = 0.10)   # Case 5: SRQ test based on a distance matrix (inverse distance) # \\donttest{ library(lwgeom) N <- 100 cx <- runif(N) cy <- runif(N) coor <- as.data.frame(cbind(cx,cy)) coor <- sf::st_as_sf(coor,coords = c(\"cx\",\"cy\")) n = dim(coor)[1] dis <- 1/matrix(as.numeric(sf::st_distance(coor,coor)), ncol = n, nrow = n) diag(dis) <- 0 dis <- (dis < quantile(dis,.10))*dis p <- c(1/6,3/6,2/6) rho <- 0.5 fx <- dgp.spq(p = p, listw = dis, rho = rho) lsrq <- local.sp.runs.test(fx = fx, listw = dis) print(lsrq) #>     runs.i       E.i     Std.i     z.value    p.value #> 1        2  2.855152 0.8722689 -0.98037608 0.32690051 #> 2        5  4.091919 1.1317511  0.80236794 0.42234015 #> 3        4  3.473535 1.0106752  0.52090392 0.60243371 #> 4        4  3.473535 1.0106752  0.52090392 0.60243371 #> 5       17 14.604444 2.3462098  1.02103210 0.30723923 #> 6       14 14.604444 2.3462098 -0.25762591 0.79669563 #> 7       19 22.643434 2.9150932 -1.24985177 0.21135370 #> 8        3  2.236768 0.7064182  1.08042568 0.27995266 #> 9        3  3.473535 1.0106752 -0.46853368 0.63940299 #> 10       0  1.000000       NaN         NaN        NaN #> 11      17 22.025051 2.8765991 -1.74687204 0.08065954 #> 12       0  1.000000       NaN         NaN        NaN #> 13       9 10.275758 1.9514092 -0.65376220 0.51326502 #> 14       0  1.000000       NaN         NaN        NaN #> 15       0  1.000000       NaN         NaN        NaN #> 16       0  1.000000       NaN         NaN        NaN #> 17       6  5.328687 1.3401523  0.50092302 0.61642530 #> 18       4  3.473535 1.0106752  0.52090392 0.60243371 #> 19      16 17.696364 2.5846046 -0.65633392 0.51160930 #> 20       2  2.855152 0.8722689 -0.98037608 0.32690051 #> 21       4  3.473535 1.0106752  0.52090392 0.60243371 #> 22       3  2.236768 0.7064182  1.08042568 0.27995266 #> 23      30 23.261818 2.9528798  2.28190184 0.02249514 #> 24       8  7.183838 1.5998803  0.51013918 0.60995396 #> 25       9 10.275758 1.9514092 -0.65376220 0.51326502 #> 26       0  1.000000       NaN         NaN        NaN #> 27       4  3.473535 1.0106752  0.52090392 0.60243371 #> 28       1  2.236768 0.7064182 -1.75075861 0.07998750 #> 29       0  1.000000       NaN         NaN        NaN #> 30      25 24.498586 3.0264361  0.16567808 0.86841029 #> 31       2  2.236768 0.7064182 -0.33516646 0.73749952 #> 32       4  4.091919 1.1317511 -0.08121856 0.93526814 #> 33       4  2.855152 0.8722689  1.31249497 0.18935318 #> 34       9  9.038990 1.8199699 -0.02142338 0.98290793 #> 35       4  3.473535 1.0106752  0.52090392 0.60243371 #> 36       6  7.183838 1.5998803 -0.73995436 0.45932769 #> 37       9  8.420606 1.7500327  0.33107607 0.74058703 #> 38       3  2.855152 0.8722689  0.16605945 0.86811017 #> 39       0  1.000000       NaN         NaN        NaN #> 40       4  3.473535 1.0106752  0.52090392 0.60243371 #> 41       1  1.618384 0.4857831 -1.27296272 0.20303127 #> 42       9  9.038990 1.8199699 -0.02142338 0.98290793 #> 43       9  6.565455 1.5186493  1.60309920 0.10891276 #> 44      12  9.038990 1.8199699  1.62695551 0.10374655 #> 45       3  2.236768 0.7064182  1.08042568 0.27995266 #> 46       3  2.855152 0.8722689  0.16605945 0.86811017 #> 47       8  6.565455 1.5186493  0.94461932 0.34485326 #> 48       9  7.183838 1.5998803  1.13518595 0.25629741 #> 49      11 10.275758 1.9514092  0.37113816 0.71053463 #> 50       8  7.802222 1.6768193  0.11794817 0.90610872 #> 51       5  3.473535 1.0106752  1.51034151 0.13095630 #> 52       5  6.565455 1.5186493 -1.03082032 0.30262509 #> 53       5  4.710303 1.2405813  0.23351712 0.81535987 #> 54       9  9.657374 1.8869954 -0.34837061 0.72756187 #> 55       7  7.802222 1.6768193 -0.47841899 0.63235202 #> 56       2  2.236768 0.7064182 -0.33516646 0.73749952 #> 57       5  4.091919 1.1317511  0.80236794 0.42234015 #> 58       0  1.000000       NaN         NaN        NaN #> 59       0  1.000000       NaN         NaN        NaN #> 60       5  5.328687 1.3401523 -0.24526083 0.80625447 #> 61       8  8.420606 1.7500327 -0.24034183 0.81006527 #> 62       9  7.802222 1.6768193  0.71431534 0.47503221 #> 63       0  1.000000       NaN         NaN        NaN #> 64      14 11.512525 2.0733657  1.19972796 0.23024501 #> 65      10 10.894141 2.0134619 -0.44408161 0.65698359 #> 66      12 10.275758 1.9514092  0.88358834 0.37691847 #> 67       0  1.000000       NaN         NaN        NaN #> 68       5  5.328687 1.3401523 -0.24526083 0.80625447 #> 69       0  1.000000       NaN         NaN        NaN #> 70       4  3.473535 1.0106752  0.52090392 0.60243371 #> 71       8  9.657374 1.8869954 -0.87831360 0.37977356 #> 72       4  3.473535 1.0106752  0.52090392 0.60243371 #> 73       1  2.236768 0.7064182 -1.75075861 0.07998750 #> 74       1  2.855152 0.8722689 -2.12681160 0.03343574 #> 75      15 16.459596 2.4927161 -0.58554439 0.55818172 #> 76       5  6.565455 1.5186493 -1.03082032 0.30262509 #> 77       5  3.473535 1.0106752  1.51034151 0.13095630 #> 78      18 20.788283 2.7973712 -0.99675111 0.31888533 #> 79       8  5.947071 1.4323964  1.43321312 0.15179694 #> 80       4  2.855152 0.8722689  1.31249497 0.18935318 #> 81       9  7.802222 1.6768193  0.71431534 0.47503221 #> 82      14 12.749293 2.1874260  0.57177115 0.56747702 #> 83       0  1.000000       NaN         NaN        NaN #> 84       5  4.091919 1.1317511  0.80236794 0.42234015 #> 85      16 17.696364 2.5846046 -0.65633392 0.51160930 #> 86       6  7.183838 1.5998803 -0.73995436 0.45932769 #> 87       5  4.091919 1.1317511  0.80236794 0.42234015 #> 88       0  1.000000       NaN         NaN        NaN #> 89       0  1.000000       NaN         NaN        NaN #> 90       4  3.473535 1.0106752  0.52090392 0.60243371 #> 91       1  1.618384 0.4857831 -1.27296272 0.20303127 #> 92      11 11.512525 2.0733657 -0.24719482 0.80475745 #> 93      18 17.696364 2.5846046  0.11747885 0.90648061 #> 94       7  6.565455 1.5186493  0.28613944 0.77477133 #> 95       6  6.565455 1.5186493 -0.37234044 0.70963939 #> 96       2  2.855152 0.8722689 -0.98037608 0.32690051 #> 97      14 15.841212 2.4451048 -0.75301970 0.45143807 #> 98      24 21.406667 2.8373687  0.91399235 0.36072086 #> 99       6  5.947071 1.4323964  0.03695157 0.97052362 #> 100      0  1.000000       NaN         NaN        NaN plot(lsrq, coor = cbind(cx,cy), sig = 0.05)  lsrq <- local.sp.runs.test(fx = fx, listw = dis, data = ) print(lsrq) #>     runs.i       E.i     Std.i     z.value    p.value #> 1        2  2.855152 0.8722689 -0.98037608 0.32690051 #> 2        5  4.091919 1.1317511  0.80236794 0.42234015 #> 3        4  3.473535 1.0106752  0.52090392 0.60243371 #> 4        4  3.473535 1.0106752  0.52090392 0.60243371 #> 5       17 14.604444 2.3462098  1.02103210 0.30723923 #> 6       14 14.604444 2.3462098 -0.25762591 0.79669563 #> 7       19 22.643434 2.9150932 -1.24985177 0.21135370 #> 8        3  2.236768 0.7064182  1.08042568 0.27995266 #> 9        3  3.473535 1.0106752 -0.46853368 0.63940299 #> 10       0  1.000000       NaN         NaN        NaN #> 11      17 22.025051 2.8765991 -1.74687204 0.08065954 #> 12       0  1.000000       NaN         NaN        NaN #> 13       9 10.275758 1.9514092 -0.65376220 0.51326502 #> 14       0  1.000000       NaN         NaN        NaN #> 15       0  1.000000       NaN         NaN        NaN #> 16       0  1.000000       NaN         NaN        NaN #> 17       6  5.328687 1.3401523  0.50092302 0.61642530 #> 18       4  3.473535 1.0106752  0.52090392 0.60243371 #> 19      16 17.696364 2.5846046 -0.65633392 0.51160930 #> 20       2  2.855152 0.8722689 -0.98037608 0.32690051 #> 21       4  3.473535 1.0106752  0.52090392 0.60243371 #> 22       3  2.236768 0.7064182  1.08042568 0.27995266 #> 23      30 23.261818 2.9528798  2.28190184 0.02249514 #> 24       8  7.183838 1.5998803  0.51013918 0.60995396 #> 25       9 10.275758 1.9514092 -0.65376220 0.51326502 #> 26       0  1.000000       NaN         NaN        NaN #> 27       4  3.473535 1.0106752  0.52090392 0.60243371 #> 28       1  2.236768 0.7064182 -1.75075861 0.07998750 #> 29       0  1.000000       NaN         NaN        NaN #> 30      25 24.498586 3.0264361  0.16567808 0.86841029 #> 31       2  2.236768 0.7064182 -0.33516646 0.73749952 #> 32       4  4.091919 1.1317511 -0.08121856 0.93526814 #> 33       4  2.855152 0.8722689  1.31249497 0.18935318 #> 34       9  9.038990 1.8199699 -0.02142338 0.98290793 #> 35       4  3.473535 1.0106752  0.52090392 0.60243371 #> 36       6  7.183838 1.5998803 -0.73995436 0.45932769 #> 37       9  8.420606 1.7500327  0.33107607 0.74058703 #> 38       3  2.855152 0.8722689  0.16605945 0.86811017 #> 39       0  1.000000       NaN         NaN        NaN #> 40       4  3.473535 1.0106752  0.52090392 0.60243371 #> 41       1  1.618384 0.4857831 -1.27296272 0.20303127 #> 42       9  9.038990 1.8199699 -0.02142338 0.98290793 #> 43       9  6.565455 1.5186493  1.60309920 0.10891276 #> 44      12  9.038990 1.8199699  1.62695551 0.10374655 #> 45       3  2.236768 0.7064182  1.08042568 0.27995266 #> 46       3  2.855152 0.8722689  0.16605945 0.86811017 #> 47       8  6.565455 1.5186493  0.94461932 0.34485326 #> 48       9  7.183838 1.5998803  1.13518595 0.25629741 #> 49      11 10.275758 1.9514092  0.37113816 0.71053463 #> 50       8  7.802222 1.6768193  0.11794817 0.90610872 #> 51       5  3.473535 1.0106752  1.51034151 0.13095630 #> 52       5  6.565455 1.5186493 -1.03082032 0.30262509 #> 53       5  4.710303 1.2405813  0.23351712 0.81535987 #> 54       9  9.657374 1.8869954 -0.34837061 0.72756187 #> 55       7  7.802222 1.6768193 -0.47841899 0.63235202 #> 56       2  2.236768 0.7064182 -0.33516646 0.73749952 #> 57       5  4.091919 1.1317511  0.80236794 0.42234015 #> 58       0  1.000000       NaN         NaN        NaN #> 59       0  1.000000       NaN         NaN        NaN #> 60       5  5.328687 1.3401523 -0.24526083 0.80625447 #> 61       8  8.420606 1.7500327 -0.24034183 0.81006527 #> 62       9  7.802222 1.6768193  0.71431534 0.47503221 #> 63       0  1.000000       NaN         NaN        NaN #> 64      14 11.512525 2.0733657  1.19972796 0.23024501 #> 65      10 10.894141 2.0134619 -0.44408161 0.65698359 #> 66      12 10.275758 1.9514092  0.88358834 0.37691847 #> 67       0  1.000000       NaN         NaN        NaN #> 68       5  5.328687 1.3401523 -0.24526083 0.80625447 #> 69       0  1.000000       NaN         NaN        NaN #> 70       4  3.473535 1.0106752  0.52090392 0.60243371 #> 71       8  9.657374 1.8869954 -0.87831360 0.37977356 #> 72       4  3.473535 1.0106752  0.52090392 0.60243371 #> 73       1  2.236768 0.7064182 -1.75075861 0.07998750 #> 74       1  2.855152 0.8722689 -2.12681160 0.03343574 #> 75      15 16.459596 2.4927161 -0.58554439 0.55818172 #> 76       5  6.565455 1.5186493 -1.03082032 0.30262509 #> 77       5  3.473535 1.0106752  1.51034151 0.13095630 #> 78      18 20.788283 2.7973712 -0.99675111 0.31888533 #> 79       8  5.947071 1.4323964  1.43321312 0.15179694 #> 80       4  2.855152 0.8722689  1.31249497 0.18935318 #> 81       9  7.802222 1.6768193  0.71431534 0.47503221 #> 82      14 12.749293 2.1874260  0.57177115 0.56747702 #> 83       0  1.000000       NaN         NaN        NaN #> 84       5  4.091919 1.1317511  0.80236794 0.42234015 #> 85      16 17.696364 2.5846046 -0.65633392 0.51160930 #> 86       6  7.183838 1.5998803 -0.73995436 0.45932769 #> 87       5  4.091919 1.1317511  0.80236794 0.42234015 #> 88       0  1.000000       NaN         NaN        NaN #> 89       0  1.000000       NaN         NaN        NaN #> 90       4  3.473535 1.0106752  0.52090392 0.60243371 #> 91       1  1.618384 0.4857831 -1.27296272 0.20303127 #> 92      11 11.512525 2.0733657 -0.24719482 0.80475745 #> 93      18 17.696364 2.5846046  0.11747885 0.90648061 #> 94       7  6.565455 1.5186493  0.28613944 0.77477133 #> 95       6  6.565455 1.5186493 -0.37234044 0.70963939 #> 96       2  2.855152 0.8722689 -0.98037608 0.32690051 #> 97      14 15.841212 2.4451048 -0.75301970 0.45143807 #> 98      24 21.406667 2.8373687  0.91399235 0.36072086 #> 99       6  5.947071 1.4323964  0.03695157 0.97052362 #> 100      0  1.000000       NaN         NaN        NaN plot(lsrq, sf = coor)  # Version boots lsrq <- local.sp.runs.test(fx = fx, listw = dis, data = coor,                            distr =\"bootstrap\", nsim = 299) print(lsrq) #>     SRQ      EP.i     SdP.i zseudo.value pseudo.value #> 1     2  2.849498 0.8399174  -1.01140705   0.31182165 #> 2     5  4.086957 1.1952635   0.76388469   0.44493596 #> 3     4  3.484950 0.9910375   0.51970806   0.60326707 #> 4     4  3.501672 0.9945306   0.50106829   0.61632306 #> 5    17 14.759197 2.3030926   0.97295378   0.33057627 #> 6    14 14.585284 2.3804117  -0.24587523   0.80577882 #> 7    19 22.729097 2.9028202  -1.28464620   0.19891594 #> 8     3  2.277592 0.6901995   1.04666549   0.29525389 #> 9     3  3.464883 1.0139650  -0.45848026   0.64660744 #> 10    0  0.000000 0.0000000          NaN          NaN #> 11   17 22.053512 2.8947672  -1.74574027   0.08085609 #> 12    0  0.000000 0.0000000          NaN          NaN #> 13    9 10.451505 1.8245592  -0.79553737   0.42630098 #> 14    0  0.000000 0.0000000          NaN          NaN #> 15    0  0.000000 0.0000000          NaN          NaN #> 16    0  0.000000 0.0000000          NaN          NaN #> 17    6  5.334448 1.3368238   0.49786055   0.61858234 #> 18    4  3.498328 1.0012562   0.50104283   0.61634098 #> 19   16 17.652174 2.5526839  -0.64723013   0.51748301 #> 20    2  2.879599 0.8585643  -1.02449941   0.30559945 #> 21    4  3.468227 0.9735567   0.54621635   0.58491723 #> 22    3  2.230769 0.7306266   1.05283712   0.29241565 #> 23   30 23.301003 3.0294470   2.21129354   0.02701552 #> 24    8  7.207358 1.6355364   0.48463743   0.62793356 #> 25    9 10.274247 1.8676976  -0.68225579   0.49507723 #> 26    0  0.000000 0.0000000          NaN          NaN #> 27    4  3.444816 1.0196714   0.54447340   0.58611575 #> 28    1  2.180602 0.7558441  -1.56196496   0.11829624 #> 29    0  0.000000 0.0000000          NaN          NaN #> 30   25 24.665552 3.2966096   0.10145216   0.91919153 #> 31    2  2.297659 0.6915316  -0.43043421   0.66687982 #> 32    4  4.096990 1.1617322  -0.08348737   0.93346402 #> 33    4  2.953177 0.8381517   1.24896573   0.21167761 #> 34    9  8.859532 1.8153894   0.07737636   0.93832415 #> 35    4  3.474916 0.9806207   0.53546044   0.59233150 #> 36    6  7.270903 1.5337991  -0.82859807   0.40733188 #> 37    9  8.525084 1.7499395   0.27139018   0.78609095 #> 38    3  2.856187 0.8800855   0.16340765   0.87019748 #> 39    0  0.000000 0.0000000          NaN          NaN #> 40    4  3.484950 0.9600795   0.53646618   0.59163640 #> 41    1  1.591973 0.4922920  -1.20248386   0.22917612 #> 42    9  8.926421 1.7933334   0.04102896   0.96727281 #> 43    9  6.729097 1.4366451   1.58069866   0.11394695 #> 44   12  9.123746 1.6952573   1.69664757   0.08976331 #> 45    3  2.270903 0.7119706   1.02405484   0.30580937 #> 46    3  2.886288 0.8749569   0.12996340   0.89659538 #> 47    8  6.357860 1.3618841   1.20578577   0.22790010 #> 48    9  7.267559 1.4684550   1.17977157   0.23809108 #> 49   11 10.244147 1.8977002   0.39829940   0.69040950 #> 50    8  7.739130 1.6665402   0.15653362   0.87561242 #> 51    5  3.551839 1.0329252   1.40199939   0.16091543 #> 52    5  6.628763 1.5476684  -1.05239765   0.29261714 #> 53    5  4.655518 1.2281901   0.28047905   0.77910999 #> 54    9  9.822742 1.8075210  -0.45517728   0.64898171 #> 55    7  7.658863 1.6211728  -0.40641125   0.68444046 #> 56    2  2.301003 0.7256326  -0.41481510   0.67827726 #> 57    5  4.173913 1.1800303   0.70005571   0.48389252 #> 58    0  0.000000 0.0000000          NaN          NaN #> 59    0  0.000000 0.0000000          NaN          NaN #> 60    5  5.331104 1.3538669  -0.24456148   0.80679600 #> 61    8  8.394649 1.6193373  -0.24371009   0.80745536 #> 62    9  7.816054 1.5894819   0.74486313   0.45635447 #> 63    0  0.000000 0.0000000          NaN          NaN #> 64   14 11.688963 1.9559525   1.18154033   0.23738814 #> 65   10 11.100334 1.9772107  -0.55650843   0.57786333 #> 66   12 10.197324 2.0459141   0.88111009   0.37825824 #> 67    0  0.000000 0.0000000          NaN          NaN #> 68    5  5.374582 1.3855036  -0.27035797   0.78688487 #> 69    0  0.000000 0.0000000          NaN          NaN #> 70    4  3.481605 0.9773420   0.53041273   0.59582580 #> 71    8  9.802676 1.7507025  -1.02968699   0.30315697 #> 72    4  3.628763 0.9620180   0.38589450   0.69957481 #> 73    1  2.250836 0.7422695  -1.68515082   0.09195948 #> 74    1  2.846154 0.8687781  -2.12500039   0.03358658 #> 75   15 16.605351 2.3065645  -0.69599232   0.48643364 #> 76    5  6.575251 1.5228207  -1.03442965   0.30093535 #> 77    5  3.488294 1.0211012   1.48046601   0.13874893 #> 78   18 20.715719 2.7458548  -0.98902501   0.32265090 #> 79    8  5.913043 1.4257214   1.46378981   0.14325139 #> 80    4  2.926421 0.7823156   1.37230883   0.16996732 #> 81    9  7.896321 1.6525209   0.66787593   0.50421280 #> 82   14 12.528428 2.1616769   0.68075480   0.49602665 #> 83    0  0.000000 0.0000000          NaN          NaN #> 84    5  4.076923 1.0825504   0.85268726   0.39383276 #> 85   16 17.555184 2.7206885  -0.57161412   0.56758343 #> 86    6  7.237458 1.5262144  -0.81080233   0.41747920 #> 87    5  4.063545 1.2148309   0.77085199   0.44079467 #> 88    0  0.000000 0.0000000          NaN          NaN #> 89    0  0.000000 0.0000000          NaN          NaN #> 90    4  3.434783 1.0190769   0.55463666   0.57914321 #> 91    1  1.622074 0.4856820  -1.28082498   0.20025515 #> 92   11 11.628763 2.0380546  -0.30851114   0.75769343 #> 93   18 17.692308 2.6858393   0.11456095   0.90879313 #> 94    7  6.732441 1.5354812   0.17425061   0.86166851 #> 95    6  6.762542 1.4402419  -0.52945396   0.59649057 #> 96    2  2.859532 0.8901028  -0.96565449   0.33421710 #> 97   14 16.053512 2.4502731  -0.83807462   0.40198880 #> 98   24 21.254181 2.8735558   0.95554761   0.33930084 #> 99    6  6.127090 1.3844420  -0.09179893   0.92685779 #> 100   0  0.000000 0.0000000          NaN          NaN plot(lsrq, sf = coor)   # SRQ test based on inverse distance library(lwgeom) data(\"FastFood.sf\") sf::sf_use_s2(FALSE) n = dim(FastFood.sf)[1] dis <- 1000000/matrix(as.numeric(           sf::st_distance(FastFood.sf, FastFood.sf)),           ncol = n, nrow = n) #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: bounding box has potentially an invalid value range for longlat data diag(dis) <- 0 dis <- (dis < quantile(dis,.01))*dis formula <- ~ Type lsrq <- local.sp.runs.test(formula = formula, data = FastFood.sf, listw = dis) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: st_centroid does not give correct centroids for longitude/latitude data print(lsrq) #>     runs.i       E.i      Std.i       z.value     p.value #> 1        8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 2        2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 3        3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 4        8  6.334645 1.33284778  1.249471e+00 0.211492867 #> 5        6  7.001476 1.41369228 -7.084116e-01 0.478689660 #> 6        5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 7        5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 8        5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 9        8 11.669291 1.88488922 -1.946688e+00 0.051572177 #> 10      16 22.338582 2.66558409 -2.377933e+00 0.017409967 #> 11      26 21.004920 2.58094570  1.935368e+00 0.052945152 #> 12       3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 13       1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 14       1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 15       3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 16       2  3.667323 0.94250012 -1.769042e+00 0.076886794 #> 17       4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 18       7  7.001476 1.41369228 -1.044130e-03 0.999166905 #> 19       4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 20      30 25.005904 2.82726846  1.766403e+00 0.077328250 #> 21       2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 22       6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 23       3  5.000984 1.15429461 -1.733512e+00 0.083004632 #> 24       4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 25       3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 26       5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 27       2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 28       1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 29       4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 30       2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 31       8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 32       5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 33       9  7.001476 1.41369228  1.413691e+00 0.157452675 #> 34       1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 35      12  9.668799 1.69902630  1.372081e+00 0.170038313 #> 36      27 25.672735 2.86626456  4.630644e-01 0.643318223 #> 37       5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 38       1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 39       4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 40       4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 41       2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 42       2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 43       8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 44       6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 45       8  8.335137 1.56288494 -2.144351e-01 0.830207752 #> 46       8  7.668307 1.49015700  2.225895e-01 0.823855039 #> 47       3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 48       4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 49       2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 50       7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 51       2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 52       5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 53      11  9.668799 1.69902630  7.835083e-01 0.433328678 #> 54       3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 55      13 13.002952 1.99922042 -1.476654e-03 0.998821801 #> 56       0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 57       2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 58       3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 59       4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 60       3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 61       3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 62       2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 63       2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 64       5  5.667815 1.24677180 -5.356351e-01 0.592210772 #> 65       1  2.333661 0.66649415 -2.001010e+00 0.045391330 #> 66       4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 67       3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 68       3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 69       9  7.001476 1.41369228  1.413691e+00 0.157452675 #> 70       8  7.001476 1.41369228  7.063234e-01 0.479987051 #> 71       3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 72       3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 73       2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 74       7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 75       3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 76      18 15.670275 2.21020923  1.054074e+00 0.291848820 #> 77      12 11.669291 1.88488922  1.754529e-01 0.860723812 #> 78      28 29.006888 3.05378310 -3.297184e-01 0.741612777 #> 79      14 17.670767 2.35608263 -1.557996e+00 0.119234240 #> 80       3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 81      23 22.338582 2.66558409  2.481326e-01 0.804031790 #> 82      18 19.004428 2.44850757 -4.102206e-01 0.681644134 #> 83       3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 84      22 22.338582 2.66558409 -1.270197e-01 0.898924830 #> 85       6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 86       4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 87       4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 88       8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 89       4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 90       4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 91       1  2.333661 0.66649415 -2.001010e+00 0.045391330 #> 92       5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 93       5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 94      24 23.005412 2.70691089  3.674254e-01 0.713301756 #> 95       3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 96       5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 97       3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 98       3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 99      10  9.668799 1.69902630  1.949359e-01 0.845443130 #> 100      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 101      5  5.667815 1.24677180 -5.356351e-01 0.592210772 #> 102     10  7.668307 1.49015700  1.564730e+00 0.117646250 #> 103      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 104      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 105      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 106      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 107      9  8.335137 1.56288494  4.254072e-01 0.670539828 #> 108     17 16.337106 2.25988030  2.933317e-01 0.769268647 #> 109      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 110      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 111      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 112      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 113      8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 114      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 115      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 116      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 117      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 118     14 14.336614 2.10735730 -1.597325e-01 0.873091777 #> 119      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 120      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 121      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 122      7  7.001476 1.41369228 -1.044130e-03 0.999166905 #> 123      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 124     15 14.336614 2.10735730  3.147955e-01 0.752916966 #> 125      7  5.000984 1.15429461  1.731807e+00 0.083307861 #> 126      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 127      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 128     16 13.669783 2.05400069  1.134477e+00 0.256594389 #> 129      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 130      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 131      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 132      8  9.001968 1.63237562 -6.138098e-01 0.539341040 #> 133      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 134      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 135      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 136      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 137      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 138     25 20.338090 2.53756790  1.837157e+00 0.066186734 #> 139      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 140      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 141      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 142      5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 143     14 13.669783 2.05400069  1.607678e-01 0.872276289 #> 144      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 145      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 146      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 147      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 148     13 12.336121 1.94289607  3.416953e-01 0.732580185 #> 149      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 150      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 151      8  9.001968 1.63237562 -6.138098e-01 0.539341040 #> 152      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 153      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 154      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 155     13 13.002952 1.99922042 -1.476654e-03 0.998821801 #> 156     10  9.668799 1.69902630  1.949359e-01 0.845443130 #> 157     13 13.669783 2.05400069 -3.260870e-01 0.744358567 #> 158      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 159      6  4.334153 1.05373221  1.580901e+00 0.113900606 #> 160      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 161     28 29.006888 3.05378310 -3.297184e-01 0.741612777 #> 162      8  7.668307 1.49015700  2.225895e-01 0.823855039 #> 163      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 164      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 165      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 166      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 167      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 168      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 169      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 170      8  6.334645 1.33284778  1.249471e+00 0.211492867 #> 171     10  8.335137 1.56288494  1.065250e+00 0.286762989 #> 172      4  7.001476 1.41369228 -2.123147e+00 0.033741562 #> 173      8  7.001476 1.41369228  7.063234e-01 0.479987051 #> 174      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 175      2  4.334153 1.05373221 -2.215130e+00 0.026751172 #> 176      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 177     14 12.336121 1.94289607  8.563909e-01 0.391781595 #> 178      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 179     23 19.004428 2.44850757  1.631840e+00 0.102713268 #> 180      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 181      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 182     23 25.005904 2.82726846 -7.094849e-01 0.478023611 #> 183      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 184      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 185      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 186      7  7.668307 1.49015700 -4.484808e-01 0.653806265 #> 187     12 13.002952 1.99922042 -5.016716e-01 0.615898528 #> 188     19 21.671751 2.62360628 -1.018351e+00 0.308511387 #> 189      9  7.001476 1.41369228  1.413691e+00 0.157452675 #> 190      6  7.668307 1.49015700 -1.119551e+00 0.262905149 #> 191      7  7.001476 1.41369228 -1.044130e-03 0.999166905 #> 192      7  5.667815 1.24677180  1.068508e+00 0.285291559 #> 193     15 15.670275 2.21020923 -3.032631e-01 0.761689381 #> 194      7  7.001476 1.41369228 -1.044130e-03 0.999166905 #> 195      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 196     28 24.339074 2.78772681  1.313230e+00 0.189105471 #> 197     14 12.336121 1.94289607  8.563909e-01 0.391781595 #> 198      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 199      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 200      8  7.001476 1.41369228  7.063234e-01 0.479987051 #> 201      5  5.667815 1.24677180 -5.356351e-01 0.592210772 #> 202      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 203      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 204      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 205     11  8.335137 1.56288494  1.705092e+00 0.088177272 #> 206      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 207      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 208      9  7.668307 1.49015700  8.936597e-01 0.371503999 #> 209      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 210      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 211     11  9.001968 1.63237562  1.224003e+00 0.220951271 #> 212      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 213      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 214     12  9.668799 1.69902630  1.372081e+00 0.170038313 #> 215      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 216      1  3.667323 0.94250012 -2.830050e+00 0.004654069 #> 217      7  5.000984 1.15429461  1.731807e+00 0.083307861 #> 218      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 219      8  6.334645 1.33284778  1.249471e+00 0.211492867 #> 220     22 21.671751 2.62360628  1.251137e-01 0.900433545 #> 221      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 222     14 13.669783 2.05400069  1.607678e-01 0.872276289 #> 223      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 224     24 18.337598 2.40273961  2.356644e+00 0.018440905 #> 225      7  5.667815 1.24677180  1.068508e+00 0.285291559 #> 226      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 227      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 228     26 23.672243 2.74761605  8.471915e-01 0.396888375 #> 229      1  2.333661 0.66649415 -2.001010e+00 0.045391330 #> 230     22 24.339074 2.78772681 -8.390613e-01 0.401434920 #> 231      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 232      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 233      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 234      4  5.667815 1.24677180 -1.337706e+00 0.180992136 #> 235      7  5.667815 1.24677180  1.068508e+00 0.285291559 #> 236      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 237      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 238      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 239      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 240      1  3.000492 0.81624798 -2.450839e+00 0.014252386 #> 241      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 242      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 243      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 244     18 20.338090 2.53756790 -9.213900e-01 0.356846869 #> 245      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 246      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 247      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 248      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 249      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 250     10  9.001968 1.63237562  6.113984e-01 0.540935839 #> 251      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 252      7  5.667815 1.24677180  1.068508e+00 0.285291559 #> 253     12 12.336121 1.94289607 -1.730002e-01 0.862651241 #> 254      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 255     19 19.004428 2.44850757 -1.808544e-03 0.998556991 #> 256      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 257      7  8.335137 1.56288494 -8.542775e-01 0.392951254 #> 258      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 259      9  9.001968 1.63237562 -1.205669e-03 0.999038016 #> 260      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 261      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 262      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 263      7  5.000984 1.15429461  1.731807e+00 0.083307861 #> 264      3  7.001476 1.41369228 -2.830514e+00 0.004647325 #> 265      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 266      9  9.668799 1.69902630 -3.936365e-01 0.693849424 #> 267      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 268      8  8.335137 1.56288494 -2.144351e-01 0.830207752 #> 269      9  9.668799 1.69902630 -3.936365e-01 0.693849424 #> 270     16 14.336614 2.10735730  7.893234e-01 0.429922996 #> 271      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 272      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 273      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 274      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 275      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 276      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 277      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 278      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 279      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 280      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 281     21 28.340058 3.01721207 -2.432728e+00 0.014985534 #> 282      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 283      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 284      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 285      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 286     19 20.338090 2.53756790 -5.273118e-01 0.597977057 #> 287      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 288     11 11.002460 1.82503944 -1.347987e-03 0.998924462 #> 289      5  7.001476 1.41369228 -1.415779e+00 0.156840170 #> 290      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 291      6  7.668307 1.49015700 -1.119551e+00 0.262905149 #> 292      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 293      8  7.668307 1.49015700  2.225895e-01 0.823855039 #> 294      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 295      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 296     20 19.671259 2.49343546  1.318426e-01 0.895108767 #> 297     12  9.668799 1.69902630  1.372081e+00 0.170038313 #> 298     29 28.340058 3.01721207  2.187259e-01 0.826863602 #> 299      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 300      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 301      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 302      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 303      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 304      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 305      8  7.001476 1.41369228  7.063234e-01 0.479987051 #> 306      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 307      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 308      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 309     19 20.338090 2.53756790 -5.273118e-01 0.597977057 #> 310      8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 311      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 312      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 313     18 15.670275 2.21020923  1.054074e+00 0.291848820 #> 314     21 17.670767 2.35608263  1.413038e+00 0.157644698 #> 315      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 316      1  3.000492 0.81624798 -2.450839e+00 0.014252386 #> 317      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 318      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 319      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 320      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 321      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 322      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 323      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 324      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 325      5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 326      5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 327      7  5.000984 1.15429461  1.731807e+00 0.083307861 #> 328      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 329      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 330      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 331     14 13.002952 1.99922042  4.987183e-01 0.617977839 #> 332      8  6.334645 1.33284778  1.249471e+00 0.211492867 #> 333      2  3.667323 0.94250012 -1.769042e+00 0.076886794 #> 334      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 335      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 336      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 337     26 27.673227 2.98019220 -5.614494e-01 0.574491241 #> 338      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 339      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 340      7  7.668307 1.49015700 -4.484808e-01 0.653806265 #> 341     19 22.338582 2.66558409 -1.252477e+00 0.210396262 #> 342      6  7.001476 1.41369228 -7.084116e-01 0.478689660 #> 343      4  5.667815 1.24677180 -1.337706e+00 0.180992136 #> 344     17 18.337598 2.40273961 -5.566968e-01 0.577734574 #> 345      5  6.334645 1.33284778 -1.001349e+00 0.316658251 #> 346      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 347      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 348      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 349     21 18.337598 2.40273961  1.108069e+00 0.267831809 #> 350      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 351      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 352     17 12.336121 1.94289607  2.400478e+00 0.016373692 #> 353      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 354     21 21.671751 2.62360628 -2.560411e-01 0.797919132 #> 355      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 356      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 357      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 358      6  7.001476 1.41369228 -7.084116e-01 0.478689660 #> 359      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 360      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 361      8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 362      5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 363      6  4.334153 1.05373221  1.580901e+00 0.113900606 #> 364     22 20.338090 2.53756790  6.549225e-01 0.512517627 #> 365      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 366      8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 367      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 368      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 369      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 370      2  3.667323 0.94250012 -1.769042e+00 0.076886794 #> 371     20 22.338582 2.66558409 -8.773243e-01 0.380310534 #> 372      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 373      9 10.335629 1.76315909 -7.575207e-01 0.448737987 #> 374     16 13.002952 1.99922042  1.499108e+00 0.133845550 #> 375      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 376      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 377      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 378     19 20.338090 2.53756790 -5.273118e-01 0.597977057 #> 379      8  7.001476 1.41369228  7.063234e-01 0.479987051 #> 380      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 381      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 382     13 12.336121 1.94289607  3.416953e-01 0.732580185 #> 383      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 384      6  4.334153 1.05373221  1.580901e+00 0.113900606 #> 385      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 386      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 387      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 388      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 389      6  7.001476 1.41369228 -7.084116e-01 0.478689660 #> 390      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 391      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 392      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 393      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 394      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 395      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 396      9  8.335137 1.56288494  4.254072e-01 0.670539828 #> 397      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 398      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 399      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 400      9  7.001476 1.41369228  1.413691e+00 0.157452675 #> 401      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 402      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 403      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 404      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 405      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 406      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 407      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 408      7  7.001476 1.41369228 -1.044130e-03 0.999166905 #> 409      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 410      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 411     26 28.340058 3.01721207 -7.755695e-01 0.438003209 #> 412      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 413     13 12.336121 1.94289607  3.416953e-01 0.732580185 #> 414      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 415      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 416     20 19.671259 2.49343546  1.318426e-01 0.895108767 #> 417      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 418      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 419      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 420      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 421      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 422      9 11.669291 1.88488922 -1.416153e+00 0.156730824 #> 423      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 424      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 425      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 426      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 427     30 27.673227 2.98019220  7.807459e-01 0.434951931 #> 428      1  4.334153 1.05373221 -3.164137e+00 0.001555434 #> 429      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 430      5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 431      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 432      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 433      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 434     10  8.335137 1.56288494  1.065250e+00 0.286762989 #> 435      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 436      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 437      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 438     11  9.001968 1.63237562  1.224003e+00 0.220951271 #> 439      4  6.334645 1.33284778 -1.751622e+00 0.079838838 #> 440      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 441      1  2.333661 0.66649415 -2.001010e+00 0.045391330 #> 442      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 443     19 18.337598 2.40273961  2.756863e-01 0.782789004 #> 444      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 445      1  2.333661 0.66649415 -2.001010e+00 0.045391330 #> 446      6  4.334153 1.05373221  1.580901e+00 0.113900606 #> 447      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 448      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 449      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 450      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 451      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 452     10 13.669783 2.05400069 -1.786651e+00 0.073993879 #> 453      6  7.001476 1.41369228 -7.084116e-01 0.478689660 #> 454      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 455      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 456     26 21.671751 2.62360628  1.649733e+00 0.098997620 #> 457      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 458     11 10.335629 1.76315909  3.768069e-01 0.706317098 #> 459      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 460      5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 461      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 462      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 463      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 464      9 10.335629 1.76315909 -7.575207e-01 0.448737987 #> 465     27 23.005412 2.70691089  1.475700e+00 0.140024514 #> 466      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 467      2  3.667323 0.94250012 -1.769042e+00 0.076886794 #> 468      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 469     10  9.668799 1.69902630  1.949359e-01 0.845443130 #> 470      7  7.001476 1.41369228 -1.044130e-03 0.999166905 #> 471      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 472     10  9.001968 1.63237562  6.113984e-01 0.540935839 #> 473      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 474      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 475      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 476      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 477      8  7.001476 1.41369228  7.063234e-01 0.479987051 #> 478      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 479      6  8.335137 1.56288494 -1.494120e+00 0.135144294 #> 480      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 481      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 482      7  7.001476 1.41369228 -1.044130e-03 0.999166905 #> 483      7  7.668307 1.49015700 -4.484808e-01 0.653806265 #> 484      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 485      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 486     12 11.002460 1.82503944  5.465854e-01 0.584663619 #> 487      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 488      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 489      7  5.000984 1.15429461  1.731807e+00 0.083307861 #> 490      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 491      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 492     30 29.673719 3.08992122  1.055952e-01 0.915903505 #> 493      8  6.334645 1.33284778  1.249471e+00 0.211492867 #> 494      7  8.335137 1.56288494 -8.542775e-01 0.392951254 #> 495      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 496      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 497      5  5.667815 1.24677180 -5.356351e-01 0.592210772 #> 498      7  7.001476 1.41369228 -1.044130e-03 0.999166905 #> 499      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 500      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 501     19 17.003936 2.30848272  8.646648e-01 0.387222785 #> 502      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 503      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 504      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 505      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 506      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 507      5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 508      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 509      5  6.334645 1.33284778 -1.001349e+00 0.316658251 #> 510      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 511      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 512      8  7.668307 1.49015700  2.225895e-01 0.823855039 #> 513      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 514      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 515      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 516      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 517     25 28.340058 3.01721207 -1.107001e+00 0.268293366 #> 518      8  7.668307 1.49015700  2.225895e-01 0.823855039 #> 519      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 520      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 521      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 522      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 523      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 524      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 525      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 526      8  7.001476 1.41369228  7.063234e-01 0.479987051 #> 527      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 528      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 529      5  6.334645 1.33284778 -1.001349e+00 0.316658251 #> 530      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 531     19 20.338090 2.53756790 -5.273118e-01 0.597977057 #> 532     10  8.335137 1.56288494  1.065250e+00 0.286762989 #> 533      8  9.001968 1.63237562 -6.138098e-01 0.539341040 #> 534      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 535      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 536      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 537      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 538     19 21.671751 2.62360628 -1.018351e+00 0.308511387 #> 539      7  7.668307 1.49015700 -4.484808e-01 0.653806265 #> 540      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 541      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 542      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 543      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 544      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 545      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 546      7  5.667815 1.24677180  1.068508e+00 0.285291559 #> 547      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 548      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 549      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 550      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 551      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 552      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 553      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 554      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 555      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 556      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 557      5  6.334645 1.33284778 -1.001349e+00 0.316658251 #> 558      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 559      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 560     27 24.339074 2.78772681  9.545148e-01 0.339823146 #> 561      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 562      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 563      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 564     25 23.005412 2.70691089  7.368502e-01 0.461213477 #> 565     10  8.335137 1.56288494  1.065250e+00 0.286762989 #> 566      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 567      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 568     20 19.671259 2.49343546  1.318426e-01 0.895108767 #> 569      7  5.667815 1.24677180  1.068508e+00 0.285291559 #> 570      8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 571      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 572      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 573     16 16.337106 2.25988030 -1.491696e-01 0.881419775 #> 574      8  6.334645 1.33284778  1.249471e+00 0.211492867 #> 575      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 576      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 577      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 578      8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 579      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 580      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 581      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 582      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 583      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 584      9  7.668307 1.49015700  8.936597e-01 0.371503999 #> 585     17 16.337106 2.25988030  2.933317e-01 0.769268647 #> 586      8  9.001968 1.63237562 -6.138098e-01 0.539341040 #> 587      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 588      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 589      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 590      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 591      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 592      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 593      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 594      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 595      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 596      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 597      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 598     21 22.338582 2.66558409 -5.021720e-01 0.615546559 #> 599      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 600      5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 601      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 602      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 603      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 604     20 19.671259 2.49343546  1.318426e-01 0.895108767 #> 605     18 20.338090 2.53756790 -9.213900e-01 0.356846869 #> 606      8  7.001476 1.41369228  7.063234e-01 0.479987051 #> 607      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 608      5  5.667815 1.24677180 -5.356351e-01 0.592210772 #> 609      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 610      5  5.667815 1.24677180 -5.356351e-01 0.592210772 #> 611      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 612      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 613      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 614      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 615      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 616      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 617      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 618      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 619      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 620      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 621      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 622      6  4.334153 1.05373221  1.580901e+00 0.113900606 #> 623     17 15.670275 2.21020923  6.016286e-01 0.547421370 #> 624      7  5.667815 1.24677180  1.068508e+00 0.285291559 #> 625      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 626      9  9.001968 1.63237562 -1.205669e-03 0.999038016 #> 627      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 628     17 19.004428 2.44850757 -8.186326e-01 0.412996035 #> 629      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 630      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 631      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 632      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 633     14 13.002952 1.99922042  4.987183e-01 0.617977839 #> 634      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 635      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 636     15 19.671259 2.49343546 -1.873423e+00 0.061010020 #> 637      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 638      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 639      7  7.001476 1.41369228 -1.044130e-03 0.999166905 #> 640     22 20.338090 2.53756790  6.549225e-01 0.512517627 #> 641      6  4.334153 1.05373221  1.580901e+00 0.113900606 #> 642      2  3.667323 0.94250012 -1.769042e+00 0.076886794 #> 643      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 644      5  6.334645 1.33284778 -1.001349e+00 0.316658251 #> 645      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 646      1  2.333661 0.66649415 -2.001010e+00 0.045391330 #> 647      8  7.668307 1.49015700  2.225895e-01 0.823855039 #> 648      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 649      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 650     11  9.001968 1.63237562  1.224003e+00 0.220951271 #> 651     10 12.336121 1.94289607 -1.202391e+00 0.229211928 #> 652      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 653      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 654      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 655      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 656      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 657      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 658      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 659      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 660      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 661     27 23.005412 2.70691089  1.475700e+00 0.140024514 #> 662      6  9.001968 1.63237562 -1.839018e+00 0.065912542 #> 663      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 664      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 665      5  5.667815 1.24677180 -5.356351e-01 0.592210772 #> 666      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 667      1  2.333661 0.66649415 -2.001010e+00 0.045391330 #> 668      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 669      3  5.000984 1.15429461 -1.733512e+00 0.083004632 #> 670     10 11.002460 1.82503944 -5.492814e-01 0.582812384 #> 671      9  6.334645 1.33284778  1.999744e+00 0.045527894 #> 672      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 673      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 674      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 675      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 676      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 677      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 678     12 11.002460 1.82503944  5.465854e-01 0.584663619 #> 679      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 680      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 681      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 682      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 683      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 684      2  3.667323 0.94250012 -1.769042e+00 0.076886794 #> 685      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 686      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 687      5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 688      9  9.001968 1.63237562 -1.205669e-03 0.999038016 #> 689      7  5.667815 1.24677180  1.068508e+00 0.285291559 #> 690      6  8.335137 1.56288494 -1.494120e+00 0.135144294 #> 691      5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 692      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 693      2  5.000984 1.15429461 -2.599842e+00 0.009326659 #> 694      4  5.667815 1.24677180 -1.337706e+00 0.180992136 #> 695      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 696     13 11.669291 1.88488922  7.059880e-01 0.480195591 #> 697      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 698      9  7.668307 1.49015700  8.936597e-01 0.371503999 #> 699      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 700      8  7.001476 1.41369228  7.063234e-01 0.479987051 #> 701      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 702     19 15.670275 2.21020923  1.506520e+00 0.131933652 #> 703      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 704      9  8.335137 1.56288494  4.254072e-01 0.670539828 #> 705      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 706      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 707     17 16.337106 2.25988030  2.933317e-01 0.769268647 #> 708      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 709      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 710     10  9.668799 1.69902630  1.949359e-01 0.845443130 #> 711      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 712      5  7.001476 1.41369228 -1.415779e+00 0.156840170 #> 713      1  3.000492 0.81624798 -2.450839e+00 0.014252386 #> 714      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 715      2  4.334153 1.05373221 -2.215130e+00 0.026751172 #> 716      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 717      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 718      2  3.667323 0.94250012 -1.769042e+00 0.076886794 #> 719      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 720      8  9.001968 1.63237562 -6.138098e-01 0.539341040 #> 721      5  5.667815 1.24677180 -5.356351e-01 0.592210772 #> 722      3  5.000984 1.15429461 -1.733512e+00 0.083004632 #> 723     13 13.669783 2.05400069 -3.260870e-01 0.744358567 #> 724      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 725     10  7.668307 1.49015700  1.564730e+00 0.117646250 #> 726      9  7.001476 1.41369228  1.413691e+00 0.157452675 #> 727      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 728      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 729      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 730      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 731      4  5.667815 1.24677180 -1.337706e+00 0.180992136 #> 732      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 733     15 17.670767 2.35608263 -1.133562e+00 0.256978117 #> 734      1  2.333661 0.66649415 -2.001010e+00 0.045391330 #> 735      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 736      8  8.335137 1.56288494 -2.144351e-01 0.830207752 #> 737     22 21.004920 2.58094570  3.855485e-01 0.699831081 #> 738      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 739     10  7.668307 1.49015700  1.564730e+00 0.117646250 #> 740      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 741      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 742      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 743      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 744     16 14.336614 2.10735730  7.893234e-01 0.429922996 #> 745      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 746      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 747      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 748      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 749      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 750      4  6.334645 1.33284778 -1.751622e+00 0.079838838 #> 751     10 10.335629 1.76315909 -1.903569e-01 0.849029488 #> 752      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 753      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 754     25 21.671751 2.62360628  1.268578e+00 0.204591635 #> 755      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 756      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 757      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 758      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 759      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 760      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 761     10  9.668799 1.69902630  1.949359e-01 0.845443130 #> 762      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 763      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 764      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 765      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 766      4  4.334153 1.05373221 -3.171141e-01 0.751157001 #> 767      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 768      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 769      8  7.001476 1.41369228  7.063234e-01 0.479987051 #> 770      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 771      2  3.667323 0.94250012 -1.769042e+00 0.076886794 #> 772      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 773      7  7.668307 1.49015700 -4.484808e-01 0.653806265 #> 774     13 11.669291 1.88488922  7.059880e-01 0.480195591 #> 775     20 20.338090 2.53756790 -1.332337e-01 0.894008552 #> 776     27 29.006888 3.05378310 -6.571810e-01 0.511064513 #> 777      1  3.667323 0.94250012 -2.830050e+00 0.004654069 #> 778      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 779      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 780     18 12.336121 1.94289607  2.915173e+00 0.003554912 #> 781      1  2.333661 0.66649415 -2.001010e+00 0.045391330 #> 782      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 783      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 784      4  5.667815 1.24677180 -1.337706e+00 0.180992136 #> 785      5  5.667815 1.24677180 -5.356351e-01 0.592210772 #> 786     11 10.335629 1.76315909  3.768069e-01 0.706317098 #> 787      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 788      4  5.667815 1.24677180 -1.337706e+00 0.180992136 #> 789     10  9.668799 1.69902630  1.949359e-01 0.845443130 #> 790      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 791      6  6.334645 1.33284778 -2.510755e-01 0.801755749 #> 792      6  4.334153 1.05373221  1.580901e+00 0.113900606 #> 793      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 794      7  8.335137 1.56288494 -8.542775e-01 0.392951254 #> 795      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 796     11  9.668799 1.69902630  7.835083e-01 0.433328678 #> 797      8  7.668307 1.49015700  2.225895e-01 0.823855039 #> 798      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 799     19 18.337598 2.40273961  2.756863e-01 0.782789004 #> 800      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 801      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 802      5  5.667815 1.24677180 -5.356351e-01 0.592210772 #> 803      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 804      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 805      5  3.667323 0.94250012  1.413981e+00 0.157367469 #> 806      5  6.334645 1.33284778 -1.001349e+00 0.316658251 #> 807     11  7.668307 1.49015700  2.235800e+00 0.025364865 #> 808      8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 809      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 810      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 811     13 13.669783 2.05400069 -3.260870e-01 0.744358567 #> 812      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 813     30 29.006888 3.05378310  3.252070e-01 0.745024412 #> 814      0  1.000000 0.01095397 -9.129110e+01 0.000000000 #> 815      6  9.001968 1.63237562 -1.839018e+00 0.065912542 #> 816      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 817      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 818      9  9.001968 1.63237562 -1.205669e-03 0.999038016 #> 819      1  1.666831 0.47134650 -1.414736e+00 0.157146034 #> 820      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 821      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 822      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 823      7  5.667815 1.24677180  1.068508e+00 0.285291559 #> 824      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 825      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 826      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 827     13 11.669291 1.88488922  7.059880e-01 0.480195591 #> 828      8  6.334645 1.33284778  1.249471e+00 0.211492867 #> 829      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 830      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 831      4  3.667323 0.94250012  3.529732e-01 0.724108520 #> 832      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 833      5  4.334153 1.05373221  6.318936e-01 0.527456416 #> 834      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 835     19 16.337106 2.25988030  1.178334e+00 0.238663359 #> 836      6  4.334153 1.05373221  1.580901e+00 0.113900606 #> 837      7  8.335137 1.56288494 -8.542775e-01 0.392951254 #> 838      8  6.334645 1.33284778  1.249471e+00 0.211492867 #> 839      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 840     27 29.673719 3.08992122 -8.653033e-01 0.386872338 #> 841      8  5.667815 1.24677180  1.870579e+00 0.061403444 #> 842      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 843      2  4.334153 1.05373221 -2.215130e+00 0.026751172 #> 844      6  5.000984 1.15429461  8.654774e-01 0.386776793 #> 845      6  5.667815 1.24677180  2.664363e-01 0.789903208 #> 846      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 847     18 16.337106 2.25988030  7.358330e-01 0.461832345 #> 848     10  7.668307 1.49015700  1.564730e+00 0.117646250 #> 849      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 850      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 851     21 20.338090 2.53756790  2.608444e-01 0.794212491 #> 852      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 853      1  3.000492 0.81624798 -2.450839e+00 0.014252386 #> 854      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 855      8  7.001476 1.41369228  7.063234e-01 0.479987051 #> 856      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 857      7  6.334645 1.33284778  4.991977e-01 0.617640087 #> 858     27 23.005412 2.70691089  1.475700e+00 0.140024514 #> 859      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 860      3  2.333661 0.66649415  9.997667e-01 0.317423430 #> 861      9  8.335137 1.56288494  4.254072e-01 0.670539828 #> 862      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 863      2  2.333661 0.66649415 -5.006216e-01 0.616637476 #> 864      2  1.666831 0.47134650  7.068459e-01 0.479662271 #> 865      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 866      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 867      1  2.333661 0.66649415 -2.001010e+00 0.045391330 #> 868      5  5.000984 1.15429461 -8.525138e-04 0.999319792 #> 869      2  3.000492 0.81624798 -1.225721e+00 0.220303808 #> 870      3  3.667323 0.94250012 -7.080346e-01 0.478923767 #> 871      4  5.000984 1.15429461 -8.671825e-01 0.385842041 #> 872      4  3.000492 0.81624798  1.224515e+00 0.220757976 #> 873      3  4.334153 1.05373221 -1.266122e+00 0.205469460 #> 874     23 21.004920 2.58094570  7.730034e-01 0.439520382 #> 875      5  7.001476 1.41369228 -1.415779e+00 0.156840170 #> 876      3  3.000492 0.81624798 -6.027899e-04 0.999519043 #> 877      7  7.668307 1.49015700 -4.484808e-01 0.653806265 plot(lsrq, sf = FastFood.sf) #> Warning: bounding box has potentially an invalid value range for longlat data  # }"},{"path":"https://f8l5h9.github.io/spqdep/reference/m.surround.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to generate m-surroundings — m.surround","title":"A function to generate m-surroundings — m.surround","text":"function obtains m-surroundings   selecting *m-1* nearest neighbors   observation, allowing degree   overlap *r*.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/m.surround.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to generate m-surroundings — m.surround","text":"","code":"m.surround(x, m, r = 1, distance = \"Euclidean\", control = list())"},{"path":"https://f8l5h9.github.io/spqdep/reference/m.surround.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to generate m-surroundings — m.surround","text":"x input sf object points/multipolygons geometry matrix spatial coordinates m dimension m-surrounding r maximum overlapping two m-surroundings. distance character. Cartesian coordinates : one Euclidean, Hausdorff Frechet; geodetic coordinates, Great Circle distances computed. (see sf::st_distance()). Default = \"Euclidean\". control List additional control arguments.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/m.surround.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to generate m-surroundings — m.surround","text":"list class list m_surr containing following components:","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/m.surround.html","id":"control-arguments","dir":"Reference","previous_headings":"","what":"Control arguments","title":"A function to generate m-surroundings — m.surround","text":"initobs: Initial observation begin       m-surrounding process. Default = 1. dtmaxabs: Threshold distance (absolute       value) prune m-surroundings. m-surrounding       exceeding threshold excluded.       dtmaxabs = 0 exclusion m-surroundings.       Default = 0. dtmaxpc: Threshold distance (percentage       maximum distance observations) prune m-surroundings. m-surrounding       exceeding threshold excluded.       Example dtmaxpc = 0.1 m-surrounding exceeding       10       dtmaxpc = 0 exclusion m-surroundings.       Default = 0. dtmaxknn: Eliminate m-surroundings       elements among closest       knn (k-nearest-neighbors).       Example, dtmaxknn = 4 exclude m-surroundings       elements 4 closest.       Default dtmaxknn = 0 (exclusion)","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/m.surround.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A function to generate m-surroundings — m.surround","text":"Ruiz M, López FA, Páez. (2010). Testing spatial association qualitative     data using symbolic dynamics. Journal Geographical Systems. 12 (3) 281-309","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/m.surround.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A function to generate m-surroundings — m.surround","text":"","code":"# Example 1: Obtain m-surroundings with degree of overlapping r N <- 100 cx <- runif(N) cy <- runif(N) x <- cbind(cx,cy) m <- 3 r <- 1 msurr_points <- m.surround(x = x, m = m, r = r) plot(msurr_points, type = 1)  plot(msurr_points, type = 2)  summary(msurr_points) #>  #> Characteristics of m-surrounding: #>  #> Number of m-surrounding (R): 49 #> Length of m-surrounding (m): 3 #> Number no-symbolized observations: 1 #>  #> List of no-symbolized observations: #> 38 #>  #> List of the degree overlaping: #>     There are 2 m-surrounding that have intersection with 1 m-surrounding #>     There are 47 m-surrounding that have intersection with 2 m-surrounding #> Mean degree of overlaping: 1.9592 msurr_points <- m.surround(x = x, m = m, r = r,                 control = list(dtmaxpc = 0.1)) #>  #>  Threshold distance:  0.1316995 #>  Number of m-surroundings excluded for exceeding #>         the threshold distance:  17  #>  #>  Index of spatial observations excluded:  5 30 42 3 9 11 13 17 20 25 27 31 34 39 41 44 45  plot(msurr_points, type = 1)  plot(msurr_points, type = 2)  summary(msurr_points) #>  #> Characteristics of m-surrounding: #>  #> Number of m-surrounding (R): 32 #> Length of m-surrounding (m): 3 #> Number no-symbolized observations: 26 #>  #> List of no-symbolized observations: #> 8 9 10 11 14 15 25 31 35 38 51 52 53 54 57 61 62 64 71 75 77 85 89 93 95 96 #>  #> List of the degree overlaping: #>     There are 4 m-surrounding that have intersection with 0 m-surrounding #>     There are 12 m-surrounding that have intersection with 1 m-surrounding #>     There are 16 m-surrounding that have intersection with 2 m-surrounding #> Mean degree of overlaping: 1.375 msurr_points <- m.surround(x = x, m = m, r = r,                    control = list(dtmaxknn = 20)) plot(msurr_points, type = 1)  plot(msurr_points, type = 2)  summary(msurr_points) #>  #> Characteristics of m-surrounding: #>  #> Number of m-surrounding (R): 47 #> Length of m-surrounding (m): 3 #> Number no-symbolized observations: 4 #>  #> List of no-symbolized observations: #> 10 25 38 52 #>  #> List of the degree overlaping: #>     There are 4 m-surrounding that have intersection with 1 m-surrounding #>     There are 43 m-surrounding that have intersection with 2 m-surrounding #> Mean degree of overlaping: 1.9149  # Example 2: # \\donttest{ data(\"FastFood.sf\") m <- 3 r <- 1 msurr_points <- m.surround(x = FastFood.sf, m = m, r = r,                            distance = \"Euclidean\",                            control = list(dtmaxpc = .001)) #> Warning: bounding box has potentially an invalid value range for longlat data #>  #>  Threshold distance:  105.4512 #>  Number of m-surroundings excluded for exceeding #>         the threshold distance:  424  #>  #>  Index of spatial observations excluded:  2 3 6 7 8 10 11 12 13 14 15 16 17 19 20 21 22 23 24 26 27 28 33 34 35 36 37 38 39 42 44 45 49 50 51 52 53 54 55 56 57 58 59 60 61 64 65 66 68 69 70 71 72 74 76 79 80 81 82 83 84 85 86 87 89 92 95 96 97 98 99 100 101 102 104 105 106 108 109 112 113 114 115 116 117 118 119 120 122 123 124 125 126 127 129 130 131 132 133 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 163 164 165 167 168 171 173 174 176 178 180 181 182 183 184 186 188 189 190 191 192 193 194 196 198 199 200 201 202 203 205 207 209 212 214 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 233 234 235 237 238 239 240 241 243 244 245 246 248 249 250 252 253 254 255 256 258 259 260 261 262 263 264 265 267 268 269 270 271 272 274 275 276 278 279 280 281 282 283 285 287 290 291 292 293 295 296 297 298 300 301 302 303 304 306 307 310 311 312 314 316 317 318 319 321 323 324 326 327 328 329 330 331 332 333 334 335 336 337 339 340 341 342 343 344 345 348 349 350 351 352 353 354 356 357 358 359 360 363 365 366 368 369 370 373 374 377 378 379 381 382 383 384 385 388 389 390 391 392 394 395 396 397 398 399 400 401 402 403 404 405 406 407 410 411 412 414 415 416 418 419 420 421 422 423 424 426 427 428 429 430 431 432 433 434 435 437 438 4 9 18 25 29 31 32 40 43 46 47 48 63 67 73 75 77 78 88 90 91 93 94 103 107 110 111 121 128 134 161 162 166 169 170 172 175 179 185 187 197 204 206 208 211 213 215 231 236 247 251 257 266 273 277 284 286 288 289 294 299 305 308 309 313 322 338 346 347 355 361 362 364 367 371 372 375 376 380 386 387 408 409 413 417 425 436  plot(msurr_points, type = 1)  plot(msurr_points, type = 2) #> Warning: bounding box has potentially an invalid value range for longlat data  print(msurr_points) #>       [,1] [,2] [,3] #>  [1,]    1  180  675 #>  [2,]    7  580  196 #>  [3,]   65  520  793 #>  [4,]   87  234  136 #>  [5,]  139  284  343 #>  [6,]  366  347  217 #>  [7,]  390   17  742 #>  [8,]  422    9  662 #>  [9,]  467  199  271 #> [10,]  488  133  657 #> [11,]  637  515  103 #> [12,]  654  832  387 #> [13,]  664  175  852 #> [14,]  791  650   81 summary(msurr_points) #>  #> Characteristics of m-surrounding: #>  #> Number of m-surrounding (R): 14 #> Length of m-surrounding (m): 3 #> Number no-symbolized observations: 835 #>  #> List of no-symbolized observations: #> 2 3 4 5 6 8 10 11 12 13 14 15 16 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 82 83 84 85 86 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 134 135 137 138 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 176 177 178 179 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 197 198 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 272 273 274 275 276 277 278 279 280 281 282 283 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 344 345 346 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 388 389 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 516 517 518 519 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629 630 631 632 633 634 635 636 638 639 640 641 642 643 644 645 646 647 648 649 651 652 653 655 656 658 659 660 661 663 665 666 667 668 669 670 671 672 673 674 676 677 678 679 680 681 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 721 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 743 744 745 746 747 748 749 750 751 752 753 754 755 756 757 758 759 760 761 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780 781 782 783 784 785 786 787 788 789 790 792 794 795 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811 812 813 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 833 834 835 836 837 838 839 840 841 842 843 844 845 846 847 848 849 850 851 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 #>  #> List of the degree overlaping: #>     There are 14 m-surrounding that have intersection with 0 m-surrounding #> Mean degree of overlaping: 0 msurr_points <- m.surround(x = FastFood.sf, m = m, r = r,                            distance = \"Euclidean\",                            control = list(dtmaxknn = 20)) #> Warning: bounding box has potentially an invalid value range for longlat data plot(msurr_points, type = 1)  plot(msurr_points, type = 2) #> Warning: bounding box has potentially an invalid value range for longlat data  summary(msurr_points) #>  #> Characteristics of m-surrounding: #>  #> Number of m-surrounding (R): 409 #> Length of m-surrounding (m): 3 #> Number no-symbolized observations: 34 #>  #> List of no-symbolized observations: #> 21 30 56 94 99 115 119 211 285 312 345 418 432 494 523 525 567 618 646 655 660 663 736 776 789 796 798 799 809 815 827 862 871 876 #>  #> List of the degree overlaping: #>     There are 2 m-surrounding that have intersection with 0 m-surrounding #>     There are 46 m-surrounding that have intersection with 1 m-surrounding #>     There are 361 m-surrounding that have intersection with 2 m-surrounding #> Mean degree of overlaping: 1.8778 # }  # Example 3: With isolated areas data(provinces_spain) sf::sf_use_s2(FALSE) plot(sf::st_geometry(provinces_spain))  m <- 3 r <- 1 msurr_points <- m.surround(x = provinces_spain, m = m, r = r,                            distance = \"Euclidean\",                            control = list(dtmaxknn = 8)) plot(msurr_points, type = 1) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data  plot(msurr_points, type = 2) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data   # Example 4: Examples with multipolygons fname <- system.file(\"shape/nc.shp\", package=\"sf\") nc <- sf::st_read(fname) #> Reading layer `nc' from data source  #>   `/home/runner/work/_temp/Library/sf/shape/nc.shp' using driver `ESRI Shapefile' #> Simple feature collection with 100 features and 14 fields #> Geometry type: MULTIPOLYGON #> Dimension:     XY #> Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965 #> Geodetic CRS:  NAD27 plot(sf::st_geometry(nc))  m <- 3 r <- 1 msurr_polygonsf <- m.surround(x = nc, m = m, r = r,                    distance = \"Great Circle\",                    control=list(dtmaxpc = 0.20)) #>  #>  Threshold distance:  150383.5 #>  Number of m-surroundings excluded for exceeding #>         the threshold distance:  2  #>  #>  Index of spatial observations excluded:  42 28  plot(msurr_polygonsf, type = 1) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data  plot(msurr_polygonsf, type = 2) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data   # Example 5: With regular lattice sfc = sf::st_sfc(sf::st_polygon(list(rbind(c(0,0), c(1,0), c(1,1), c(0,1), c(0,0))))) hexs <- sf::st_make_grid(sfc, cellsize = 0.1, square = FALSE) hexs.sf <- sf::st_sf(hexs) listw  <- spdep::poly2nb(as(hexs.sf, \"Spatial\"), queen = FALSE) m <- 3 r <- 1 msurr_polygonsf <- m.surround(x = hexs.sf, m = m, r = r) plot(msurr_polygonsf, type = 1)  plot(msurr_polygonsf, type = 2)  summary(msurr_polygonsf) #>  #> Characteristics of m-surrounding: #>  #> Number of m-surrounding (R): 74 #> Length of m-surrounding (m): 3 #> Number no-symbolized observations: 0 #>  #> List of no-symbolized observations: #>  #>  #> List of the degree overlaping: #>     There are 2 m-surrounding that have intersection with 1 m-surrounding #>     There are 72 m-surrounding that have intersection with 2 m-surrounding #> Mean degree of overlaping: 1.973"},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localjc.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for class localjc — methods_localjc","title":"Methods for class localjc — methods_localjc","text":"plot() function allows user plot significant observations. print() function used print number runs localization. Additional information expected values standard deviation, z-value ans p-value prited observation.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localjc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for class localjc — methods_localjc","text":"","code":"# S3 method for localjc print(x, ...)  # S3 method for localjc plot(x, ..., sf = NULL, coor = NULL, sig = 0.05)"},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localjc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for class localjc — methods_localjc","text":"x localjc object created Q.test. ... arguments passed methods. sf optional argument plot() method include sf object (default = NULL) coor optional argument plot() method include coordinates points (default = NULL) sig significant level observation plot() method. Default sig = 0.05","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localjc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Methods for class localjc — methods_localjc","text":"return value, called side effects","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localjc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Methods for class localjc — methods_localjc","text":"Ruiz, M., López, F., Páez, . (2021).     test global local homogeneity categorical data based spatial runs.       working paper.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localjc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Methods for class localjc — methods_localjc","text":"","code":"# Example 1: Local spatial runs test based on knn library(lwgeom) N <- 100 cx <- runif(N) cy <- runif(N) x <- cbind(cx,cy) listw <- spdep::knearneigh(cbind(cx,cy), k = 10) p <- c(1/6,3/6,2/6) rho <- 0.5 fx <- dgp.spq(p = p, listw = listw, rho = rho)  # Asymtotic version lsrq <- local.sp.runs.test(fx = fx, listw = listw, alternative = \"less\") print(lsrq) #>     runs.i      E.i   Std.i    z.value      p.value #> 1        8 7.183838 1.59988  0.5101392 0.6950230217 #> 2        7 7.183838 1.59988 -0.1149076 0.4542591853 #> 3        7 7.183838 1.59988 -0.1149076 0.4542591853 #> 4        6 7.183838 1.59988 -0.7399544 0.2296638446 #> 5        7 7.183838 1.59988 -0.1149076 0.4542591853 #> 6        7 7.183838 1.59988 -0.1149076 0.4542591853 #> 7        7 7.183838 1.59988 -0.1149076 0.4542591853 #> 8        6 7.183838 1.59988 -0.7399544 0.2296638446 #> 9        7 7.183838 1.59988 -0.1149076 0.4542591853 #> 10       9 7.183838 1.59988  1.1351860 0.8718512930 #> 11       9 7.183838 1.59988  1.1351860 0.8718512930 #> 12       8 7.183838 1.59988  0.5101392 0.6950230217 #> 13       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 14       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 15       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 16       9 7.183838 1.59988  1.1351860 0.8718512930 #> 17       8 7.183838 1.59988  0.5101392 0.6950230217 #> 18       8 7.183838 1.59988  0.5101392 0.6950230217 #> 19       8 7.183838 1.59988  0.5101392 0.6950230217 #> 20       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 21       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 22       8 7.183838 1.59988  0.5101392 0.6950230217 #> 23       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 24       9 7.183838 1.59988  1.1351860 0.8718512930 #> 25      10 7.183838 1.59988  1.7602327 0.9608158220 #> 26       9 7.183838 1.59988  1.1351860 0.8718512930 #> 27       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 28      10 7.183838 1.59988  1.7602327 0.9608158220 #> 29       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 30       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 31       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 32       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 33       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 34       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 35       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 36       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 37       8 7.183838 1.59988  0.5101392 0.6950230217 #> 38       9 7.183838 1.59988  1.1351860 0.8718512930 #> 39       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 40       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 41       8 7.183838 1.59988  0.5101392 0.6950230217 #> 42       8 7.183838 1.59988  0.5101392 0.6950230217 #> 43      11 7.183838 1.59988  2.3852795 0.9914669250 #> 44       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 45       8 7.183838 1.59988  0.5101392 0.6950230217 #> 46       9 7.183838 1.59988  1.1351860 0.8718512930 #> 47       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 48       9 7.183838 1.59988  1.1351860 0.8718512930 #> 49       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 50       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 51       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 52       2 7.183838 1.59988 -3.2401414 0.0005973521 #> 53      10 7.183838 1.59988  1.7602327 0.9608158220 #> 54       8 7.183838 1.59988  0.5101392 0.6950230217 #> 55       8 7.183838 1.59988  0.5101392 0.6950230217 #> 56       9 7.183838 1.59988  1.1351860 0.8718512930 #> 57       8 7.183838 1.59988  0.5101392 0.6950230217 #> 58       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 59       8 7.183838 1.59988  0.5101392 0.6950230217 #> 60       8 7.183838 1.59988  0.5101392 0.6950230217 #> 61       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 62       8 7.183838 1.59988  0.5101392 0.6950230217 #> 63      10 7.183838 1.59988  1.7602327 0.9608158220 #> 64       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 65       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 66       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 67       8 7.183838 1.59988  0.5101392 0.6950230217 #> 68       8 7.183838 1.59988  0.5101392 0.6950230217 #> 69       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 70       8 7.183838 1.59988  0.5101392 0.6950230217 #> 71       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 72       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 73       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 74       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 75       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 76       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 77       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 78       8 7.183838 1.59988  0.5101392 0.6950230217 #> 79       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 80       9 7.183838 1.59988  1.1351860 0.8718512930 #> 81       9 7.183838 1.59988  1.1351860 0.8718512930 #> 82       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 83      11 7.183838 1.59988  2.3852795 0.9914669250 #> 84       9 7.183838 1.59988  1.1351860 0.8718512930 #> 85       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 86       8 7.183838 1.59988  0.5101392 0.6950230217 #> 87       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 88       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 89       9 7.183838 1.59988  1.1351860 0.8718512930 #> 90       8 7.183838 1.59988  0.5101392 0.6950230217 #> 91       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 92       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 93       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 94       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 95       8 7.183838 1.59988  0.5101392 0.6950230217 #> 96       8 7.183838 1.59988  0.5101392 0.6950230217 #> 97       8 7.183838 1.59988  0.5101392 0.6950230217 #> 98       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 99       8 7.183838 1.59988  0.5101392 0.6950230217 #> 100      7 7.183838 1.59988 -0.1149076 0.4542591853 plot(lsrq, sig = 0.05)"},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localsrq.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for class localsrq — methods_localsrq","title":"Methods for class localsrq — methods_localsrq","text":"plot() function allows user plot significant observations. print() function used print number runs localization. Additional information expected values standard deviation, z-value ans p-value prited observation.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localsrq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for class localsrq — methods_localsrq","text":"","code":"# S3 method for localsrq print(x, ...)  # S3 method for localsrq plot(x, ..., sf = NULL, coor = NULL, sig = 0.05)"},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localsrq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for class localsrq — methods_localsrq","text":"x localsrq object created Q.test. ... arguments passed methods. sf optional argument plot() method include sf object (default = NULL) coor optional argument plot() method include coordinates points (default = NULL) sig significant level observation plot() method. Default sig = 0.05","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localsrq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Methods for class localsrq — methods_localsrq","text":"return value, called side effects","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localsrq.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Methods for class localsrq — methods_localsrq","text":"Ruiz, M., López, F., Páez, . (2021).     test global local homogeneity categorical data based spatial runs.       working paper.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_localsrq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Methods for class localsrq — methods_localsrq","text":"","code":"# Example 1: Local spatial runs test based on knn library(lwgeom) N <- 100 cx <- runif(N) cy <- runif(N) x <- cbind(cx,cy) listw <- spdep::knearneigh(cbind(cx,cy), k = 10) p <- c(1/6,3/6,2/6) rho <- 0.5 fx <- dgp.spq(p = p, listw = listw, rho = rho)  # Asymtotic version lsrq <- local.sp.runs.test(fx = fx, listw = listw, alternative = \"less\") print(lsrq) #>     runs.i      E.i   Std.i    z.value      p.value #> 1        7 7.183838 1.59988 -0.1149076 0.4542591853 #> 2        6 7.183838 1.59988 -0.7399544 0.2296638446 #> 3        8 7.183838 1.59988  0.5101392 0.6950230217 #> 4        9 7.183838 1.59988  1.1351860 0.8718512930 #> 5        9 7.183838 1.59988  1.1351860 0.8718512930 #> 6        7 7.183838 1.59988 -0.1149076 0.4542591853 #> 7        6 7.183838 1.59988 -0.7399544 0.2296638446 #> 8        7 7.183838 1.59988 -0.1149076 0.4542591853 #> 9       10 7.183838 1.59988  1.7602327 0.9608158220 #> 10       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 11      10 7.183838 1.59988  1.7602327 0.9608158220 #> 12       8 7.183838 1.59988  0.5101392 0.6950230217 #> 13       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 14       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 15       9 7.183838 1.59988  1.1351860 0.8718512930 #> 16       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 17      10 7.183838 1.59988  1.7602327 0.9608158220 #> 18       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 19      10 7.183838 1.59988  1.7602327 0.9608158220 #> 20      10 7.183838 1.59988  1.7602327 0.9608158220 #> 21       3 7.183838 1.59988 -2.6150947 0.0044601364 #> 22       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 23       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 24       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 25       9 7.183838 1.59988  1.1351860 0.8718512930 #> 26       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 27       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 28       9 7.183838 1.59988  1.1351860 0.8718512930 #> 29       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 30       8 7.183838 1.59988  0.5101392 0.6950230217 #> 31       9 7.183838 1.59988  1.1351860 0.8718512930 #> 32       8 7.183838 1.59988  0.5101392 0.6950230217 #> 33       8 7.183838 1.59988  0.5101392 0.6950230217 #> 34      10 7.183838 1.59988  1.7602327 0.9608158220 #> 35       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 36      10 7.183838 1.59988  1.7602327 0.9608158220 #> 37       8 7.183838 1.59988  0.5101392 0.6950230217 #> 38       9 7.183838 1.59988  1.1351860 0.8718512930 #> 39       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 40       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 41       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 42       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 43       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 44       8 7.183838 1.59988  0.5101392 0.6950230217 #> 45       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 46       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 47       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 48       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 49      10 7.183838 1.59988  1.7602327 0.9608158220 #> 50       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 51       8 7.183838 1.59988  0.5101392 0.6950230217 #> 52       8 7.183838 1.59988  0.5101392 0.6950230217 #> 53       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 54       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 55       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 56       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 57      11 7.183838 1.59988  2.3852795 0.9914669250 #> 58       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 59       8 7.183838 1.59988  0.5101392 0.6950230217 #> 60       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 61       3 7.183838 1.59988 -2.6150947 0.0044601364 #> 62       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 63      10 7.183838 1.59988  1.7602327 0.9608158220 #> 64       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 65       8 7.183838 1.59988  0.5101392 0.6950230217 #> 66       9 7.183838 1.59988  1.1351860 0.8718512930 #> 67       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 68       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 69       8 7.183838 1.59988  0.5101392 0.6950230217 #> 70       8 7.183838 1.59988  0.5101392 0.6950230217 #> 71       9 7.183838 1.59988  1.1351860 0.8718512930 #> 72       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 73       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 74       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 75       8 7.183838 1.59988  0.5101392 0.6950230217 #> 76       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 77       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 78       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 79       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 80       9 7.183838 1.59988  1.1351860 0.8718512930 #> 81       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 82       2 7.183838 1.59988 -3.2401414 0.0005973521 #> 83       8 7.183838 1.59988  0.5101392 0.6950230217 #> 84       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 85       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 86       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 87       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 88       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 89       9 7.183838 1.59988  1.1351860 0.8718512930 #> 90       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 91       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 92       8 7.183838 1.59988  0.5101392 0.6950230217 #> 93       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 94       4 7.183838 1.59988 -1.9900479 0.0232928297 #> 95       7 7.183838 1.59988 -0.1149076 0.4542591853 #> 96      10 7.183838 1.59988  1.7602327 0.9608158220 #> 97       5 7.183838 1.59988 -1.3650011 0.0861263477 #> 98       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 99       6 7.183838 1.59988 -0.7399544 0.2296638446 #> 100      7 7.183838 1.59988 -0.1149076 0.4542591853 plot(lsrq, sig = 0.05)"},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_m_surr.html","id":null,"dir":"Reference","previous_headings":"","what":"Method for class m_surr — methods_m_surr","title":"Method for class m_surr — methods_m_surr","text":"function plots m-surrounds give object class m_surr obtain code m.surround.  plot() function allows user view configuration m-surroundings.  argument type select type o visualization.   print() print matrix m-surrounding. .  summary give information characteristics m-surroundings. .","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_m_surr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Method for class m_surr — methods_m_surr","text":"","code":"# S3 method for m_surr summary(object, ...)  # S3 method for m_surr plot(x, ..., type = 1)  # S3 method for m_surr print(x, ...)"},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_m_surr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Method for class m_surr — methods_m_surr","text":"object object class m_surr. 2 plot W matrix network ... arguments passed methods. x object class m_surr type numeric. 1 (default) get plot igraph.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_m_surr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Method for class m_surr — methods_m_surr","text":"return value, called side effects","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_m_surr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Method for class m_surr — methods_m_surr","text":"Ruiz, M., López, F., Páez, . (2021).     test global local homogeneity categorical data based spatial runs.       Working paper.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_m_surr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Method for class m_surr — methods_m_surr","text":"","code":"# Example 1: Obtain m-surroundings with degree of overlapping r N <- 100 cx <- runif(N) cy <- runif(N) x <- cbind(cx,cy) m = 4 r = 2 msurr_points <- m.surround(x = x, m = m, r = r,control = list(dtmaxabs = 0.5)) #>  #>  Threshold distance:  0.5 #>  Number of m-surroundings excluded for exceeding #>         the threshold distance:  1  #>  #>  Index of spatial observations excluded:  45  plot(msurr_points, type = 1)  plot(msurr_points, type = 2)  print(msurr_points) #>       [,1] [,2] [,3] [,4] #>  [1,]    1   10   64   44 #>  [2,]    2   88    9   74 #>  [3,]    3   54   13   65 #>  [4,]    5   37   21   57 #>  [5,]    6   77   97   32 #>  [6,]    7   66   62   44 #>  [7,]    8   38   91   17 #>  [8,]    9   18  100   74 #>  [9,]   13   65   96   39 #> [10,]   15   20   72   90 #> [11,]   16   48   15   43 #> [12,]   21   57   58   18 #> [13,]   22   19   67   77 #> [14,]   24   25   30   73 #> [15,]   29   11   75   46 #> [16,]   30   73   56   53 #> [17,]   32   45   82   93 #> [18,]   39   71    5   37 #> [19,]   43   50   90   35 #> [20,]   44   95   24    3 #> [21,]   49   86   87   22 #> [22,]   51   26   32   45 #> [23,]   52   92   61   23 #> [24,]   55   36   52   23 #> [25,]   56   53   83   63 #> [26,]   58   34    2   74 #> [27,]   59   28   94   14 #> [28,]   60   33   29   95 #> [29,]   61   23   89   86 #> [30,]   62   85   44   24 #> [31,]   64   84   60   95 #> [32,]   67   12   69   39 #> [33,]   69   41    3   13 #> [34,]   70   76    7   66 #> [35,]   72   47   43   90 #> [36,]   75   46   70    7 #> [37,]   78   31    6   97 #> [38,]   81   98    8   38 #> [39,]   82    4   93   99 #> [40,]   83   63   59   28 #> [41,]   87   68   22   19 #> [42,]   89   40   49   86 #> [43,]   90   35   55   61 #> [44,]   91   17   78   31 #> [45,]   94   14   16   40 #> [46,]   96   42   39   37 #> [47,]   97   27   51   32 #> [48,]  100   74   81   98  # Example 2: data(\"FastFood.sf\") m = 6 r = 1 msurr_points <-  m.surround(x = FastFood.sf, m = m, r = r, distance = \"Euclidean\",                             control = list(dtmaxpc = .01)) #> Warning: bounding box has potentially an invalid value range for longlat data #>  #>  Threshold distance:  1054.512 #>  Number of m-surroundings excluded for exceeding #>         the threshold distance:  154  #>  #>  Index of spatial observations excluded:  6 12 19 25 27 29 32 36 40 46 49 55 57 58 59 60 61 63 74 75 80 83 85 86 88 89 91 100 101 102 105 110 111 112 113 118 119 120 122 123 124 125 128 131 137 138 143 144 147 150 151 155 156 157 160 164 165 168 171 173 174 2 3 5 7 8 17 20 21 22 23 24 33 34 38 51 54 62 64 65 68 69 76 77 78 98 99 103 107 109 114 115 126 132 133 135 139 140 141 149 154 159 161 162 163 167 170 172 175 9 13 16 26 31 35 37 39 41 43 47 52 56 67 70 71 73 79 92 93 106 121 134 136 153 166 4 42 53 66 72 82 84 87 90 96 142 148 18 28 30 81 108 129 152  plot(msurr_points, type = 1)  plot(msurr_points, type = 2) #> Warning: bounding box has potentially an invalid value range for longlat data  print(msurr_points) #>       [,1] [,2] [,3] [,4] [,5] [,6] #>  [1,]    1  180  675  719  471  294 #>  [2,]   39  352  693  615  402  469 #>  [3,]   40  807  745  496  592  512 #>  [4,]   63  738  612  186   53  796 #>  [5,]   74  721  751   48  165  500 #>  [6,]  208  699  601  648  824  778 #>  [7,]  209  642  397  752  509  483 #>  [8,]  221  153  477  797  584  594 #>  [9,]  226   61  122  607  617  765 #> [10,]  483  131  339  116  229   63 #> [11,]  500  764  166  559  373  310 #> [12,]  505  744   47  367  706  209 #> [13,]  529  622  412   93  248  398 #> [14,]  593   97  613  403  575  221 #> [15,]  594  105  753  396   35  208 #> [16,]  645  106  585  596  610  510 #> [17,]  657  488  133  792  489  479 #> [18,]  763  499  630  743   58   74 #> [19,]  765  849   68  152  600  763 #> [20,]  796  115  588  597  843  226 #> [21,]  832  387  654   60  757  516"},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_qmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Method for class qmap — methods_qmap","title":"Method for class qmap — methods_qmap","text":"function plot difference frequencies symbols map.  plot() function obtain plot.  argument ci select confidence level.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_qmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Method for class qmap — methods_qmap","text":"x object class qmap ci confidence level difference probabilities symbols `plot` method. Default ci = 0.95 ... arguments passed methods.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_qmap.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Method for class qmap — methods_qmap","text":"Ruiz M, López FA Páez (2011).     Comparison Thematic Maps Using Symbolic Entropy.       International Journal Geographical Information Science,  26, 413-439. Ruiz, M., López, F., Páez, . (2021).     test global local homogeneity categorical data based spatial runs.       working paper.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_qmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Method for class qmap — methods_qmap","text":"","code":"# Example 1: N <- 100 cx <- runif(N) cy <- runif(N) coor <- cbind(cx,cy) p <- c(1/6,3/6,2/6) rho = 0.5 listw <- spdep::nb2listw(spdep::knn2nb(spdep::knearneigh(cbind(cx,cy), k = 4))) fx <- dgp.spq(list = listw, p = p, rho = rho) q.test <- Q.test(fx = fx, coor = coor, m = 3, r = 1) plot(q.test) #> [[1]]  #>  #> [[2]]  #>"},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_scantest.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for class scantest — methods_scantest","title":"Methods for class scantest — methods_scantest","text":"plot() function allows user plot significant cluster(s).summary list information likelihood cluster.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_scantest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for class scantest — methods_scantest","text":"","code":"# S3 method for scantest plot(x, ..., sf = NULL, coor = NULL)  # S3 method for scantest summary(object, ...)"},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_scantest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for class scantest — methods_scantest","text":"x scantest object created scan.test plot() method. ... arguments passed methods. sf optional argument plot() method include sf object (default = NULL) coor optional argument plot() method include coordinates points (default = NULL) object scantest object created scan.test summary() method.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_scantest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Methods for class scantest — methods_scantest","text":"return value, called side effects","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_scantest.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Methods for class scantest — methods_scantest","text":"Ruiz, M., López, F., Páez, . (2021).     test global local homogeneity categorical data based spatial runs.       Working paper.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_spqtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for class spqtest — methods_spqtest","title":"Methods for class spqtest — methods_spqtest","text":"plot() function allows user obtain plot relative frequency symbol (standard equivalent) confidence interval.  print() function used get list values Q test  standard symbolization based permutations equivalent symbolization  based combinations. summary() print table output Q test.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_spqtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for class spqtest — methods_spqtest","text":"","code":"# S3 method for spqtest plot(x, ..., ci = 0.95)"},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_spqtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for class spqtest — methods_spqtest","text":"x spqtest object created Q.test. ... arguments passed methods ci confidence level intervals plot method. Default ci = 0.95","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_spqtest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Methods for class spqtest — methods_spqtest","text":"functions return value","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/methods_spqtest.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Methods for class spqtest — methods_spqtest","text":"Ruiz, M., López, F., Páez, . (2021).     test global local homogeneity categorical data based spatial runs.       working paper.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/nb2nb_order.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to order the elements of the m_i-subrrounds — nb2nb_order","title":"A function to order the elements of the m_i-subrrounds — nb2nb_order","text":"auxiliary function. case obtaining list neighbors class nb poly2nb, necessary reorder elements based distance /angle.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/nb2nb_order.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to order the elements of the m_i-subrrounds — nb2nb_order","text":"","code":"nb2nb_order(listw = listw, sf = NULL)"},{"path":"https://f8l5h9.github.io/spqdep/reference/nb2nb_order.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to order the elements of the m_i-subrrounds — nb2nb_order","text":"listw object nb class. sf sf object used get listw .","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/nb2nb_order.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to order the elements of the m_i-subrrounds — nb2nb_order","text":"object nb class elements order.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/nb2nb_order.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"A function to order the elements of the m_i-subrrounds — nb2nb_order","text":"Sort elements list nb. First distance ","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/nb2nb_order.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"A function to order the elements of the m_i-subrrounds — nb2nb_order","text":"@references Ruiz, M., López, F., Páez, . (2021).     test global local homogeneity categorical data based spatial runs.       Working paper.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/nb2nb_order.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A function to order the elements of the m_i-subrrounds — nb2nb_order","text":"","code":"# With a sf object (irregular lattice) library(sf) fname <- system.file(\"shape/nc.shp\", package=\"sf\") nc <- sf::st_read(fname) #> Reading layer `nc' from data source  #>   `/home/runner/work/_temp/Library/sf/shape/nc.shp' using driver `ESRI Shapefile' #> Simple feature collection with 100 features and 14 fields #> Geometry type: MULTIPOLYGON #> Dimension:     XY #> Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965 #> Geodetic CRS:  NAD27 listw <- spdep::poly2nb(as(nc,\"Spatial\"), queen = FALSE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar listw.order <- nb2nb_order(listw = listw, sf = nc) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data  # With a sf object (regular lattice: hexagons) sfc = sf::st_sfc(sf::st_polygon(list(rbind(c(0,0), c(1,0), c(1,1), c(0,1), c(0,0))))) hexs <- sf::st_make_grid(sfc, cellsize = 0.1, square = FALSE) hexs.sf <- sf::st_sf(hexs) listw  <- spdep::poly2nb(as(hexs.sf, \"Spatial\"), queen = FALSE) listw.order <- nb2nb_order(listw = listw, sf = hexs.sf)"},{"path":"https://f8l5h9.github.io/spqdep/reference/plot.sprunstest.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the empirical distribution of runs — plot.sprunstest","title":"Plot the empirical distribution of runs — plot.sprunstest","text":"Plot empirical distribution runs","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/plot.sprunstest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the empirical distribution of runs — plot.sprunstest","text":"","code":"# S3 method for sprunstest plot(x, ...)"},{"path":"https://f8l5h9.github.io/spqdep/reference/plot.sprunstest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the empirical distribution of runs — plot.sprunstest","text":"x object class sprunstest. ... arguments passed methods.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/plot.sprunstest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the empirical distribution of runs — plot.sprunstest","text":"return value, called side effects","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/plot.sprunstest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot the empirical distribution of runs — plot.sprunstest","text":"Plot histogram empirical distribution runs","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/plot.sprunstest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the empirical distribution of runs — plot.sprunstest","text":"","code":"# Example 1: Fastfood example. sf (points) data(\"FastFood.sf\") x <- sf::st_coordinates(sf::st_centroid(FastFood.sf)) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: st_centroid does not give correct centroids for longitude/latitude data listw <- spdep::knearneigh(x, k = 2) formula <- ~ Type srq <- sp.runs.test(formula = formula, data = FastFood.sf, listw = listw, nsim = 299) plot(srq)   # Example 2: Spain example (poligons with 0 neinghbourhood) data(\"provinces_spain\") sf::sf_use_s2(FALSE) listw <- spdep::poly2nb(as(provinces_spain,\"Spatial\"), queen = FALSE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar provinces_spain$Older <- cut(provinces_spain$Older, breaks = c(-Inf,19,22.5,Inf)) levels(provinces_spain$Older) = c(\"low\",\"middle\",\"high\") formula <- ~ Older srq <- sp.runs.test(formula = formula, data = provinces_spain, listw = listw, nsim = 299) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data plot(srq)  provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") formula <- ~ Male2Female srq <- sp.runs.test(formula = formula, data = provinces_spain, listw = listw, nsim = 299) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data plot(srq)"},{"path":"https://f8l5h9.github.io/spqdep/reference/print.summary.spjctest.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for objects of class summary.spjctest. — print.summary.spjctest","title":"Print method for objects of class summary.spjctest. — print.summary.spjctest","text":"Print method objects class summary.spjctest.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/print.summary.spjctest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for objects of class summary.spjctest. — print.summary.spjctest","text":"","code":"# S3 method for summary.spjctest print(x, digits = max(3L, getOption(\"digits\") - 3L), ...)"},{"path":"https://f8l5h9.github.io/spqdep/reference/print.summary.spjctest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for objects of class summary.spjctest. — print.summary.spjctest","text":"x object class summary.spjctest. digits number digits show printed tables. Default: max(3L, getOption(\"digits\") - 3L). ... arguments passed methods.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/print.summary.spjctest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for objects of class summary.spjctest. — print.summary.spjctest","text":"return value, called side effects","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/print.summary.spqtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for objects of class summary.spqtest. — print.summary.spqtest","title":"Print method for objects of class summary.spqtest. — print.summary.spqtest","text":"Print method objects class summary.spqtest.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/print.summary.spqtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for objects of class summary.spqtest. — print.summary.spqtest","text":"","code":"# S3 method for summary.spqtest print(x, digits = max(3L, getOption(\"digits\") - 3L), ...)"},{"path":"https://f8l5h9.github.io/spqdep/reference/print.summary.spqtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for objects of class summary.spqtest. — print.summary.spqtest","text":"x object class summary.spqtest. digits number digits show printed tables. Default: max(3L, getOption(\"digits\") - 3L). ... arguments passed methods.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/print.summary.spqtest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for objects of class summary.spqtest. — print.summary.spqtest","text":"return value, called side effects","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/provinces_spain.html","id":null,"dir":"Reference","previous_headings":"","what":"Provinces in Spain. — provinces_spain","title":"Provinces in Spain. — provinces_spain","text":"simple features object provinces Spain selected demographic economic information.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/provinces_spain.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Provinces in Spain. — provinces_spain","text":"","code":"data(provinces_spain)"},{"path":"https://f8l5h9.github.io/spqdep/reference/provinces_spain.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Provinces in Spain. — provinces_spain","text":"simple features dataframe 50 rows 15 columns: province Names provinces Spain factor CCAA Names Autonomous Communities Spain factor ID_INE National Institute Statistics unique identifier provinces Population Population province 2020 Density Population density province persons/km^2 Older Percentage population 65 older provice 2020 Median_Age Median age population province 2020 Male2Female Ratio male female population province 2020 GDPpc GDP per capita province 2016 Transit Dummy variable mass transit system province; 1: YES Area Area province Altitude Altitude province Coast dummy variable indicates whether province coast; 1: YES Meteo_Station Identifier meteorological station representative province used retrieve climatic variables geometry geometry simple features object","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/provinces_spain.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Provinces in Spain. — provinces_spain","text":"Instituto Nacional de Estadistica http://www.ine.es/ Climatic data: Agencia Estatal de Meteorologia http://www.aemet.es/ Páez et al. (2020)","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/provinces_spain.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Provinces in Spain. — provinces_spain","text":"Paez, ., Lopez, F.., Menezes, T., Cavalcanti, R., & Pitta, M. (2020). Spatio‐Temporal Analysis      Environmental Correlates COVID‐19 Incidence Spain. Geographical Analysis. 53(3) 397-421","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/provinces_spain.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Provinces in Spain. — provinces_spain","text":"","code":"data(provinces_spain)  summary(provinces_spain) #>              province                    CCAA        ID_INE      #>  Albacete        : 1   Castilla y Leon     : 9   Min.   : 1.00   #>  Alicante/Alacant: 1   Andalucia           : 8   1st Qu.:13.25   #>  Almeria         : 1   Castilla - La Mancha: 5   Median :25.50   #>  Araba/alava     : 1   CataluÃ±a           : 4   Mean   :25.50   #>  Asturias        : 1   Galicia             : 4   3rd Qu.:37.75   #>  Avila           : 1   Aragon              : 3   Max.   :50.00   #>  (Other)         :44   (Other)             :17                   #>    Population         Density           Older         Median_Age    #>  Min.   :  88636   Min.   :  8.60   Min.   :15.16   Min.   :40.19   #>  1st Qu.: 337901   1st Qu.: 26.18   1st Qu.:18.09   1st Qu.:42.45   #>  Median : 684202   Median : 63.50   Median :19.93   Median :43.70   #>  Mean   : 974257   Mean   :140.04   Mean   :21.03   Mean   :44.55   #>  3rd Qu.:1149460   3rd Qu.:171.64   3rd Qu.:23.03   3rd Qu.:46.00   #>  Max.   :6663394   Max.   :829.76   Max.   :31.36   Max.   :50.68   #>                                                                     #>   Male2Female         GDPpc          Transit       Altitude          Coast      #>  Min.   : 91.59   Min.   :16666   Min.   :0.0   Min.   :   5.0   Min.   :0.00   #>  1st Qu.: 95.52   1st Qu.:18878   1st Qu.:0.0   1st Qu.:  24.5   1st Qu.:0.00   #>  Median : 98.06   Median :20870   Median :0.0   Median : 215.5   Median :0.00   #>  Mean   : 97.83   Mean   :22506   Mean   :0.1   Mean   : 369.0   Mean   :0.42   #>  3rd Qu.:100.01   3rd Qu.:25835   3rd Qu.:0.0   3rd Qu.: 677.5   3rd Qu.:1.00   #>  Max.   :103.01   Max.   :36001   Max.   :1.0   Max.   :1131.0   Max.   :1.00   #>                                                                                 #>  Meteo_Station      Area                    geometry  #>  0016A  : 1    Min.   :1.979e+09   MULTIPOLYGON :50   #>  0076   : 1    1st Qu.:6.707e+09   epsg:4326    : 0   #>  0367   : 1    Median :1.001e+10   +proj=long...: 0   #>  1024E  : 1    Mean   :1.012e+10                      #>  1082   : 1    3rd Qu.:1.370e+10                      #>  1111X  : 1    Max.   :2.179e+10                      #>  (Other):44"},{"path":"https://f8l5h9.github.io/spqdep/reference/scan.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the scan test — scan.test","title":"Compute the scan test — scan.test","text":"function compute spatial scan test Bernoulli Multinomial categorical spatial process, detect spatial clusters","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/scan.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the scan test — scan.test","text":"","code":"scan.test(formula = NULL, data = NULL, fx = NULL, coor = NULL, case = NULL, nv = NULL, nsim = NULL, distr = NULL, windows = \"circular\", listw = NULL, alternative = \"High\", minsize = 1, control = list())"},{"path":"https://f8l5h9.github.io/spqdep/reference/scan.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the scan test — scan.test","text":"formula symbolic description factor (optional). data (optional) data frame sf object containing variable testing . fx factor (optional). coor (optional) coordinates observations. case Bernoulli distribution. element factor, cases non-cases testing cases versus non-cases nv Maximum windows size, default nv = N/2. algorithm scan clusters geographic size 1 upper limit (nv) defined user. nsim Number permutations. distr distribution spatial process: \"bernoulli\" two levels \"multinomial\" three levels. windows string select type cluster \"circular\" (default) \"elliptic\". listw flexible windows. neighbours list (object class listw, nb knn frop spdep) adjacency matrix. alternative Bernoulli spatial process. character string specifying type cluster, must one \"High\" (default), \"\" \"Low\". minsize Minimum number observations inside Likely Cluster secondary clusters. control List additional control arguments.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/scan.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the scan test — scan.test","text":"object htest scantest class","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/scan.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the scan test — scan.test","text":"Two alternative sets arguments can included function compute scan test: Option 1: factor (fx) coordinates (coor). Option 2: sf object (data) formula specify factor.     function consider coordinates centroids elements th sf object. spatial scan statistics widely used epidemiology, criminology ecology.  purpose analyse spatial distribution points geographical  regions testing hypothesis spatial randomness distribution  basis different distributions (e.g. Bernoulli, Poisson Normal distributions).  scan.test function obtain scan statistic two relevant distributions related  categorical variables: Bernoulli Multinomial distribution.  spatial scan statistic based likelihood ratio test statistic  formulated follows:  $$\\Delta = { \\max_{z \\Z,H_A} L(\\theta|z) \\\\max_{z \\Z,H_0} L(\\theta|z)}$$  Z represents collection scanning windows constructed study region,  \\(H_A\\) alternative hypothesis, \\(H_0\\) null hypothesis, \\(L(\\theta|z)\\)   likelihood function parameter \\(\\theta\\) given window Z.   null hypothesis says spatial clustering study region,   alternative hypothesis certain area high (low) rates   outcome variables. null alternative hypotheses likelihood function may   expressed different ways depending probability model consideration.  test independence spatial process, null, type windows  irrelevant alternative elliptic  windows can identify precision cluster. big data sets (N >>) windows = \"elliptic\" can slowly Bernoulli version dichotomous outcome variables, cases noncases certain  diseases, Bernoulli model used. null hypothesis written  $$H_0 : p = q  \\ \\ \\ \\   \\ \\ Z$$  alternative hypothesis   $$H_A : p \\neq q  \\ \\  \\ \\  \\ \\ Z$$  p q outcome probabilities (e.g., probability case)  inside outside scanning window Z, respectively. Given window Z, test statistic : cz nz numbers cases observations (cases noncases) within z,  respectively, C N total numbers cases observations whole  study region, respectively. $$\\Delta = $$ Multinomial version scan test multinomial version spatial scan statistic useful investigate clustering discrete spatial variable can take one one k possible outcomes lack intrinsic order information. region defined moving window denoted Z, null hypothesis statistic can stated follows: $$H_0: p_1 = q_1;p_2 = q_2;...;p_k = q_k$$ \\(p_j\\) probability event type j inside window Z, \\(q_j\\) probability event type j outside window. alternative hypothesis least one type event probability  type different inside outside window. statistic built likelihood ratio, takes following  form transformation using natural logarithm: $$\\Delta = \\max_Z \\{\\sum_j \\{ S_j^Z log({ S_j^Z \\S^Z }) + (S_j-S_j^Z) log({ {S_j-S_j^Z} \\{S-S^Z} })\\}\\}-\\sum_j S_j log({ S_j \\S }) $$ S total number events study area \\(S_j\\) total number events type j. superscript Z denotes sub-region defined moving window.  theoretical distribution statistic null hypothesis known,  therefore significance evaluated numerically simulating neutral landscapes  (obtained using random spatial process) contrasting empirically calculated  statistic frequency values obtained neutral landscapes.  results likelihood ratio serve identify likely cluster,  followed secondary clusters expedient sorting according   magnitude test. usual, significance assigned analyst,    cutoff value significance reflects confidence analyst, tolerance error.  implementing statistic, analyst must decide shape  window maximum number cases given window can cover.  Currently, analysis can done using circular elliptical windows.  Elliptical windows time consuming evaluate provide greater  flexibility contrast distribution events inside outside window,  selected shape analyses follow. Furthermore, recommended  maximum number cases entering given window exceed 50%  available cases.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/scan.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute the scan test — scan.test","text":"Kulldorff M, Nagarwalla N. (1995).     Spatial disease clusters: Detection Inference.       Statistics Medicine. 14:799-810 Jung , Kulldorff M, Richard OJ (2010).     spatial scan statistic multinomial data.       Statistics Medicine. 29(18), 1910-1918 Páez, ., López-Hernández, F.., Ortega-García, J.., Ruiz, M. (2016).      Clustering co-occurrence cancer types: comparison techniques      application pediatric cancer Murcia, Spain.      Spatial Analysis Health Geography, 69-90. Tango T., Takahashi K. (2005). flexibly shaped spatial scan statistic      detecting clusters, International Journal Health Geographics 4:11.","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/scan.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the scan test — scan.test","text":"","code":"# Case 1: Scan test bernoulli data(provinces_spain) sf::sf_use_s2(FALSE) provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") formula <- ~ Male2Female scan <- scan.test(formula = formula, data = provinces_spain, case=\"men\", nsim = 99, distr = \"bernoulli\") print(scan) #>  #> \tScan test. Distribution: bernoulli #>  #> data:  Male2Female #> scan-loglik = 6.0359, p-value = 0.07 #> alternative hypothesis: High #> sample estimates: #>                                         #> Total observations in the MLC =   17.00 #> Expected cases in the MLC =       11.84 #> Observed cases in the MLC =       16.00 #>  summary(scan) #>  #> Summary of data: #> Distribution....................: bernoulli #> Type of cluster (alternative)...: High #> Number of locations.............: 50 #> Cathegory case..................: men #> Total number of observations....: 37 #> Names of cathegories............: men woman #> Total per category..............: 37 13 #> Percent per category............: 0.74 0.26 #> --------------------------------- #>  #> Scan statistic: Most Likely Cluster #> Total observations in the MLC........: 17 #> Names of cathegories.................: men woman #> Percent per category total...........: 0.74 0.26 #> Percent per category inside cluster..: 0.94 0.06 #> Value of statisitic (loglik ratio)...: 6.0359 #> p-value..............................: 0.07 #>  #> IDs of cluster detect: #> Location IDs included...:  37 34 20 11 40 28 6 14 10 18 35 36 22 31 13 15 4 #> --------------------------------- #>  #>  #> Secondary Cluster. Number 1  #> Total observations in secondary cluster.:  23  #> Names of cathegories.................: men woman #> Percent per category total...........: 0.74 0.26 #> Percent per category inside cluster..: 0.61 0.39 #> Value of statisitic (loglik ratio)...: 5.4635 #> p-value..............................: 0.15 #> Location IDs included................:  41 25 19 1 9 30 48 39 50 27 46 16 42 33 38 45 43 5 21 12 2 44 13 #>  #>  #> Secondary Cluster. Number 2  #> Total observations in secondary cluster.:  2  #> Names of cathegories.................: men woman #> Percent per category total...........: 0.74 0.26 #> Percent per category inside cluster..: 1 0 #> Value of statisitic (loglik ratio)...: 0.3047 #> p-value..............................: 0.99 #> Location IDs included................:  3 44 #>  #>  #> Secondary Cluster. Number 3  #> Total observations in secondary cluster.:  2  #> Names of cathegories.................: men woman #> Percent per category total...........: 0.74 0.26 #> Percent per category inside cluster..: 0.5 0.5 #> Value of statisitic (loglik ratio)...: 0.3047 #> p-value..............................: 0.99 #> Location IDs included................:  7 8 #>  #>  #> Secondary Cluster. Number 4  #> Total observations in secondary cluster.:  2  #> Names of cathegories.................: men woman #> Percent per category total...........: 0.74 0.26 #> Percent per category inside cluster..: 1 0 #> Value of statisitic (loglik ratio)...: 0.3047 #> p-value..............................: 0.99 #> Location IDs included................:  17 8 #>  #>  #> Secondary Cluster. Number 5  #> Total observations in secondary cluster.:  2  #> Names of cathegories.................: men woman #> Percent per category total...........: 0.74 0.26 #> Percent per category inside cluster..: 0.5 0.5 #> Value of statisitic (loglik ratio)...: 0.3047 #> p-value..............................: 0.99 #> Location IDs included................:  24 49 plot(scan, sf = provinces_spain)  # \\donttest{ ## With maximum number of neighborhood scan <- scan.test(formula = formula, data = provinces_spain, case = \"woman\", nsim = 99, distr = \"bernoulli\") print(scan) #>  #> \tScan test. Distribution: bernoulli #>  #> data:  Male2Female #> scan-loglik = 5.6358, p-value = 0.22 #> alternative hypothesis: High #> sample estimates: #>                                         #> Total observations in the MLC =   11.00 #> Expected cases in the MLC =        7.02 #> Observed cases in the MLC =        7.00 #>  plot(scan, sf = provinces_spain)    ## With elliptic windows scan <- scan.test(formula = formula, data = provinces_spain, case = \"men\", nv = 25, nsim = 99, distr = \"bernoulli\", windows =\"elliptic\") print(scan) #>  #> \tScan test. Distribution: bernoulli #>  #> data:  Male2Female #> scan-loglik = 7.038, p-value < 2.2e-16 #> alternative hypothesis: High #> sample estimates: #>                                         #> Total observations in the MLC =   19.00 #> Expected cases in the MLC =       62.16 #> Observed cases in the MLC =       18.00 #>  scan <- scan.test(formula = formula, data = provinces_spain, case = \"men\", nv = 15, nsim = 99, distr = \"bernoulli\", windows =\"elliptic\", alternative = \"Low\") print(scan) #>  #> \tScan test. Distribution: bernoulli #>  #> data:  Male2Female #> scan-loglik = 5.9143, p-value = 0.1 #> alternative hypothesis: Low #> sample estimates: #>                                         #> Total observations in the MLC =    5.00 #> Expected cases in the MLC =       51.06 #> Observed cases in the MLC =        1.00 #>  plot(scan, sf = provinces_spain)   # Case 2: scan test multinomial data(provinces_spain) provinces_spain$Older <- cut(provinces_spain$Older, breaks = c(-Inf,19,22.5,Inf)) levels(provinces_spain$Older) = c(\"low\",\"middle\",\"high\") formula <- ~ Older scan <- scan.test(formula = formula, data = provinces_spain, nsim = 99, distr = \"multinomial\") print(scan) #>  #> \tScan test. Distribution: multinomial #>  #> data:  Older #> scan-loglik = 4.2473, p-value = 0.9 #> sample estimates: #>               low middle high Sum #> cases.expect 2.24   2.88 2.88   8 #> cases.observ 0.00   6.00 2.00   8 #>  plot(scan, sf = provinces_spain)   # Case 3: scan test multinomial data(FastFood.sf) sf::sf_use_s2(FALSE) formula <- ~ Type scan <- scan.test(formula = formula, data = FastFood.sf, nsim = 99, distr = \"multinomial\", windows=\"elliptic\", nv = 50) print(scan) #>  #> \tScan test. Distribution: multinomial #>  #> data:  Type #> scan-loglik = 15.506, p-value < 2.2e-16 #> sample estimates: #>                  H     P     S Sum #> cases.expect 13.48 14.86 14.66  43 #> cases.observ 16.00  1.00 26.00  43 #>  summary(scan) #>  #> Summary of data: #> Distribution....................: multinomial #> Number of locations.............: 877 #> Total number of cases...........: 877 #> Names of cathegories...........: H P S #> Total cases per category........: 275 303 299 #> Percent cases per category......: 0.31 0.35 0.34 #>  #> Scan statistic: #> Total cases in the MLC.........: 43 #> Names of cathegories...........: H P S #> Observed cases in the MLC......: 13.48 14.86 14.66 #> Expected cases in the MLC......: 16 1 26 #> Value of statistic (loglik ratio)....: 15.5058 #> p-value........................: 0 #>  #> IDs of cluster detect: #> Location IDs included.....:  68 849 152 499 630 763 827 765 617 600 607 48 58 588 743 843 74 122 750 115 645 61 226 796 876 699 610 597 596 721 751 53 186 659 778 63 106 229 585 738 612 131 208 #>  #>  #> Secondary Scan statistic. Number 1  #> Total cases in secondary cluster......:  16  #> Names of cathegories.................: H P S #> Percent per category total...........: 0.31 0.35 0.34 #> Percent per category inside cluster..: 0.25 0.5 0.25 #> Value of statisitic (loglik ratio)....: 11.5285 #> p-value.........................: 0.1 #> Location IDs included..................:  677 311 781 128 108 436 551 576 21 374 319 717 561 6 629 547 #>  #>  #> Secondary Scan statistic. Number 2  #> Total cases in secondary cluster......:  7  #> Names of cathegories.................: H P S #> Percent per category total...........: 0.31 0.35 0.34 #> Percent per category inside cluster..: 0.14 0.29 0.57 #> Value of statisitic (loglik ratio)....: 7.0038 #> p-value.........................: 0.96 #> Location IDs included..................:  158 709 335 801 749 545 856 #>  #>  #> Secondary Scan statistic. Number 3  #> Total cases in secondary cluster......:  17  #> Names of cathegories.................: H P S #> Percent per category total...........: 0.31 0.35 0.34 #> Percent per category inside cluster..: 0.35 0.35 0.29 #> Value of statisitic (loglik ratio)....: 6.8747 #> p-value.........................: 0.98 #> Location IDs included..................:  521 782 162 643 297 220 267 265 104 530 312 523 783 157 531 848 680 #>  #>  #> Secondary Scan statistic. Number 4  #> Total cases in secondary cluster......:  17  #> Names of cathegories.................: H P S #> Percent per category total...........: 0.31 0.35 0.34 #> Percent per category inside cluster..: 0.47 0.29 0.24 #> Value of statisitic (loglik ratio)....: 6.7961 #> p-value.........................: 0.98 #> Location IDs included..................:  190 837 555 711 646 216 17 390 742 563 307 4 353 197 254 192 66 #>  #>  #> Secondary Scan statistic. Number 5  #> Total cases in secondary cluster......:  10  #> Names of cathegories.................: H P S #> Percent per category total...........: 0.31 0.35 0.34 #> Percent per category inside cluster..: 0.4 0.2 0.4 #> Value of statisitic (loglik ratio)....: 6.5951 #> p-value.........................: 0.98 #> Location IDs included..................:  78 365 668 228 170 857 306 708 651 187 plot(scan, sf = FastFood.sf) #> Warning: bounding box has potentially an invalid value range for longlat data   # Case 4: DGP two categories N <- 150 cx <- runif(N) cy <- runif(N) listw <- spdep::knearneigh(cbind(cx,cy), k = 10) p <- c(1/2,1/2) rho <- 0.5 fx <- dgp.spq(p = p, listw = listw, rho = rho) scan <- scan.test(fx = fx, nsim = 99, case = \"A\", nv = 50, coor = cbind(cx,cy), distr = \"bernoulli\",windows=\"circular\") print(scan) #>  #> \tScan test. Distribution: bernoulli #>  #> data:  fx #> scan-loglik = 16.273, p-value < 2.2e-16 #> alternative hypothesis: High #> sample estimates: #>                                        #> Total observations in the MLC =   22.0 #> Expected cases in the MLC =       10.5 #> Observed cases in the MLC =       21.0 #>  plot(scan)   # Case 5: DGP three categories N <- 200 cx <- runif(N) cy <- runif(N) listw <- spdep::knearneigh(cbind(cx,cy), k = 10) p <- c(1/3,1/3,1/3) rho <- 0.5 fx <- dgp.spq(p = p, listw = listw, rho = rho) scan <- scan.test(fx = fx, nsim = 19, coor = cbind(cx,cy), nv = 30, distr = \"multinomial\", windows = \"elliptic\") print(scan) #>  #> \tScan test. Distribution: multinomial #>  #> data:  fx #> scan-loglik = 9.0847, p-value = 0.2 #> sample estimates: #>                 A    B    C Sum #> cases.expect 2.68 2.64 2.68   8 #> cases.observ 0.00 0.00 8.00   8 #>  plot(scan)   # Case 6: Flexible windows data(provinces_spain) sf::sf_use_s2(FALSE) provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) #> Warning: ‘>’ not meaningful for factors levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") formula <- ~ Male2Female listw <- spdep::poly2nb(provinces_spain, queen = FALSE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar scan <- scan.test(formula = formula, data = provinces_spain, case=\"men\", listw = listw, nv = 6,                   nsim = 99, distr = \"bernoulli\", windows = \"flexible\") #> Error in scan.test(formula = formula, data = provinces_spain, case = \"men\",     listw = listw, nv = 6, nsim = 99, distr = \"bernoulli\", windows = \"flexible\"): The factor mut be have 2 levels for bernoulli print(scan) #>  #> \tScan test. Distribution: multinomial #>  #> data:  fx #> scan-loglik = 9.0847, p-value = 0.2 #> sample estimates: #>                 A    B    C Sum #> cases.expect 2.68 2.64 2.68   8 #> cases.observ 0.00 0.00 8.00   8 #>  summary(scan) #>  #> Summary of data: #> Distribution....................: multinomial #> Number of locations.............: 200 #> Total number of cases...........: 200 #> Names of cathegories...........: A B C #> Total cases per category........: 67 66 67 #> Percent cases per category......: 0.34 0.33 0.34 #>  #> Scan statistic: #> Total cases in the MLC.........: 8 #> Names of cathegories...........: A B C #> Observed cases in the MLC......: 2.68 2.64 2.68 #> Expected cases in the MLC......: 0 0 8 #> Value of statistic (loglik ratio)....: 9.0847 #> p-value........................: 0.2 #>  #> IDs of cluster detect: #> Location IDs included.....:  130 154 149 112 137 84 23 194 #>  #>  #> Secondary Scan statistic. Number 1  #> Total cases in secondary cluster......:  8  #> Names of cathegories.................: A B C #> Percent per category total...........: 0.34 0.33 0.34 #> Percent per category inside cluster..: 0.25 0.25 0.5 #> Value of statisitic (loglik ratio)....: 7.9105 #> p-value.........................: 0.4 #> Location IDs included..................:  117 86 178 191 55 181 174 182 #>  #>  #> Secondary Scan statistic. Number 2  #> Total cases in secondary cluster......:  13  #> Names of cathegories.................: A B C #> Percent per category total...........: 0.34 0.33 0.34 #> Percent per category inside cluster..: 0.23 0.46 0.31 #> Value of statisitic (loglik ratio)....: 5.8658 #> p-value.........................: 0.8 #> Location IDs included..................:  48 125 148 93 98 42 138 80 38 61 188 128 87 #>  #>  #> Secondary Scan statistic. Number 3  #> Total cases in secondary cluster......:  5  #> Names of cathegories.................: A B C #> Percent per category total...........: 0.34 0.33 0.34 #> Percent per category inside cluster..: 0.4 0.4 0.2 #> Value of statisitic (loglik ratio)....: 4.4561 #> p-value.........................: 0.95 #> Location IDs included..................:  58 155 115 88 50 #>  #>  #> Secondary Scan statistic. Number 4  #> Total cases in secondary cluster......:  5  #> Names of cathegories.................: A B C #> Percent per category total...........: 0.34 0.33 0.34 #> Percent per category inside cluster..: 0.4 0.2 0.4 #> Value of statisitic (loglik ratio)....: 4.4561 #> p-value.........................: 0.95 #> Location IDs included..................:  169 53 111 49 83 #>  #>  #> Secondary Scan statistic. Number 5  #> Total cases in secondary cluster......:  11  #> Names of cathegories.................: A B C #> Percent per category total...........: 0.34 0.33 0.34 #> Percent per category inside cluster..: 0.64 0.18 0.18 #> Value of statisitic (loglik ratio)....: 4.4453 #> p-value.........................: 0.95 #> Location IDs included..................:  1 34 19 51 198 106 57 56 129 141 65 plot(scan, sf = provinces_spain)  # }"},{"path":"https://f8l5h9.github.io/spqdep/reference/similarity.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the similarity test. — similarity.test","title":"Compute the similarity test. — similarity.test","text":"function compute nonparametric test spatial independence using symbolic analysis categorical/qualitative spatial process.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/similarity.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the similarity test. — similarity.test","text":"","code":"similarity.test(formula = NULL, data = NULL, fx = NULL, listw = listw, alternative = \"two.sided\", distr = \"asymptotic\", nsim = NULL, control = list())"},{"path":"https://f8l5h9.github.io/spqdep/reference/similarity.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the similarity test. — similarity.test","text":"formula symbolic description factor (optional). data (optional) data frame sf object containing variable testing . fx factor (optional). listw listw object alternative character string specifying type cluster, must one \"High\" (default), \"\" \"Low\". distr string. Distribution test \"asymptotic\" (default) \"bootstrap\" nsim Number permutations. control List additional control arguments.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/similarity.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the similarity test. — similarity.test","text":"object htest","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/similarity.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the similarity test. — similarity.test","text":"testing approach spatial independence extends properties  join count statistic. premise tests similar join count  statistic use concept similarity neighbouring spatial  entities (Dacey 1968; Cliff Ord 1973, 1981). However, differs taking  consideration number joins belonging locally spatial unit,  rather total number joins entire spatial system. approach  proposed applicable spatial network contiguity structures,  number neighbors belonging observations need constant. define equivalence relation \\(\\sim\\) set locations S. equivalence  relation satisfies following properties:  Reflexive: \\(s_i \\sim s_i\\) \\(s_i \\S\\),  Symmetric: \\(s_i \\sim s_j\\), \\(s_j \\sim s_i\\) \\(s_i,\\ s_j \\S\\)  Transitive: \\(s_i \\sim s_j\\) \\(s_j \\sim s_k\\), \\(s_i \\sim s_k\\)  \\(s_i, \\  s_j, \\ s_k \\S\\)  call relation \\(\\sim\\) similarity relation. , null hypothesis  interested  $$H_0: \\{X_s\\}_{s \\S} \\ \\ \\ \\ iid$$  Assume , null hypothesis, \\(P(s_i \\sim s_{ji}) = p_i\\)  \\(s_{ji} \\N_{s_i}\\).   Define  $$I_{ij}=1 \\ \\ \\ \\ s_i \\sim s_{ji} \\ \\ ; 0 \\ \\ otherwise$$  , fixed degree d location si degree d, variable d  $$\\Lambda_{(d,)}=\\sum_{j=1}^d I_{ij}$$  gives number nearest neighbours si similar si.  Therefore, null hypothesis, \\(H_0\\), \\(\\Lambda(d,)\\) follows binomial  distribution \\(B(d, p_i)\\).","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/similarity.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute the similarity test. — similarity.test","text":"Farber, S., Marin, M. R., & Paez, . (2015).     Testing spatial independence using similarity relations.       Geographical Analysis. 47(2), 97-120.","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/similarity.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the similarity test. — similarity.test","text":"","code":"# Case 1: N <- 100 cx <- runif(N) cy <- runif(N) listw <- spdep::knearneigh(cbind(cx,cy), k = 3) p <- c(1/4,1/4,1/4,1/4) rho <- 0.5 fx <- dgp.spq(p = p, listw = listw, rho = rho) W <- (spdep::nb2mat(spdep::knn2nb(listw)) >0)*1 similarity <- similarity.test(fx = fx, data = FastFood.sf, listw = listw) print(similarity) #>  #> \tSimilarity test of spatial dependence for qualitative data. #> \tDistribution: asymptotic #>  #> data:  fx #> Similarity-test = 2.7599, p-value = 0.005783 #> alternative hypothesis: two.sided #>   # Case 2: test with formula, a sf object (points) and knn data(\"FastFood.sf\") coor <- sf::st_coordinates(sf::st_centroid(FastFood.sf)) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: st_centroid does not give correct centroids for longitude/latitude data listw <- spdep::knearneigh(coor, k = 4) formula <- ~ Type similarity <- similarity.test(formula = formula, data = FastFood.sf, listw = listw) print(similarity) #>  #> \tSimilarity test of spatial dependence for qualitative data. #> \tDistribution: asymptotic #>  #> data:  Type #> Similarity-test = -5.4476, p-value = 5.105e-08 #> alternative hypothesis: two.sided #>   # Case 3: data(provinces_spain) listw <- spdep::poly2nb(as(provinces_spain,\"Spatial\"), queen = FALSE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") formula <- ~ Male2Female similarity <- similarity.test(formula = formula, data = provinces_spain, listw = listw) #> Warning: Out-of-range p-value: reconsider test arguments print(similarity) #>  #> \tSimilarity test of spatial dependence for qualitative data. #> \tDistribution: asymptotic #>  #> data:  Male2Female #> Similarity-test = NaN, p-value = NA #> alternative hypothesis: two.sided #>"},{"path":"https://f8l5h9.github.io/spqdep/reference/sp.runs.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the global spatial runs test. — sp.runs.test","title":"Compute the global spatial runs test. — sp.runs.test","text":"function compute global spatial runs test spatial independence categorical spatial data set.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/sp.runs.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the global spatial runs test. — sp.runs.test","text":"","code":"sp.runs.test(formula = NULL, data = NULL, fx = NULL, listw = listw, alternative = \"two.sided\" , distr = \"asymptotic\", nsim = NULL,control = list())"},{"path":"https://f8l5h9.github.io/spqdep/reference/sp.runs.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the global spatial runs test. — sp.runs.test","text":"formula symbolic description factor (optional). data (optional) data frame sf object containing variable testing . fx factor (optional). listw neighbourhood list (type knn nb) W matrix indicates order elements \\(m_i-environment\\) (example inverse distance). calculate number runs \\(m_i-environment\\), order must established, example nearest neighbour furthest one. alternative character string specifying alternative hypothesis, must one \"two.sided\" (default), \"greater\" \"less\". distr string. Distribution test \"asymptotic\" (default) \"bootstrap\". nsim Number permutations obtain pseudo-value confidence intervals (CI). Default value NULL don`t get CI number runs. control List additional control arguments.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/sp.runs.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the global spatial runs test. — sp.runs.test","text":"object htest sprunstest class","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/sp.runs.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the global spatial runs test. — sp.runs.test","text":"order neighbourhoods (\\(m_i-environments\\)) critical obtain test.  obtain number runs observed \\(m_i-environment\\), element must associated set neighbours ordered proximity. Three kinds lists can included identify \\(m_i-environments\\): knn: Objects class knn consider neighbours order proximity. nb: neighbours obtained sf object, code internally     call function nb2nb_order order order     proximity centroids. matrix: object matrix class based inverse distance introduced     argument, function nb2nb_order also called internally     transform object class matrix matrix class nb ordered neighbours. Two alternative sets arguments can included function compute spatial runs test:","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/sp.runs.test.html","id":"definition-of-spatial-run","dir":"Reference","previous_headings":"","what":"Definition of spatial run","title":"Compute the global spatial runs test. — sp.runs.test","text":"section define concepts spatial encoding runs, construct main statistics necessary testing spatial homogeneity categorical variables. order develop general theoretical setting, let us consider \\(\\{X_s\\}_{s \\S}\\)  categorical spatial process interest Q different categories, S set coordinates. Spatial encoding: location \\(s \\S\\) denote \\(N_s = \\{s_1,s_2 ...,s_{n_s}\\}\\)  set neighbours according interaction scheme W, ordered lesser higher Euclidean distance respect location s. sequence \\(X_{s_i} , X_{s_i+1},...,, X_{s_i+r}\\) elements value (identified class) called spatial run location s length r.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/sp.runs.test.html","id":"spatial-run-statistic","dir":"Reference","previous_headings":"","what":"Spatial run statistic","title":"Compute the global spatial runs test. — sp.runs.test","text":"total number runs defined : $$SR^Q=n+\\sum_{s \\S}\\sum_{j=1}^{n_s}I_j^s$$ \\(I_j^s = 1 \\ \\ X_{s_j-1} \\neq X_{s_j} \\ 0 \\ otherwise\\) \\(j=1,2,...,n_s\\) Following result Central Limit Theorem, asymtotical distribution \\(SR^Q\\) : $$SR^Q = N(\\mu_{SR^Q},\\sigma_{SR^Q})$$ one-tailed case, must distinguish lower-tailed test upper-tailed, associated  homogeneity heterogeneity respectively. case lower-tailed test,  following hypotheses used: \\(H_0:\\{X_s\\}_{s \\S}\\) ..d. \\(H_1\\): spatial distribution values categorical variable homogeneous null hypothesis (according fixed association scheme). upper-tailed test, following hypotheses used: \\(H_0:\\{X_s\\}_{s \\S}\\) ..d. \\(H_1\\): spatial distribution values categorical variable heterogeneous null hypothesis (according fixed association scheme). hypotheses provide decision rule regarding degree homogeneity spatial distribution values spatial categorical random variable.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/sp.runs.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute the global spatial runs test. — sp.runs.test","text":"Ruiz, M., López, F., Páez, . (2021).     test global local homogeneity categorical data based spatial runs.       Working paper.","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/sp.runs.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the global spatial runs test. — sp.runs.test","text":"","code":"# Case 1: SRQ test based on factor and knn # \\donttest{ n <- 100 cx <- runif(n) cy <- runif(n) x <- cbind(cx,cy) listw <- spdep::knearneigh(cbind(cx,cy), k=3) p <- c(1/6,3/6,2/6) rho <- 0.5 fx <- dgp.spq(listw = listw, p = p, rho = rho) srq <- sp.runs.test(fx = fx, listw = listw) print(srq) #>  #> \tRuns test of spatial dependence for qualitative data. Asymptotic #> \tversion #>  #> data:  mxf #> sp.runs test = -1.3614, p-value = 0.1734 #> alternative hypothesis: two.sided #> sample estimates: #>          Total runs     Mean total runs Variance total runs  #>            270.0000            285.5152            129.8759  #>  plot(srq)   # Boots Version control <- list(seedinit = 1255) srq <- sp.runs.test(fx = fx, listw = listw, distr = \"bootstrap\" , nsim = 299, control = control) print(srq) #>  #> \tRuns test of spatial dependence for qualitative data. Boots version #>  #> data:  mxf #> sp.runs test = -1.3614, p-value = 0.1533 #> alternative hypothesis: two.sided #> sample estimates: #>       Observed Total runs     Mean total runs boots Variance total runs boots  #>                  270.0000                  284.8194                  126.7391  #>  plot(srq)   # Case 2: SRQ test with formula, a sf object (points) and knn data(\"FastFood.sf\") x <- sf::st_coordinates(sf::st_centroid(FastFood.sf)) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: st_centroid does not give correct centroids for longitude/latitude data listw <- spdep::knearneigh(x, k=4) formula <- ~ Type srq <- sp.runs.test(formula = formula, data = FastFood.sf, listw = listw) print(srq) #>  #> \tRuns test of spatial dependence for qualitative data. Asymptotic #> \tversion #>  #> data:  Type #> sp.runs test = 3.899, p-value = 9.657e-05 #> alternative hypothesis: two.sided #> sample estimates: #>          Total runs     Mean total runs Variance total runs  #>            3408.000            3216.242            2418.743  #>  plot(srq)  # Version boots srq <- sp.runs.test(formula = formula, data = FastFood.sf, listw = listw, distr = \"bootstrap\", nsim = 199) print(srq) #>  #> \tRuns test of spatial dependence for qualitative data. Boots version #>  #> data:  Type #> sp.runs test = 3.899, p-value < 2.2e-16 #> alternative hypothesis: two.sided #> sample estimates: #>       Observed Total runs     Mean total runs boots Variance total runs boots  #>                  3408.000                  3213.030                  2597.191  #>  plot(srq)   # Case 3: SRQ test (permutation) using formula with a sf object (polygons) and nb library(sf) fname <- system.file(\"shape/nc.shp\", package=\"sf\") nc <- sf::st_read(fname) #> Reading layer `nc' from data source  #>   `/home/runner/work/_temp/Library/sf/shape/nc.shp' using driver `ESRI Shapefile' #> Simple feature collection with 100 features and 14 fields #> Geometry type: MULTIPOLYGON #> Dimension:     XY #> Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965 #> Geodetic CRS:  NAD27 listw <- spdep::poly2nb(as(nc,\"Spatial\"), queen = FALSE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar p <- c(1/6,3/6,2/6) rho = 0.5 co <- sf::st_coordinates(sf::st_centroid(nc)) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data nc$fx <- dgp.spq(listw = listw, p = p, rho = rho) plot(nc[\"fx\"])  formula <- ~ fx srq <- sp.runs.test(formula = formula, data = nc, listw = listw, distr = \"bootstrap\", nsim = 399) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data print(srq) #>  #> \tRuns test of spatial dependence for qualitative data. Boots version #>  #> data:  fx #> sp.runs test = -1.6349, p-value = 0.0925 #> alternative hypothesis: two.sided #> sample estimates: #>       Observed Total runs     Mean total runs boots Variance total runs boots  #>                  366.0000                  384.9248                  140.7984  #>  plot(srq)   # Case 4: SRQ test (Asymptotic) using formula with a sf object (polygons) and nb data(provinces_spain) sf::sf_use_s2(FALSE) listw <- spdep::poly2nb(provinces_spain, queen = FALSE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar provinces_spain$Coast <- factor(provinces_spain$Coast) levels(provinces_spain$Coast) = c(\"no\",\"yes\") plot(provinces_spain[\"Coast\"])  formula <- ~ Coast srq <- sp.runs.test(formula = formula, data = provinces_spain, listw = listw) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data print(srq) #>  #> \tRuns test of spatial dependence for qualitative data. Asymptotic #> \tversion #>  #> data:  Coast #> sp.runs test = -2.7795, p-value = 0.005444 #> alternative hypothesis: two.sided #> sample estimates: #>          Total runs     Mean total runs Variance total runs  #>           133.00000           160.36571            96.93415  #>  plot(srq)   # Boots version srq <- sp.runs.test(formula = formula, data = provinces_spain, listw = listw, distr = \"bootstrap\", nsim = 299) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: st_centroid does not give correct centroids for longitude/latitude data print(srq) #>  #> \tRuns test of spatial dependence for qualitative data. Boots version #>  #> data:  Coast #> sp.runs test = -2.7795, p-value = 0.003333 #> alternative hypothesis: two.sided #> sample estimates: #>       Observed Total runs     Mean total runs boots Variance total runs boots  #>                 133.00000                 157.27425                  92.83058  #>  plot(srq)   # Case 5: SRQ test based on a distance matrix (inverse distance) N <- 100 cx <- runif(N) cy <- runif(N) data <- as.data.frame(cbind(cx,cy)) data <- sf::st_as_sf(data,coords = c(\"cx\",\"cy\")) n = dim(data)[1] dis <- 1/matrix(as.numeric(sf::st_distance(data,data)),ncol=n,nrow=n) diag(dis) <- 0 dis <- (dis < quantile(dis,.10))*dis p <- c(1/6,3/6,2/6) rho <- 0.5 fx <- dgp.spq(listw = dis , p = p, rho = rho) srq <- sp.runs.test(fx = fx, listw = dis) print(srq) #>  #> \tRuns test of spatial dependence for qualitative data. Asymptotic #> \tversion #>  #> data:  mxf #> sp.runs test = -1.3821, p-value = 0.1669 #> alternative hypothesis: two.sided #> sample estimates: #>          Total runs     Mean total runs Variance total runs  #>            605.0000            656.5455           1390.9461  #>  plot(srq)   srq <- sp.runs.test(fx = fx, listw = dis, data = data) print(srq) #>  #> \tRuns test of spatial dependence for qualitative data. Asymptotic #> \tversion #>  #> data:  mxf #> sp.runs test = -1.3821, p-value = 0.1669 #> alternative hypothesis: two.sided #> sample estimates: #>          Total runs     Mean total runs Variance total runs  #>            605.0000            656.5455           1390.9461  #>  plot(srq)   # Boots version srq <- sp.runs.test(fx = fx, listw = dis, data = data, distr = \"bootstrap\", nsim = 299) print(srq) #>  #> \tRuns test of spatial dependence for qualitative data. Boots version #>  #> data:  mxf #> sp.runs test = -1.3821, p-value = 0.21 #> alternative hypothesis: two.sided #> sample estimates: #>       Observed Total runs     Mean total runs boots Variance total runs boots  #>                  605.0000                  635.7793                 1406.2800  #>  plot(srq)   # Case 6: SRQ test based on a distance matrix (inverse distance) data(\"FastFood.sf\") sf::sf_use_s2(FALSE) n = dim(FastFood.sf)[1] dis <- 1000000/matrix(as.numeric(sf::st_distance(FastFood.sf,FastFood.sf)), ncol = n, nrow = n) #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: bounding box has potentially an invalid value range for longlat data diag(dis) <- 0 dis <- (dis < quantile(dis,.005))*dis p <- c(1/6,3/6,2/6) rho = 0.5 co <- sf::st_coordinates(sf::st_centroid(FastFood.sf)) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: st_centroid does not give correct centroids for longitude/latitude data FastFood.sf$fx <- dgp.spq(p = p, listw = dis, rho = rho) plot(FastFood.sf[\"fx\"]) #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: bounding box has potentially an invalid value range for longlat data  formula <- ~ fx  # Boots version srq <- sp.runs.test(formula = formula, data = FastFood.sf, listw = dis, distr = \"bootstrap\", nsim = 299) #> Warning: st_centroid assumes attributes are constant over geometries of x #> Warning: bounding box has potentially an invalid value range for longlat data #> Warning: st_centroid does not give correct centroids for longitude/latitude data print(srq) #>  #> \tRuns test of spatial dependence for qualitative data. Boots version #>  #> data:  fx #> sp.runs test = -5.6155, p-value = 0.006667 #> alternative hypothesis: two.sided #> sample estimates: #>       Observed Total runs     Mean total runs boots Variance total runs boots  #>                  2399.000                  2541.642                  2778.801  #>  plot(srq)  # }"},{"path":"https://f8l5h9.github.io/spqdep/reference/spqdep-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","title":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","text":"spqdep offers user collection functions testing spatial independence categorical cross-section datasets.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/spqdep-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","text":"functionalities included spqdep package :","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/spqdep-package.html","id":"-test-q","dir":"Reference","previous_headings":"","what":"1. Test Q","title":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","text":"Testing spatial dependence Q test based symbolic entropy. See references","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/spqdep-package.html","id":"-test-qmap","dir":"Reference","previous_headings":"","what":"2. Test QMap","title":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","text":"Two statistics spatial analysis qualitative data obtained  based symbolic entropy maps. See references","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/spqdep-package.html","id":"-spatial-runs-test","dir":"Reference","previous_headings":"","what":"3. Spatial runs test","title":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","text":"Testing spatial dependence global test based runs. See references","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/spqdep-package.html","id":"-local-spatial-runs-test","dir":"Reference","previous_headings":"","what":"4. Local spatial runs test","title":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","text":"Obtain local test based runs. See references","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/spqdep-package.html","id":"-scan-test","dir":"Reference","previous_headings":"","what":"5. Scan test","title":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","text":"Testing spatial dependence Scan test. See references","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/spqdep-package.html","id":"-join-count-tests","dir":"Reference","previous_headings":"","what":"6. Join-count tests","title":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","text":"Testing spatial dependence classical Join-count test. See references","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/spqdep-package.html","id":"-similarity-test","dir":"Reference","previous_headings":"","what":"7. Similarity test","title":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","text":"Testing spatial dependence Similarity test. See references","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/spqdep-package.html","id":"datasets","dir":"Reference","previous_headings":"","what":"Datasets","title":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","text":"(example provinces_spain, FastFood.sf)   spqdep includes two different datasets: provinces_spain FastFood.sf.   sets used illustrate capabilities different functions.   Briefly, main characteristics following FastFood.sf sf object points localization Fastfood restaurants Toronto. provinces_spain object class sf geometry spanish provinces several data sets.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/spqdep-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Testing for Spatial Dependence of Qualitative Data in Cross Section. — spqdep-package","text":"Ruiz M, López FA Páez (2011).     Comparison Thematic Maps Using Symbolic Entropy.       International Journal Geographical Information Science,  26, 413-439. Ruiz, M., López, F., Páez, . (2010).     Testing spatial association qualitative data using symbolic dynamics.       Journal Geographical Systems, 12(3), 281-309.0. Kulldorff M, Nagarwalla N. (1995).     Spatial disease clusters: Detection Inference.       Statistics Medicine. 14:799-810 Jung , Kulldorff M, Richard OJ (2010).     spatial scan statistic multinomial data.       Statistics Medicine. 29(18), 1910-1918 Páez, , López-Hernández, FA, Ortega-García, JA, & Ruiz, M. (2016).      Clustering co-occurrence cancer types: comparison techniques application pediatric cancer Murcia, Spain.      Spatial Analysis Health Geography, 69-90.","code":""},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/summary.spjctest.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary of estimated objects of class spjctest. — summary.spjctest","title":"Summary of estimated objects of class spjctest. — summary.spjctest","text":"function summarizes estimated spjctest objects.   tables output include basic information test.   blablabla...","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/summary.spjctest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary of estimated objects of class spjctest. — summary.spjctest","text":"","code":"# S3 method for spjctest summary(object, ...)"},{"path":"https://f8l5h9.github.io/spqdep/reference/summary.spjctest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary of estimated objects of class spjctest. — summary.spjctest","text":"object spjctest object including list htest. ... arguments passed methods.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/summary.spjctest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary of estimated objects of class spjctest. — summary.spjctest","text":"object class summary.spjctest","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/summary.spjctest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary of estimated objects of class spjctest. — summary.spjctest","text":"","code":"## Multinomial + Binomial using a sf multipolygon data(\"provinces_spain\") sf::sf_use_s2(FALSE) provinces_spain$Male2Female <- factor(provinces_spain$Male2Female > 100) levels(provinces_spain$Male2Female) = c(\"men\",\"woman\") provinces_spain$Older <- cut(provinces_spain$Older, breaks = c(-Inf,19,22.5,Inf)) levels(provinces_spain$Older) = c(\"low\",\"middle\",\"high\") f1 <- ~ Older + Male2Female jc1 <- jc.test(formula = f1,                data = provinces_spain,                distr = \"mc\",                alternative = \"greater\",                zero.policy = TRUE) #> although coordinates are longitude/latitude, st_intersects assumes that they are planar summary(jc1) #> <div id=\"ltlobasigb\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #ltlobasigb .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #ltlobasigb .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #ltlobasigb .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #ltlobasigb .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #ltlobasigb .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #ltlobasigb .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #ltlobasigb .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #ltlobasigb .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #ltlobasigb .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #ltlobasigb .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #ltlobasigb .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #ltlobasigb .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #ltlobasigb .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #ltlobasigb .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #ltlobasigb .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #ltlobasigb .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #ltlobasigb .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ltlobasigb .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #ltlobasigb .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #ltlobasigb .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ltlobasigb .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #ltlobasigb .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #ltlobasigb .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #ltlobasigb .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ltlobasigb .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #ltlobasigb .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #ltlobasigb .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #ltlobasigb .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #ltlobasigb .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ltlobasigb .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #ltlobasigb .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #ltlobasigb .gt_left { #>   text-align: left; #> } #>  #> #ltlobasigb .gt_center { #>   text-align: center; #> } #>  #> #ltlobasigb .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #ltlobasigb .gt_font_normal { #>   font-weight: normal; #> } #>  #> #ltlobasigb .gt_font_bold { #>   font-weight: bold; #> } #>  #> #ltlobasigb .gt_font_italic { #>   font-style: italic; #> } #>  #> #ltlobasigb .gt_super { #>   font-size: 65%; #> } #>  #> #ltlobasigb .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #ltlobasigb .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #ltlobasigb .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #ltlobasigb .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #ltlobasigb .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"5\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>JoinCount Spatial Tests (Monte Carlo)<\/th> #>     <\/tr> #>      #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">pairs<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">pvalue<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Joincount<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Expected<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Variance<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"5\" class=\"gt_group_heading\">Older - multinomial - alternative: greater - Monte-Carlo simulation of #>         join-count statistic (nonfree sampling)<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_left\">high:high<\/td> #> <td class=\"gt_row gt_right\">0.41800<\/td> #> <td class=\"gt_row gt_right\">14<\/td> #> <td class=\"gt_row gt_right\">13.93<\/td> #> <td class=\"gt_row gt_right\">10.46<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">low:low<\/td> #> <td class=\"gt_row gt_right\">0.59100<\/td> #> <td class=\"gt_row gt_right\">7<\/td> #> <td class=\"gt_row gt_right\">8.18<\/td> #> <td class=\"gt_row gt_right\">6.04<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">middle:middle<\/td> #> <td class=\"gt_row gt_right\">0.60500<\/td> #> <td class=\"gt_row gt_right\">13<\/td> #> <td class=\"gt_row gt_right\">13.79<\/td> #> <td class=\"gt_row gt_right\">10.13<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">low:high<\/td> #> <td class=\"gt_row gt_right\">0.45300<\/td> #> <td class=\"gt_row gt_right\">24<\/td> #> <td class=\"gt_row gt_right\">23.05<\/td> #> <td class=\"gt_row gt_right\">16.25<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">middle:high<\/td> #> <td class=\"gt_row gt_right\">0.65700<\/td> #> <td class=\"gt_row gt_right\">28<\/td> #> <td class=\"gt_row gt_right\">29.28<\/td> #> <td class=\"gt_row gt_right\">17.46<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">middle:low<\/td> #> <td class=\"gt_row gt_right\">0.27400<\/td> #> <td class=\"gt_row gt_right\">25<\/td> #> <td class=\"gt_row gt_right\">22.77<\/td> #> <td class=\"gt_row gt_right\">15.42<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">Jtot<\/td> #> <td class=\"gt_row gt_right\">0.37100<\/td> #> <td class=\"gt_row gt_right\">77<\/td> #> <td class=\"gt_row gt_right\">75.10<\/td> #> <td class=\"gt_row gt_right\">20.20<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"5\" class=\"gt_group_heading\">Male2Female - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_left\">men-men<\/td> #> <td class=\"gt_row gt_right\">0.52400<\/td> #> <td class=\"gt_row gt_right\">60<\/td> #> <td class=\"gt_row gt_right\">60.37<\/td> #> <td class=\"gt_row gt_right\">23.62<\/td><\/tr> #>     <tr><td class=\"gt_row gt_left\">woman-woman<\/td> #> <td class=\"gt_row gt_right\">0.02900<\/td> #> <td class=\"gt_row gt_right\">13<\/td> #> <td class=\"gt_row gt_right\">7.16<\/td> #> <td class=\"gt_row gt_right\">6.66<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div>"},{"path":"https://f8l5h9.github.io/spqdep/reference/summary.spqtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary of estimated objects of class spqtest. — summary.spqtest","title":"Summary of estimated objects of class spqtest. — summary.spqtest","text":"function summarizes estimated spqtest objects.   tables output include basic information test.   blablabla...","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/summary.spqtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary of estimated objects of class spqtest. — summary.spqtest","text":"","code":"# S3 method for spqtest summary(object, ...)"},{"path":"https://f8l5h9.github.io/spqdep/reference/summary.spqtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary of estimated objects of class spqtest. — summary.spqtest","text":"object spqtest object including list htest. ... arguments passed methods.","code":""},{"path":"https://f8l5h9.github.io/spqdep/reference/summary.spqtest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary of estimated objects of class spqtest. — summary.spqtest","text":"object class summary.spqtest","code":""},{"path":[]},{"path":[]},{"path":"https://f8l5h9.github.io/spqdep/reference/summary.spqtest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary of estimated objects of class spqtest. — summary.spqtest","text":"","code":"# Example 1: With coordinates N <- 100 cx <- runif(N) cy <- runif(N) coor <- cbind(cx,cy) p <- c(1/6,3/6,2/6) rho = 0.5 listw <- spdep::nb2listw(spdep::knn2nb(               spdep::knearneigh(cbind(cx, cy), k = 4))) fx <- dgp.spq(list = listw, p = p, rho = rho) q.test <- Q.test(fx = fx, coor = coor, m = 3, r = 1) summary(q.test) #> <div id=\"vrzdqffzog\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\"> #>   <style>html { #>   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; #> } #>  #> #vrzdqffzog .gt_table { #>   display: table; #>   border-collapse: collapse; #>   margin-left: auto; #>   margin-right: auto; #>   color: #333333; #>   font-size: 16px; #>   font-weight: normal; #>   font-style: normal; #>   background-color: #FFFFFF; #>   width: auto; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #A8A8A8; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #A8A8A8; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_heading { #>   background-color: #FFFFFF; #>   text-align: center; #>   border-bottom-color: #FFFFFF; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_title { #>   color: #333333; #>   font-size: 125%; #>   font-weight: initial; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-color: #FFFFFF; #>   border-bottom-width: 0; #> } #>  #> #vrzdqffzog .gt_subtitle { #>   color: #333333; #>   font-size: 85%; #>   font-weight: initial; #>   padding-top: 0; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-color: #FFFFFF; #>   border-top-width: 0; #> } #>  #> #vrzdqffzog .gt_bottom_border { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_col_headings { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_col_heading { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 6px; #>   padding-left: 5px; #>   padding-right: 5px; #>   overflow-x: hidden; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: normal; #>   text-transform: inherit; #>   padding-top: 0; #>   padding-bottom: 0; #>   padding-left: 4px; #>   padding-right: 4px; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer:first-child { #>   padding-left: 0; #> } #>  #> #vrzdqffzog .gt_column_spanner_outer:last-child { #>   padding-right: 0; #> } #>  #> #vrzdqffzog .gt_column_spanner { #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: bottom; #>   padding-top: 5px; #>   padding-bottom: 5px; #>   overflow-x: hidden; #>   display: inline-block; #>   width: 100%; #> } #>  #> #vrzdqffzog .gt_group_heading { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #vrzdqffzog .gt_empty_group_heading { #>   padding: 0.5px; #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   vertical-align: middle; #> } #>  #> #vrzdqffzog .gt_from_md > :first-child { #>   margin-top: 0; #> } #>  #> #vrzdqffzog .gt_from_md > :last-child { #>   margin-bottom: 0; #> } #>  #> #vrzdqffzog .gt_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   margin: 10px; #>   border-top-style: solid; #>   border-top-width: 1px; #>   border-top-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 1px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 1px; #>   border-right-color: #D3D3D3; #>   vertical-align: middle; #>   overflow-x: hidden; #> } #>  #> #vrzdqffzog .gt_stub { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_stub_row_group { #>   color: #333333; #>   background-color: #FFFFFF; #>   font-size: 100%; #>   font-weight: initial; #>   text-transform: inherit; #>   border-right-style: solid; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #>   padding-left: 5px; #>   padding-right: 5px; #>   vertical-align: top; #> } #>  #> #vrzdqffzog .gt_row_group_first td { #>   border-top-width: 2px; #> } #>  #> #vrzdqffzog .gt_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_first_summary_row { #>   border-top-style: solid; #>   border-top-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_first_summary_row.thick { #>   border-top-width: 2px; #> } #>  #> #vrzdqffzog .gt_last_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_grand_summary_row { #>   color: #333333; #>   background-color: #FFFFFF; #>   text-transform: inherit; #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_first_grand_summary_row { #>   padding-top: 8px; #>   padding-bottom: 8px; #>   padding-left: 5px; #>   padding-right: 5px; #>   border-top-style: double; #>   border-top-width: 6px; #>   border-top-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_striped { #>   background-color: rgba(128, 128, 128, 0.05); #> } #>  #> #vrzdqffzog .gt_table_body { #>   border-top-style: solid; #>   border-top-width: 2px; #>   border-top-color: #D3D3D3; #>   border-bottom-style: solid; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_footnotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_footnote { #>   margin: 0px; #>   font-size: 90%; #>   padding-left: 4px; #>   padding-right: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_sourcenotes { #>   color: #333333; #>   background-color: #FFFFFF; #>   border-bottom-style: none; #>   border-bottom-width: 2px; #>   border-bottom-color: #D3D3D3; #>   border-left-style: none; #>   border-left-width: 2px; #>   border-left-color: #D3D3D3; #>   border-right-style: none; #>   border-right-width: 2px; #>   border-right-color: #D3D3D3; #> } #>  #> #vrzdqffzog .gt_sourcenote { #>   font-size: 90%; #>   padding-top: 4px; #>   padding-bottom: 4px; #>   padding-left: 5px; #>   padding-right: 5px; #> } #>  #> #vrzdqffzog .gt_left { #>   text-align: left; #> } #>  #> #vrzdqffzog .gt_center { #>   text-align: center; #> } #>  #> #vrzdqffzog .gt_right { #>   text-align: right; #>   font-variant-numeric: tabular-nums; #> } #>  #> #vrzdqffzog .gt_font_normal { #>   font-weight: normal; #> } #>  #> #vrzdqffzog .gt_font_bold { #>   font-weight: bold; #> } #>  #> #vrzdqffzog .gt_font_italic { #>   font-style: italic; #> } #>  #> #vrzdqffzog .gt_super { #>   font-size: 65%; #> } #>  #> #vrzdqffzog .gt_footnote_marks { #>   font-style: italic; #>   font-weight: normal; #>   font-size: 75%; #>   vertical-align: 0.4em; #> } #>  #> #vrzdqffzog .gt_asterisk { #>   font-size: 100%; #>   vertical-align: 0; #> } #>  #> #vrzdqffzog .gt_slash_mark { #>   font-size: 0.7em; #>   line-height: 0.7em; #>   vertical-align: 0.15em; #> } #>  #> #vrzdqffzog .gt_fraction_numerator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: 0.45em; #> } #>  #> #vrzdqffzog .gt_fraction_denominator { #>   font-size: 0.6em; #>   line-height: 0.6em; #>   vertical-align: -0.05em; #> } #> <\/style> #>   <table class=\"gt_table\"> #>   <thead class=\"gt_header\"> #>     <tr> #>       <th colspan=\"11\" class=\"gt_heading gt_title gt_font_normal\" style>Qualitative Dependence Test (Q)<\/th> #>     <\/tr> #>     <tr> #>       <th colspan=\"11\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Distribution: asymptotic. Distance: Euclidean<\/th> #>     <\/tr> #>   <\/thead> #>   <thead class=\"gt_col_headings\"> #>     <tr> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Q<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">df<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">p.value<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">k<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">N<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">m<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">r<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">R/n<\/th> #>       <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">5k^m<\/th> #>     <\/tr> #>   <\/thead> #>   <tbody class=\"gt_table_body\"> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"11\" class=\"gt_group_heading\">V1 - standard-permutations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">41.00<\/td> #> <td class=\"gt_row gt_right\">26<\/td> #> <td class=\"gt_row gt_right\">0.03102<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">100<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">49<\/td> #> <td class=\"gt_row gt_right\">27<\/td> #> <td class=\"gt_row gt_right\">1.81<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>     <tr class=\"gt_group_heading_row\"> #>       <td colspan=\"11\" class=\"gt_group_heading\">V1 - equivalent-combinations<\/td> #>     <\/tr> #>     <tr class=\"gt_row_group_first\"><td class=\"gt_row gt_right\">11.60<\/td> #> <td class=\"gt_row gt_right\">9<\/td> #> <td class=\"gt_row gt_right\">0.23703<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">100<\/td> #> <td class=\"gt_row gt_right\">3<\/td> #> <td class=\"gt_row gt_right\">1<\/td> #> <td class=\"gt_row gt_right\">49<\/td> #> <td class=\"gt_row gt_right\">10<\/td> #> <td class=\"gt_row gt_right\">4.90<\/td> #> <td class=\"gt_row gt_right\">135<\/td><\/tr> #>   <\/tbody> #>    #>    #> <\/table> #> <\/div> plot(q.test) #> [[1]]  #>  #> [[2]]  #>"}]
