<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="spqdep">
<title>spqdep user guide • spqdep</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="spqdep user guide">
<meta property="og:description" content="spqdep">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spqdep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/spq_userguide.html">spqdep user guide</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="spq_userguide_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>spqdep user guide</h1>
            <h3 data-toc-skip class="subtitle">The user guide <br><br><br>
</h3>
                        <h4 data-toc-skip class="author">Fernando A. López, Technical University of Cartagena (Spain)</h4>
                        <h4 data-toc-skip class="author">Román Mínguez, University of Castilla-La Mancha (Spain)</h4>
                        <h4 data-toc-skip class="author">Antonio Páez, McMaster University (Canada)</h4>
                        <h4 data-toc-skip class="author">Manuel Ruiz, Technical University of Cartagena (Spain) <br><br><br>
</h4>
            
            <h4 data-toc-skip class="date">2022-03-04 <br>
</h4>
      
      
      <div class="d-none name"><code>spq_userguide.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/" class="external-link">spdep</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spatialreg/" class="external-link">spatialreg</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This guide show the functionalities of the <strong>spqdep</strong> package to test spatial dependence on qualitative dataset.</p>
<div class="section level3">
<h3 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h3>
<p>Two data sets will be used as examples in this guide:</p>
<ul>
<li><p><strong>provinces_spain</strong>: The division of Spain into provinces. It is a multypolygon geometry with isolated provinces (islands without neighbouring provinces). See by example <span class="citation">Paez et al. (<a href="#ref-paez2021" role="doc-biblioref">2021</a>)</span>.</p></li>
<li><p><strong>FastFood.sf</strong>: The data set used as example in <span class="citation">Ruiz, López, and Páez (<a href="#ref-ruiz2010" role="doc-biblioref">2010</a>)</span>. It is a geometry of points.</p></li>
</ul>
<p>The package is install like usual and the dataset can be loaded using the next code</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://f8l5h9.github.io/spqdep/">spqdep</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"provinces_spain"</span>, package <span class="op">=</span> <span class="st">"spqdep"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"FastFood.sf"</span>, package <span class="op">=</span> <span class="st">"spqdep"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-generating-process-dgp">Data Generating Process (DGP)<a class="anchor" aria-label="anchor" href="#data-generating-process-dgp"></a>
</h3>
<p>Additional to the two dataset available in the <strong>spqdep</strong> package. The user can generate structured spatial processes using the  function. The DGP generate with this function defined in <span class="citation">Ruiz, López, and Páez (<a href="#ref-ruiz2010" role="doc-biblioref">2010</a>)</span>.</p>
<p>The next code show how to generate a random process on a set of random points localized in a square 1x1. In this case, the connectivity criteria is based on the 4 near neighborhood.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="va">cy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="va">coor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>
<span class="va">rho</span> <span class="op">=</span> <span class="fl">0.5</span>
<span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knn2nb.html" class="external-link">knn2nb</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html" class="external-link">knearneigh</a></span><span class="op">(</span><span class="va">coor</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">fx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.spq.html">dgp.spq</a></span><span class="op">(</span>list <span class="op">=</span> <span class="va">listw</span>, p <span class="op">=</span> <span class="va">p</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span></code></pre></div>
<p>The next plot show the qualitative spatial process defined.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, cx <span class="op">=</span> <span class="va">cx</span>, cy <span class="op">=</span> <span class="va">cy</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cx</span>, y <span class="op">=</span> <span class="va">cy</span>, color <span class="op">=</span> <span class="va">fx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="q-test">Q-test<a class="anchor" aria-label="anchor" href="#q-test"></a>
</h2>
<ul>
<li><p>The Q-test <span class="citation">(Ruiz, López, and Páez <a href="#ref-ruiz2010" role="doc-biblioref">2010</a>)</span> is based on m-surroundings</p></li>
<li><p>Before to apply the Q-test it is necessary define a set of the m-surroundings</p></li>
<li><p>The  function generate a set of m-surrounding.</p></li>
<li><p>The user can tuning several parameters to obtain a congruent set of m-surroundings.</p></li>
</ul>
<div class="section level3">
<h3 id="m-surroundings">m-surroundings<a class="anchor" aria-label="anchor" href="#m-surroundings"></a>
</h3>
<ul>
<li><p><strong>m.surround()</strong> is the function to generate m-surroundings.</p></li>
<li><p>The output of this function is a object of the class <strong>m_surr</strong></p></li>
<li><p>Using the  method the user can explore the coherence of m-surroundings.</p></li>
</ul>
<p>By example. the next code obtain m-surroundings with length m = 3 and degree of overlapping r = 1:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">=</span> <span class="fl">3</span>
<span class="va">r</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">mh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m.surround.html">m.surround</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span>, m <span class="op">=</span> <span class="va">m</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">mh</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "m_surr" "list"</span></code></pre>
</div>
<div class="section level3">
<h3 id="methods-for-the-m_surr-class">Methods for the m_surr class<a class="anchor" aria-label="anchor" href="#methods-for-the-m_surr-class"></a>
</h3>
<p>The <strong>spqdep</strong> have three methods that can be apply to this class: ,  and </p>
<ul>
<li> list the m-surroundings</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mh</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]    1   19   17</span>
<span class="co">##  [2,]    2   65   53</span>
<span class="co">##  [3,]    3   42   77</span>
<span class="co">##  [4,]    4   11   26</span>
<span class="co">##  [5,]    6   18   85</span>
<span class="co">##  [6,]    7   79   93</span>
<span class="co">##  [7,]    8   21   31</span>
<span class="co">##  [8,]   13   58   68</span>
<span class="co">##  [9,]   15   98   74</span>
<span class="co">## [10,]   17   76   96</span>
<span class="co">## [11,]   20   87   24</span>
<span class="co">## [12,]   22   82   92</span>
<span class="co">## [13,]   25    9   61</span>
<span class="co">## [14,]   26   14    7</span>
<span class="co">## [15,]   27   72   13</span>
<span class="co">## [16,]   31    5   20</span>
<span class="co">## [17,]   37   73   89</span>
<span class="co">## [18,]   38   30   15</span>
<span class="co">## [19,]   41   91   62</span>
<span class="co">## [20,]   46   47   49</span>
<span class="co">## [21,]   48   43   55</span>
<span class="co">## [22,]   49   29   60</span>
<span class="co">## [23,]   52   86    3</span>
<span class="co">## [24,]   53   97   69</span>
<span class="co">## [25,]   55   28   27</span>
<span class="co">## [26,]   56   64   41</span>
<span class="co">## [27,]   57   35   63</span>
<span class="co">## [28,]   60   44   70</span>
<span class="co">## [29,]   61   78   94</span>
<span class="co">## [30,]   62   54   46</span>
<span class="co">## [31,]   63   83   75</span>
<span class="co">## [32,]   67   50   37</span>
<span class="co">## [33,]   68   84    2</span>
<span class="co">## [34,]   69   59   22</span>
<span class="co">## [35,]   70   12   99</span>
<span class="co">## [36,]   71   34   67</span>
<span class="co">## [37,]   74   51    6</span>
<span class="co">## [38,]   75   36  100</span>
<span class="co">## [39,]   77   88    8</span>
<span class="co">## [40,]   85   80   57</span>
<span class="co">## [41,]   89   32    4</span>
<span class="co">## [42,]   90   45   38</span>
<span class="co">## [43,]   92   23   25</span>
<span class="co">## [44,]   93   39   95</span>
<span class="co">## [45,]   94   33   71</span>
<span class="co">## [46,]   95   81   90</span>
<span class="co">## [47,]   96   40   56</span>
<span class="co">## [48,]   99   10   48</span>
<span class="co">## [49,]  100   66   52</span></code></pre>
<ul>
<li> generate a summary of some characteristics of the m-surroundings</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mh</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Characteristics of m-surrounding:</span>
<span class="co">## </span>
<span class="co">## Number of m-surrounding (R): 49</span>
<span class="co">## Length of m-surrounding (m): 3</span>
<span class="co">## Number no-symbolized observations: 1</span>
<span class="co">## </span>
<span class="co">## List of no-symbolized observations:</span>
<span class="co">## 16</span>
<span class="co">## </span>
<span class="co">## List of the degree overlaping:</span>
<span class="co">##     There are 2 m-surrounding that have intersection with 1 m-surrounding</span>
<span class="co">##     There are 47 m-surrounding that have intersection with 2 m-surrounding</span>
<span class="co">## Mean degree of overlaping: 1.9592</span></code></pre>
<ul>
<li> show the spatial structure of the m-surroundings</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mh</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="spq_userguide_files/figure-html/plot%20mh-1.png" width="700"></p>
<ul>
<li>With the argument <strong>control</strong> the user can tuning some characteristics of the m-surroundings.</li>
</ul>
<p>By example, with <strong>control</strong> argument, the user can ‘prune’ non-coherent m-surroundings.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span>dtmaxknn <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">mh.prune</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m.surround.html">m.surround</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">coor</span>, m <span class="op">=</span> <span class="va">m</span>, r <span class="op">=</span> <span class="va">r</span>, control <span class="op">=</span> <span class="va">control</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mh.prune</span><span class="op">)</span></code></pre></div>
<p><img src="spq_userguide_files/figure-html/plot%20mh%20prune-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="the-q-test">The Q-test<a class="anchor" aria-label="anchor" href="#the-q-test"></a>
</h3>
<ul>
<li>The function  obtain the Q-test for a spatial process develop in <span class="citation">Ruiz, López, and Páez (<a href="#ref-ruiz2010" role="doc-biblioref">2010</a>)</span>.</li>
</ul>
<p>The user must select the longitude of the m-surroundings (m) and the overlapping degree (r). In the next code example, the Q-test is obtain for the DGP spatial process (fx) obtain with the . The coordinates <strong>coor</strong> must be included as argument.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q.test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Q.test.html">Q.test</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, coor <span class="op">=</span> <span class="va">coor</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<ul>
<li><p>The output is a list with the result for symbols based on permutations (standard) and combinations (equivalent).</p></li>
<li><p>The output of this function is an object of the <strong>spqtest</strong> class.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="distribution-of-q-test">Distribution of Q-test<a class="anchor" aria-label="anchor" href="#distribution-of-q-test"></a>
</h3>
<ul>
<li><p>The asymptotic distribution is the default distribution to obtain the significance of Q-test <span class="citation">(Ruiz, López, and Páez <a href="#ref-ruiz2010" role="doc-biblioref">2010</a>)</span>.</p></li>
<li><p>Alternatively, the Monte Carlo method can be used to obtain the significance of the test. The paper <span class="citation">López and Páez (<a href="#ref-lopez2012" role="doc-biblioref">2012</a>)</span> describe this approach.</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q.test.mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Q.test.html">Q.test</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, coor <span class="op">=</span> <span class="va">coor</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">1</span>, distr <span class="op">=</span> <span class="st">"mc"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">q.test.mc</span><span class="op">)</span></code></pre></div>
<div id="mvomnquzwd" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#mvomnquzwd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mvomnquzwd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mvomnquzwd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mvomnquzwd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mvomnquzwd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvomnquzwd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mvomnquzwd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mvomnquzwd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mvomnquzwd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mvomnquzwd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mvomnquzwd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mvomnquzwd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#mvomnquzwd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mvomnquzwd .gt_from_md > :first-child {
  margin-top: 0;
}

#mvomnquzwd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mvomnquzwd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mvomnquzwd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mvomnquzwd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mvomnquzwd .gt_row_group_first td {
  border-top-width: 2px;
}

#mvomnquzwd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvomnquzwd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mvomnquzwd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mvomnquzwd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvomnquzwd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvomnquzwd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mvomnquzwd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mvomnquzwd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvomnquzwd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mvomnquzwd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvomnquzwd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mvomnquzwd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvomnquzwd .gt_left {
  text-align: left;
}

#mvomnquzwd .gt_center {
  text-align: center;
}

#mvomnquzwd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mvomnquzwd .gt_font_normal {
  font-weight: normal;
}

#mvomnquzwd .gt_font_bold {
  font-weight: bold;
}

#mvomnquzwd .gt_font_italic {
  font-style: italic;
}

#mvomnquzwd .gt_super {
  font-size: 65%;
}

#mvomnquzwd .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#mvomnquzwd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mvomnquzwd .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#mvomnquzwd .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#mvomnquzwd .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="9" class="gt_heading gt_title gt_font_normal" style>Qualitative Dependence Test (Q)</th>
    </tr>
<tr>
<th colspan="9" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Distribution: mc. Distance: Euclidean</th>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Q</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">k</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">m</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">R</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">R/n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">5k^m</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<td colspan="9" class="gt_group_heading">V1 - standard-permutations</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_right">168.69</td>
<td class="gt_row gt_right">0.29300</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">100</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">100</td>
<td class="gt_row gt_right">27</td>
<td class="gt_row gt_right">3.70</td>
<td class="gt_row gt_right">135</td>
</tr>
<tr class="gt_group_heading_row">
<td colspan="9" class="gt_group_heading">V1 - equivalent-combinations</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_right">15.97</td>
<td class="gt_row gt_right">0.51300</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">100</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">100</td>
<td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">10.00</td>
<td class="gt_row gt_right">135</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="methods-for-the-spqtest-class">Methods for the spqtest class<a class="anchor" aria-label="anchor" href="#methods-for-the-spqtest-class"></a>
</h3>
<p>A summary can be apply to an object of the spqtest class:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">q.test</span><span class="op">)</span></code></pre></div>
<div id="bxchperxsc" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#bxchperxsc .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bxchperxsc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bxchperxsc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bxchperxsc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bxchperxsc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxchperxsc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bxchperxsc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bxchperxsc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bxchperxsc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bxchperxsc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bxchperxsc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bxchperxsc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#bxchperxsc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bxchperxsc .gt_from_md > :first-child {
  margin-top: 0;
}

#bxchperxsc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bxchperxsc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bxchperxsc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bxchperxsc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bxchperxsc .gt_row_group_first td {
  border-top-width: 2px;
}

#bxchperxsc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxchperxsc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bxchperxsc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bxchperxsc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxchperxsc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxchperxsc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bxchperxsc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bxchperxsc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxchperxsc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bxchperxsc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxchperxsc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bxchperxsc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxchperxsc .gt_left {
  text-align: left;
}

#bxchperxsc .gt_center {
  text-align: center;
}

#bxchperxsc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bxchperxsc .gt_font_normal {
  font-weight: normal;
}

#bxchperxsc .gt_font_bold {
  font-weight: bold;
}

#bxchperxsc .gt_font_italic {
  font-style: italic;
}

#bxchperxsc .gt_super {
  font-size: 65%;
}

#bxchperxsc .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#bxchperxsc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bxchperxsc .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#bxchperxsc .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#bxchperxsc .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="11" class="gt_heading gt_title gt_font_normal" style>Qualitative Dependence Test (Q)</th>
    </tr>
<tr>
<th colspan="11" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Distribution: asymptotic. Distance: Euclidean</th>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Q</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">k</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">m</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">r</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">R</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">R/n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">5k^m</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<td colspan="11" class="gt_group_heading">V1 - standard-permutations</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_right">89.73</td>
<td class="gt_row gt_right">26</td>
<td class="gt_row gt_right">0.00000</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">100</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">49</td>
<td class="gt_row gt_right">27</td>
<td class="gt_row gt_right">1.81</td>
<td class="gt_row gt_right">135</td>
</tr>
<tr class="gt_group_heading_row">
<td colspan="11" class="gt_group_heading">V1 - equivalent-combinations</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_right">4.97</td>
<td class="gt_row gt_right">9</td>
<td class="gt_row gt_right">0.83732</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">100</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">49</td>
<td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">4.90</td>
<td class="gt_row gt_right">135</td>
</tr>
</tbody>
</table>
</div>
<p>The histogram of the number of symbols is obtain appling the plot method.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">q.test</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [[1]]</span></code></pre>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<pre><code><span class="co">## </span>
<span class="co">## [[2]]</span></code></pre>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="the-q-test-using-a-sf-object">The Q-test using a sf object<a class="anchor" aria-label="anchor" href="#the-q-test-using-a-sf-object"></a>
</h3>
<ul>
<li>A sf object <span class="citation">(Pebesma <a href="#ref-pebesma2018" role="doc-biblioref">2018</a>)</span> or a data frame can be used as input of the  function:</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Case 3: With a sf object with isolated areas</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html" class="external-link">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Spherical geometry (s2) switched off</span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Male2Female</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Male2Female</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Male2Female</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"men"</span>,<span class="st">"woman"</span><span class="op">)</span>
<span class="va">f1</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Male2Female</span>
<span class="va">q.test.sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Q.test.html">Q.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">f1</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<ul>
<li>The method  show the histogram of the number of symbols</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">q.test.sf</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [[1]]</span></code></pre>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<pre><code><span class="co">## </span>
<span class="co">## [[2]]</span></code></pre>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="maps-comparison--the-qmap-test">Maps comparison. The QMap-test<a class="anchor" aria-label="anchor" href="#maps-comparison--the-qmap-test"></a>
</h2>
<ul>
<li>The function  obtain the test for maps comparison publish in <span class="citation">Ruiz, López, and Páez (<a href="#ref-Ruiz2012b" role="doc-biblioref">2012</a>)</span>
</li>
</ul>
<div class="section level3">
<h3 id="the-qmap-test">The QMap test<a class="anchor" aria-label="anchor" href="#the-qmap-test"></a>
</h3>
<p>The next code generate two qualitative spatial process with different levels of spatial dependence and the Q-Map is apply.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>
<span class="va">rho</span> <span class="op">=</span> <span class="fl">0.5</span>
<span class="va">QY1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.spq.html">dgp.spq</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, listw <span class="op">=</span> <span class="va">listw</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span>
<span class="va">rho</span> <span class="op">=</span> <span class="fl">0.8</span>
<span class="va">QY2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.spq.html">dgp.spq</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, listw <span class="op">=</span> <span class="va">listw</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span>
<span class="va">dt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">QY1</span>,<span class="va">QY2</span><span class="op">)</span>
<span class="va">m</span> <span class="op">=</span> <span class="fl">3</span>
<span class="va">r</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">QY1</span> <span class="op">+</span> <span class="va">QY2</span>
<span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dtmaxknn <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">qmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Q.map.test.html">Q.map.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">dt</span>, coor <span class="op">=</span> <span class="va">coor</span>, m <span class="op">=</span> <span class="va">m</span>, r <span class="op">=</span> <span class="va">r</span>, type <span class="op">=</span><span class="st">"combinations"</span>, control <span class="op">=</span> <span class="va">control</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in Q.map.test(formula = formula, data = dt, coor = coor, m = m, : The</span>
<span class="co">## ratio between the number of symbolized observations and the number of symbols is</span>
<span class="co">## lower than 5.</span></code></pre>
<ul>
<li>The output of  id an object of the classes <strong>qmap</strong> and <strong>htest</strong>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="methods-for-qmap-class">Methods for qmap class<a class="anchor" aria-label="anchor" href="#methods-for-qmap-class"></a>
</h3>
<ul>
<li>The qmap object is a list with two elements. Each element is an object of the class <strong>htext</strong>
</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">qmap</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##  Q-Map test of Equivalence for qualitative data.</span>
<span class="co">##  </span>
<span class="co">##  Symbols type: combinations</span>
<span class="co">##  </span>
<span class="co">##  Ratio Symbolized observations/Num symbols = 4.6</span>
<span class="co">## </span>
<span class="co">## data:  QY1 and QY2</span>
<span class="co">## QE = 146.06, df = 9, p-value &lt; 2.2e-16</span>
<span class="co">## alternative hypothesis: two.sided</span></code></pre>
<ul>
<li>The  method obtains the distribution of symbols with the confidence intervals specified by the user.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">qmap</span>, ci<span class="op">=</span><span class="fl">.6</span><span class="op">)</span></code></pre></div>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="runs-tests">Runs tests<a class="anchor" aria-label="anchor" href="#runs-tests"></a>
</h2>
<p>The runs test <span class="citation">(Ruiz, López, and Páez <a href="#ref-ruiz2021" role="doc-biblioref">2021</a>)</span> have global and local versions</p>
<div class="section level3">
<h3 id="global-runs-test">Global Runs test<a class="anchor" aria-label="anchor" href="#global-runs-test"></a>
</h3>
<ul>
<li>The function <strong>sp.runs.test</strong> obtain the spatial runs test.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html" class="external-link">knearneigh</a></span><span class="op">(</span><span class="va">coor</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">srq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sp.runs.test.html">sp.runs.test</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, listw <span class="op">=</span> <span class="va">listw</span><span class="op">)</span></code></pre></div>
<ul>
<li>The output of this function is a object of the classes <strong>sprunstest</strong> and <strong>htest</strong>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="methods-for-spruntest-class">Methods for spruntest class<a class="anchor" aria-label="anchor" href="#methods-for-spruntest-class"></a>
</h3>
<ul>
<li>The <strong>spqdep</strong> has two methods for this class  y </li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">srq</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##  Runs test of spatial dependence for qualitative data. Asymptotic</span>
<span class="co">##  version</span>
<span class="co">## </span>
<span class="co">## data:  mxf</span>
<span class="co">## sp.runs test = -0.38832, p-value = 0.6978</span>
<span class="co">## alternative hypothesis: two.sided</span>
<span class="co">## sample estimates:</span>
<span class="co">##          Total runs     Mean total runs Variance total runs </span>
<span class="co">##            281.0000            285.5152            135.1986</span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">srq</span><span class="op">)</span></code></pre></div>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="the-local-runs-test">The local Runs test<a class="anchor" aria-label="anchor" href="#the-local-runs-test"></a>
</h3>
<ul>
<li>The function <strong>local.sp.runs.test</strong> obtain the local test based on runs.</li>
</ul>
</div>
<div class="section level3">
<h3 id="asymptotic-version">Asymptotic version<a class="anchor" aria-label="anchor" href="#asymptotic-version"></a>
</h3>
<ul>
<li>Asymptotic version</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lsrq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/local.sp.runs.test.html">local.sp.runs.test</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, listw <span class="op">=</span> <span class="va">listw</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></code></pre></div>
<ul>
<li>The  method list the statistic of each observation (point or region)</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lsrq</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##     runs.i      E.i     Std.i    z.value    p.value</span>
<span class="co">## 1        4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 2        3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 3        2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 4        3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 5        2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 6        1 2.855152 0.8722689 -2.1268116 0.01671787</span>
<span class="co">## 7        2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 8        2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 9        2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 10       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 11       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 12       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 13       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 14       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 15       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 16       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 17       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 18       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 19       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 20       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 21       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 22       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 23       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 24       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 25       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 26       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 27       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 28       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 29       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 30       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 31       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 32       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 33       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 34       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 35       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 36       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 37       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 38       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 39       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 40       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 41       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 42       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 43       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 44       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 45       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 46       1 2.855152 0.8722689 -2.1268116 0.01671787</span>
<span class="co">## 47       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 48       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 49       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 50       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 51       1 2.855152 0.8722689 -2.1268116 0.01671787</span>
<span class="co">## 52       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 53       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 54       1 2.855152 0.8722689 -2.1268116 0.01671787</span>
<span class="co">## 55       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 56       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 57       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 58       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 59       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 60       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 61       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 62       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 63       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 64       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 65       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 66       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 67       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 68       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 69       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 70       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 71       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 72       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 73       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 74       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 75       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 76       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 77       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 78       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 79       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 80       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 81       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 82       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 83       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 84       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 85       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 86       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 87       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 88       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 89       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 90       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 91       1 2.855152 0.8722689 -2.1268116 0.01671787</span>
<span class="co">## 92       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 93       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 94       4 2.855152 0.8722689  1.3124950 0.90532341</span>
<span class="co">## 95       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 96       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 97       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 98       2 2.855152 0.8722689 -0.9803761 0.16345026</span>
<span class="co">## 99       3 2.855152 0.8722689  0.1660594 0.56594492</span>
<span class="co">## 100      3 2.855152 0.8722689  0.1660594 0.56594492</span></code></pre>
<ul>
<li>The  method identify the localization with values of local test significant.</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lsrq</span>, sig <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></code></pre></div>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="monte-carlo-local-runs-test">Monte Carlo local runs test<a class="anchor" aria-label="anchor" href="#monte-carlo-local-runs-test"></a>
</h3>
<ul>
<li>The Monte Carlo distribution ot the local test using a sf object</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"provinces_spain"</span><span class="op">)</span>
<span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html" class="external-link">poly2nb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">provinces_spain</span>,<span class="st">"Spatial"</span><span class="op">)</span>, queen <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## although coordinates are longitude/latitude, st_intersects assumes that they are planar</span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Male2Female</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Male2Female</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Male2Female</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"men"</span>,<span class="st">"woman"</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">[</span><span class="st">"Male2Female"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Male2Female</span>
<span class="co"># Boots Version</span>
<span class="va">lsrq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/local.sp.runs.test.html">local.sp.runs.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, listw <span class="op">=</span> <span class="va">listw</span>, distr <span class="op">=</span><span class="st">"bootstrap"</span>, nsim <span class="op">=</span> <span class="fl">199</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lsrq</span>, sf <span class="op">=</span> <span class="va">provinces_spain</span>, sig <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span></code></pre></div>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-21-2.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="the-scan-test">The scan test<a class="anchor" aria-label="anchor" href="#the-scan-test"></a>
</h2>
<ul>
<li><p>Two of the scan tests to identify clusters can be apply to test spatial structure in qualitative spatial processes.</p></li>
<li><p>The scan test don’t need pre-define the classical W conectivity matrix.</p></li>
<li><p>See <span class="citation">Kanaroglou (<a href="#ref-Kanaroglou2016" role="doc-biblioref">2016</a>)</span></p></li>
<li><p>The scan tests contrasts the null of independence of a spatial qualitative process and give additional information indicating one (or perhaps more) spatial cluster(s).</p></li>
<li><p>The scan tests don’t have asymptotic distribution. The significance is obtained by permutational resampling.</p></li>
<li><p>The output of the scan function is an object of the classes <strong>scantest</strong> and <strong>htest</strong></p></li>
</ul>
<div class="section level3">
<h3 id="scan-bernoulli">Scan bernoulli<a class="anchor" aria-label="anchor" href="#scan-bernoulli"></a>
</h3>
<ul>
<li>For qualitative spatial process with two categories the bernoulli scan test is obtain with the next code</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Male2Female</span>
<span class="va">scan.spain</span> <span class="op">&lt;-</span> <span class="fu">spqdep</span><span class="fu">::</span><span class="fu"><a href="../reference/scan.test.html">scan.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, case<span class="op">=</span><span class="st">"men"</span>, nsim <span class="op">=</span> <span class="fl">99</span>, distr <span class="op">=</span> <span class="st">"bernoulli"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan.spain</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##  Scan test. Distribution: bernoulli</span>
<span class="co">## </span>
<span class="co">## data:  Male2Female</span>
<span class="co">## scan-loglik = 6.0359, p-value = 0.07</span>
<span class="co">## alternative hypothesis: High</span>
<span class="co">## sample estimates:</span>
<span class="co">##                                        </span>
<span class="co">## Total observations in the MLC =   16.00</span>
<span class="co">## Expected cases in the MLC =       11.84</span>
<span class="co">## Observed cases in the MLC =       16.00</span></code></pre>
</div>
<div class="section level3">
<h3 id="scan-multinomial">scan multinomial<a class="anchor" aria-label="anchor" href="#scan-multinomial"></a>
</h3>
<ul>
<li>In case of a spatial process with three or more categories</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">FastFood.sf</span><span class="op">)</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Type</span>
<span class="va">scan.fastfood</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scan.test.html">scan.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">FastFood.sf</span>, nsim <span class="op">=</span> <span class="fl">99</span>, distr <span class="op">=</span> <span class="st">"multinomial"</span>, windows <span class="op">=</span> <span class="st">"elliptic"</span>, 
                           nv <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan.fastfood</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##  Scan test. Distribution: multinomial</span>
<span class="co">## </span>
<span class="co">## data:  Type</span>
<span class="co">## scan-loglik = 15.506, p-value &lt; 2.2e-16</span>
<span class="co">## sample estimates:</span>
<span class="co">##                  H     P     S Sum</span>
<span class="co">## cases.expect 13.48 14.86 14.66  43</span>
<span class="co">## cases.observ 16.00  1.00 26.00  43</span></code></pre>
</div>
<div class="section level3">
<h3 id="methods-for-scan-test">Methods for scan test<a class="anchor" aria-label="anchor" href="#methods-for-scan-test"></a>
</h3>
<ul>
<li>Two method can be used with <strong>scantest</strong> objects:  and </li>
</ul>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scan.fastfood</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Summary of data:</span>
<span class="co">## Distribution....................: multinomial</span>
<span class="co">## Number of locations.............: 877</span>
<span class="co">## Total number of cases...........: 877</span>
<span class="co">## </span>
<span class="co">## Scan statistic:</span>
<span class="co">## Total cases in the MLC......: 43</span>
<span class="co">## Names of cathegories...: H P S</span>
<span class="co">## Observed cases in the MLC...: 13.48 14.86 14.66</span>
<span class="co">## Expected cases in the MLC...: 16 1 26</span>
<span class="co">## Value of statisitic (loglik)....: 15.5058</span>
<span class="co">## p-value.........................: 0</span>
<span class="co">## </span>
<span class="co">## IDs of cluster detect:</span>
<span class="co">## Location IDs included..................:  68 849 152 499 630 763 827 765 617 600 607 48 58 588 743 843 74 122 750 115 645 61 226 796 876 699 610 597 596 721 751 53 186 659 778 63 106 229 585 738 612 131 208</span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scan.spain</span>, sf <span class="op">=</span> <span class="va">provinces_spain</span><span class="op">)</span></code></pre></div>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scan.fastfood</span>, sf <span class="op">=</span> <span class="va">FastFood.sf</span><span class="op">)</span></code></pre></div>
<p><img src="spq_userguide_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="similarity-test">Similarity test<a class="anchor" aria-label="anchor" href="#similarity-test"></a>
</h2>
<p>The <span class="citation">Farber, Marin, and Páez (<a href="#ref-Farber2014" role="doc-biblioref">2014</a>)</span> paper develop the similarity test</p>
<div class="section level3">
<h3 id="simiarity-test">Simiarity test<a class="anchor" aria-label="anchor" href="#simiarity-test"></a>
</h3>
<p>The  function calculates the similarity test for both asymptotic distribution and permutational resampling.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="va">FastFood.sf</span><span class="op">)</span><span class="op">)</span>
<span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html" class="external-link">knearneigh</a></span><span class="op">(</span><span class="va">coor</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Type</span>
<span class="va">similarity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similarity.test.html">similarity.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">FastFood.sf</span>, listw <span class="op">=</span> <span class="va">listw</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">similarity</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Similarity test of spatial dependence for qualitative data.</span>
<span class="co">##  Distribution: asymptotic</span>
<span class="co">## </span>
<span class="co">## data:  Type</span>
<span class="co">## Similarity-test = -5.4476, p-value = 5.105e-08</span>
<span class="co">## alternative hypothesis: two.sided</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="join-count-tests">join-count tests<a class="anchor" aria-label="anchor" href="#join-count-tests"></a>
</h2>
<ul>
<li>The functions of the <strong>spdep</strong> R-package have been <strong>wrapped</strong> for Bernoulli and Multinomial distributions. Asymptotic or Monte Carlo distributions (permutations) can be used to evaluate the signification of the tests.</li>
</ul>
<div class="section level3">
<h3 id="asyntotic-distribution">Asyntotic distribution<a class="anchor" aria-label="anchor" href="#asyntotic-distribution"></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Older</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Older</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>,<span class="fl">19</span>,<span class="fl">22.5</span>,<span class="cn">Inf</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Older</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>,<span class="st">"middle"</span>,<span class="st">"high"</span><span class="op">)</span>
<span class="va">f1</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Older</span> <span class="op">+</span> <span class="va">Male2Female</span>
<span class="va">jc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jc.test.html">jc.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">f1</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, distr <span class="op">=</span> <span class="st">"asymptotic"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## although coordinates are longitude/latitude, st_intersects assumes that they are planar</span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">jc1</span><span class="op">)</span></code></pre></div>
<div id="hyffzpwhxh" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#hyffzpwhxh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hyffzpwhxh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hyffzpwhxh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hyffzpwhxh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hyffzpwhxh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hyffzpwhxh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hyffzpwhxh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hyffzpwhxh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hyffzpwhxh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hyffzpwhxh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hyffzpwhxh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hyffzpwhxh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#hyffzpwhxh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hyffzpwhxh .gt_from_md > :first-child {
  margin-top: 0;
}

#hyffzpwhxh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hyffzpwhxh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hyffzpwhxh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hyffzpwhxh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hyffzpwhxh .gt_row_group_first td {
  border-top-width: 2px;
}

#hyffzpwhxh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyffzpwhxh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hyffzpwhxh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hyffzpwhxh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hyffzpwhxh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyffzpwhxh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hyffzpwhxh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hyffzpwhxh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hyffzpwhxh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hyffzpwhxh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyffzpwhxh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hyffzpwhxh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyffzpwhxh .gt_left {
  text-align: left;
}

#hyffzpwhxh .gt_center {
  text-align: center;
}

#hyffzpwhxh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hyffzpwhxh .gt_font_normal {
  font-weight: normal;
}

#hyffzpwhxh .gt_font_bold {
  font-weight: bold;
}

#hyffzpwhxh .gt_font_italic {
  font-style: italic;
}

#hyffzpwhxh .gt_super {
  font-size: 65%;
}

#hyffzpwhxh .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#hyffzpwhxh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hyffzpwhxh .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#hyffzpwhxh .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#hyffzpwhxh .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<th colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>JoinCount Spatial Tests (asymptotic)</th>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">pairs</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">z-value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">pvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Joincount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Expected</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Variance</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<td colspan="6" class="gt_group_heading">Older - multinomial - alternative: greater - Join count test under nonfree sampling</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_left">high:high</td>
<td class="gt_row gt_right">−0.56</td>
<td class="gt_row gt_right">0.71077</td>
<td class="gt_row gt_right">14</td>
<td class="gt_row gt_right">15.71</td>
<td class="gt_row gt_right">9.48</td>
</tr>
<tr>
<td class="gt_row gt_left">low:low</td>
<td class="gt_row gt_right">−0.93</td>
<td class="gt_row gt_right">0.82392</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">9.34</td>
<td class="gt_row gt_right">6.35</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:middle</td>
<td class="gt_row gt_right">−0.88</td>
<td class="gt_row gt_right">0.81070</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">15.71</td>
<td class="gt_row gt_right">9.48</td>
</tr>
<tr>
<td class="gt_row gt_left">low:high</td>
<td class="gt_row gt_right">−0.47</td>
<td class="gt_row gt_right">0.68162</td>
<td class="gt_row gt_right">24</td>
<td class="gt_row gt_right">25.88</td>
<td class="gt_row gt_right">15.78</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:high</td>
<td class="gt_row gt_right">−1.21</td>
<td class="gt_row gt_right">0.88738</td>
<td class="gt_row gt_right">28</td>
<td class="gt_row gt_right">33.27</td>
<td class="gt_row gt_right">18.88</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:low</td>
<td class="gt_row gt_right">−0.22</td>
<td class="gt_row gt_right">0.58727</td>
<td class="gt_row gt_right">25</td>
<td class="gt_row gt_right">25.88</td>
<td class="gt_row gt_right">15.78</td>
</tr>
<tr>
<td class="gt_row gt_left">Jtot</td>
<td class="gt_row gt_right">−1.29</td>
<td class="gt_row gt_right">0.90190</td>
<td class="gt_row gt_right">77</td>
<td class="gt_row gt_right">85.02</td>
<td class="gt_row gt_right">38.52</td>
</tr>
<tr class="gt_group_heading_row">
<td colspan="6" class="gt_group_heading">Male2Female - binomial - alternative: greater - Join count test under nonfree sampling</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_left">men-men</td>
<td class="gt_row gt_right">−2.17</td>
<td class="gt_row gt_right">0.98504</td>
<td class="gt_row gt_right">60</td>
<td class="gt_row gt_right">68.39</td>
<td class="gt_row gt_right">14.92</td>
</tr>
<tr>
<td class="gt_row gt_left">woman-woman</td>
<td class="gt_row gt_right">2.11</td>
<td class="gt_row gt_right">0.01740</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">8.01</td>
<td class="gt_row gt_right">5.59</td>
</tr>
<tr>
<td class="gt_row gt_left">men-woman</td>
<td class="gt_row gt_right">−2.47</td>
<td class="gt_row gt_right">0.99333</td>
<td class="gt_row gt_right">38</td>
<td class="gt_row gt_right">49.39</td>
<td class="gt_row gt_right">21.19</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="monte-carlo-distribution">Monte Carlo distribution<a class="anchor" aria-label="anchor" href="#monte-carlo-distribution"></a>
</h3>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">jc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jc.test.html">jc.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">f1</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, distr <span class="op">=</span> <span class="st">"mc"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## although coordinates are longitude/latitude, st_intersects assumes that they are planar</span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">jc1</span><span class="op">)</span></code></pre></div>
<div id="dkrtpzdols" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#dkrtpzdols .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dkrtpzdols .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dkrtpzdols .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dkrtpzdols .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dkrtpzdols .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dkrtpzdols .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dkrtpzdols .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dkrtpzdols .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dkrtpzdols .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dkrtpzdols .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dkrtpzdols .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dkrtpzdols .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#dkrtpzdols .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dkrtpzdols .gt_from_md > :first-child {
  margin-top: 0;
}

#dkrtpzdols .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dkrtpzdols .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dkrtpzdols .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dkrtpzdols .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dkrtpzdols .gt_row_group_first td {
  border-top-width: 2px;
}

#dkrtpzdols .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkrtpzdols .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dkrtpzdols .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dkrtpzdols .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dkrtpzdols .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkrtpzdols .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dkrtpzdols .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dkrtpzdols .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dkrtpzdols .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dkrtpzdols .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkrtpzdols .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dkrtpzdols .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkrtpzdols .gt_left {
  text-align: left;
}

#dkrtpzdols .gt_center {
  text-align: center;
}

#dkrtpzdols .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dkrtpzdols .gt_font_normal {
  font-weight: normal;
}

#dkrtpzdols .gt_font_bold {
  font-weight: bold;
}

#dkrtpzdols .gt_font_italic {
  font-style: italic;
}

#dkrtpzdols .gt_super {
  font-size: 65%;
}

#dkrtpzdols .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#dkrtpzdols .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dkrtpzdols .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#dkrtpzdols .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#dkrtpzdols .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>JoinCount Spatial Tests (Monte Carlo)</th>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">pairs</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">pvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Joincount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Expected</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Variance</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<td colspan="5" class="gt_group_heading">Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_left">high:high</td>
<td class="gt_row gt_right">0.50900</td>
<td class="gt_row gt_right">14</td>
<td class="gt_row gt_right">13.77</td>
<td class="gt_row gt_right">10.80</td>
</tr>
<tr>
<td class="gt_row gt_left">low:low</td>
<td class="gt_row gt_right">0.68200</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">8.33</td>
<td class="gt_row gt_right">6.31</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:middle</td>
<td class="gt_row gt_right">0.53800</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">13.86</td>
<td class="gt_row gt_right">10.40</td>
</tr>
<tr>
<td class="gt_row gt_left">low:high</td>
<td class="gt_row gt_right">0.40700</td>
<td class="gt_row gt_right">24</td>
<td class="gt_row gt_right">22.89</td>
<td class="gt_row gt_right">16.40</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:high</td>
<td class="gt_row gt_right">0.68300</td>
<td class="gt_row gt_right">28</td>
<td class="gt_row gt_right">29.55</td>
<td class="gt_row gt_right">18.26</td>
</tr>
<tr>
<td class="gt_row gt_left">middle:low</td>
<td class="gt_row gt_right">0.25300</td>
<td class="gt_row gt_right">25</td>
<td class="gt_row gt_right">22.60</td>
<td class="gt_row gt_right">16.01</td>
</tr>
<tr>
<td class="gt_row gt_left">Jtot</td>
<td class="gt_row gt_right">0.38900</td>
<td class="gt_row gt_right">77</td>
<td class="gt_row gt_right">75.03</td>
<td class="gt_row gt_right">22.51</td>
</tr>
<tr class="gt_group_heading_row">
<td colspan="5" class="gt_group_heading">Male2Female - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_left">men-men</td>
<td class="gt_row gt_right">0.52150</td>
<td class="gt_row gt_right">60</td>
<td class="gt_row gt_right">60.34</td>
<td class="gt_row gt_right">23.29</td>
</tr>
<tr>
<td class="gt_row gt_left">woman-woman</td>
<td class="gt_row gt_right">0.01750</td>
<td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">7.10</td>
<td class="gt_row gt_right">5.95</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-Farber2014">
<p>Farber, Steven, Manuel Ruiz Marin, and Antonio Páez. 2014. “Testing for Spatial Independence Using Similarity Relations.” <em>Geographical Analysis</em> 47 (2): 97–120. <a href="https://doi.org/10.1111/gean.12044" class="external-link">https://doi.org/10.1111/gean.12044</a>.</p>
</div>
<div id="ref-Kanaroglou2016">
<p>Kanaroglou, Pavlos. 2016. <em>Spatial Analysis in Health Geography</em>. Routledge. <a href="https://doi.org/10.4324/9781315610252" class="external-link">https://doi.org/10.4324/9781315610252</a>.</p>
</div>
<div id="ref-lopez2012">
<p>López, Fernando A, and Antonio Páez. 2012. “Distribution-Free Inference for Q (M) Based on Permutational Bootstrapping: An Application to the Spatial Co-Location Pattern of Firms in Madrid.” <em>Estadı́stica Española</em> 54 (177): 135–56.</p>
</div>
<div id="ref-paez2021">
<p>Paez, Antonio, Fernando A Lopez, Tatiane Menezes, Renata Cavalcanti, and Maira Galdino da Rocha Pitta. 2021. “A Spatio-Temporal Analysis of the Environmental Correlates of Covid-19 Incidence in Spain.” <em>Geographical Analysis</em> 53 (3): 397–421.</p>
</div>
<div id="ref-pebesma2018">
<p>Pebesma, Edzer. 2018. “Simple Features for R: Standardized Support for Spatial Vector Data.” <em>The R Journal</em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009" class="external-link">https://doi.org/10.32614/RJ-2018-009</a>.</p>
</div>
<div id="ref-ruiz2010">
<p>Ruiz, Manuel, Fernando López, and Antonio Páez. 2010. “Testing for Spatial Association of Qualitative Data Using Symbolic Dynamics.” <em>Journal of Geographical Systems</em> 12 (3): 281–309.</p>
</div>
<div id="ref-ruiz2021">
<p>———. 2021. “A Test for Global and Local Homogeneity of Categorical Data Based on Spatial Runs.” <em>Working Paper</em>.</p>
</div>
<div id="ref-Ruiz2012b">
<p>———. 2012. “Comparison of Thematic Maps Using Symbolic Entropy.” <em>International Journal of Geographical Information Science</em> 26 (3): 413–39. <a href="https://doi.org/10.1080/13658816.2011.586327" class="external-link">https://doi.org/10.1080/13658816.2011.586327</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Fernando Lopez, Roman Minguez, Antonio Paez, Manuel Ruiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
